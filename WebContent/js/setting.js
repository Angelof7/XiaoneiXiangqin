(function(a,b){function k(a,b,f){if(d[a])throw new Error("Module "+a+" has been defined already.");c(b)&&(f=b),d[a]={factory:f,inited:!1},a===e&&j(a)}function j(a){var e={},f=d[a];if(c(d[a].factory)){var g=d[a].factory.apply(b,[i,e,b]);f.ret=g===b?e:g}else f.ret=d[a].factory;f.inited=!0}function i(a){if(!d[a])throw new Error("Module "+a+" is not defined.");var b=d[a];b.inited===!1&&j(a);return b.ret}function c(a){return Object.prototype.toString.call(a)==="[object Function]"}if(!a.define){var d={},e=null,f=document.getElementsByTagName("script");for(var g=0,h=f.length;g<h&&!e;g++)e=f[g].getAttribute("data-main");if(!e)throw new Error("No data-main attribute in script tag.");a.define=k}})(window);define("task/group/common",function(a,b,c){a("task/user/setLoginUser"),a("task/user/setUserAccount"),a("task/widget/error"),a("task/widget/needLogin"),a("task/widget/logger"),a("task/widget/global"),a("task/widget/header"),a("task/widget/newCount"),a("task/widget/loginInform"),a("task/widget/scrollBar"),a("task/widget/feedback"),a("task/widget/linkTarget")});define("task/user/setLoginUser",function(a,b,c){var d=a("lib/jquery"),e=a("task/basic/Task"),f=a("model/UserData");(new e("setLoginUser",function(){var a=d("#data_loginUser"),b=d("#data_loginEmail");if(a.size()>0){var c=new f(d.parseJSON(a.html()));f.setLoginUser(c)}else b.size()>0&&(f.passport=d.trim(b.text()),f.passport.match(/qzone/i)&&(f.loginType="qq"),f.passport.match(/weibo/i)&&(f.loginType="weibo"));var e=d("#data_currentUser");e.size()>0&&f.setCurrentUser(new f(d.parseJSON(e.html())))})).add()});define("lib/jquery",function(require,exports,module){"use strict";var $=window.jQuery;$.fn.setCaretTo=function(a,b){b===undefined&&(b=a);var c=this.get(0);if(c.createTextRange){var d=c.createTextRange();d.collapse(!0),d.moveStart("character",a),d.moveEnd("character",b-a),d.select()}else c.focus(),c.setSelectionRange(a,b);return this},$.fn.scrollToShow=function(a){var b=this.first().offset().top-(a||0);$(document).scrollTop()>b&&$(document).scrollTop(b);return this},$.fn.focusToEnd=function(){var a=this.focus().val().length;this.setCaretTo(a);return this},$.fn.appendAfterCaret=function(a){var b=this.get(0);if(document.selection){var c=document.selection.createRange();c.text=a}else if(typeof b.selectionStart=="number"&&typeof b.selectionEnd=="number"){var d=b.selectionStart,e=b.selectionEnd,f=d,g=b.value;b.value=g.substring(0,d)+a+g.substring(e,g.length),f+=a.length,b.selectionStart=b.selectionEnd=f}else b.value+=a;return this},$.fn.detachDo=function(a){var b=$("<font />");return this.each(function(c,d){var e=$(this);b.insertBefore(e),e.detach(),a(c,d),e.insertBefore(b),b.detach()})},$.fn.getCaretPosition=function(){var a=this.get(0),b;try{b=a.selectionStart}catch(c){}if(b!==undefined)return a.selectionStart;if(document.selection){var d=0,e=document.selection.createRange();if(e.parentElement()===a){var f=document.body.createTextRange();f.moveToElementText(a);for(b=0;f.compareEndPoints("StartToStart",e)<0;b++)f.moveStart("character",1);for(var g=0;g<=b;g++)a.value.charAt(g)=="\n"&&b++;f=document.body.createTextRange(),f.moveToElementText(a);for(end=0;f.compareEndPoints("StartToEnd",e)<0;end++)f.moveStart("character",1);for(g=0;g<=end;g++)a.value.charAt(g)=="\n"&&end++;d=b}return d}return 0},$.fn.outerHTML=function(){var a=this.first(),b=a.wrap("<div>").parent().html();a.unwrap();return b},function(a){var b;a.scrollTo=function(c,d){var e=a(document).scrollTop(),f=[],g=e-c,h=d?d*30:30;d=d||2;while(Math.abs(g)>0){g=g/2;if(Math.abs(g)<1){f.push(0);break}f.push(g)}b&&clearInterval(b),b=setInterval(function(){f.length?window.scrollTo(0,c+f.shift()):clearInterval(b)},h)}}($),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,b,c,d,e){return jQuery.easing[jQuery.easing.def](a,b,c,d,e)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b+c;return-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b*b+c;return d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b*b*b+c;return-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b*b*b*b+c;return d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return b==0?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){if(b==0)return c;if(b==e)return c+d;if((b/=e/2)<1)return d/2*Math.pow(2,10*(b-1))+c;return d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){if((b/=e/2)<1)return-d/2*(Math.sqrt(1-b*b)-1)+c;return d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e)==1)return c+d;g||(g=e*.3);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e)==1)return c+d;g||(g=e*.3);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin((b*e-f)*2*Math.PI/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e/2)==2)return c+d;g||(g=e*.3*1.5);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);if(b<1)return-0.5*h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)+c;return h*Math.pow(2,-10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)*.5+d+c},easeInBack:function(a,b,c,d,e,f){f==undefined&&(f=1.70158);return d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){f==undefined&&(f=1.70158);return d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){f==undefined&&(f=1.70158);if((b/=e/2)<1)return d/2*b*b*(((f*=1.525)+1)*b-f)+c;return d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,b,c,d,e){return d-jQuery.easing.easeOutBounce(a,e-b,0,d,e)+c},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*7.5625*b*b+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:b<2.5/2.75?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(a,b,c,d,e){if(b<e/2)return jQuery.easing.easeInBounce(a,b*2,0,d,e)*.5+c;return jQuery.easing.easeOutBounce(a,b*2-e,0,d,e)*.5+d*.5+c}}),function(){function f(){return(new Date).getTime()}var a=jQuery,b="jQuery.pause",c=1,d=a.fn.animate,e={};a.fn.animate=function(g,h,i,j){var k=a.speed(h,i,j);k.complete=k.old;return this.each(function(){this[b]||(this[b]=c++);var h=a.extend({},k);d.apply(a(this),[g,a.extend({},h)]),e[this[b]]={run:!0,prop:g,opt:h,start:f(),done:0}})},a.fn.pause=function(){return this.each(function(){this[b]||(this[b]=c++);var d=e[this[b]];d&&d.run&&(d.done+=f()-d.start,d.done>d.opt.duration?delete e[this[b]]:(a(this).stop(),d.run=!1))})},a.fn.resume=function(){return this.each(function(){this[b]||(this[b]=c++);var g=e[this[b]];g&&!g.run&&(g.opt.duration-=g.done,g.done=0,g.run=!0,g.start=f(),d.apply(a(this),[g.prop,a.extend({},g.opt)]))})}}(),typeof $.JSON!="object"&&($.JSON={}),function(){function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g;return e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g;return e}}function quote(a){escapable.lastIndex=0;return escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function f(a){return a<10?"0"+a:a}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof $.JSON.stringify!="function"&&($.JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(b&&typeof b!="function"&&(typeof b!="object"||typeof b.length!="number"))throw new Error("JSON.stringify");return str("",{"":a})}),typeof $.JSON.parse!="function"&&($.JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver=="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")})}(),$.equals=function(a,b){if(a.length!=b.length)return!1;var c=!0;$.each(a,function(d){if(a[d]!=b[d]){c=!1;return!1}});return c};return jQuery.noConflict()});define("task/basic/Task",function(a,b,c){var d=a("basic/Class"),e=d.extend({init:function(a,b,c,d){this.name=a,d=d||[],c=c||null,this.func=function(){b.apply(c,d)}},run:function(){this.func()},add:function(){a("task/basic/TaskManager").add(this)}});return e});define("basic/Class",function(a,b,c){function f(a,b){return function(){var c=this._super;this._super=a;var d=b.apply(this,arguments);this._super=c;return d}}var d=!1,e=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,g=function(){};g.extend=function(a){function h(){!d&&this.init&&this.init.apply(this,arguments)}var b=this.prototype;d=!0;var c=new this;d=!1;for(var g in a)c[g]=typeof a[g]=="function"&&typeof b[g]=="function"&&e.test(a[g])?f(b[g],a[g]):a[g];h.prototype=c,h.constructor=h,h.extend=arguments.callee;return h};return g});define("task/basic/TaskManager",function(a,b,c){var d=a("lib/jquery"),e={taskResult:{},taskList:[],add:function(a){this.taskList.push(a)},run:function(){var a=this.taskList.shift();if(this.taskList.length>0){var b=this;setTimeout(function(){b.run()},0)}var c=new Date,d=0,e=null;try{a.run()}catch(f){typeof console!="undefined"&&console.error&&console.error("error in task ",a.name,":",f,f.stack),e=f}d=new Date-c,this.taskResult[a.name]={duration:d,result:e===null?"success":e.name+":"+e.message+"|@|"+e.stack},this.taskList.length!==0}};return e});define("model/UserData",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/Utils"),g={},h={},i=e.extend({init:function(a){this.id=i.update(a)},get:function(){return g[this.id]},bindUpdate:function(a){i.bindUpdate(this.id,a)}}),j=["avatar"];i.update=function(a){var b=a.id,c=[],e=g[b];if(e)for(var h=0,k=j.length;h<k;h++){var l=j[h];a[l]&&e[l]&&a[l]!==e[l]&&c.push(l)}g[b]=d.extend(e,a);var m=g[b];if(!m._avatar&&typeof a.avatar!="undefined"||d.inArray("avatar",c)!==-1)m._avatar=f.userAvatar(a.avatar,70,a.sex);if(!m._province&&typeof a.province!="undefined")try{m._province=f.selectValue("province",a.province)}catch(n){throw"user"+a.id+"province data error!"}if(!m._city&&typeof a.province!="undefined"&&typeof a.city!="undefined")try{m._city=f.selectValue("city",a.province+"-"+a.city),m._cutCity=f.countChars(m._city,6,!0),m._specialCity=f.specialCity(a.province,a.city),m._cutSpecialCity=f.countChars(m._specialCity,6,!0)}catch(n){throw"user"+a.id+"city data error!"}c.length>0&&i.publishUpdate(b,c);return b},i.bindUpdate=function(a,b){var c=h[a]||[];c.push(b),h[a]=c},i.publishUpdate=function(a,b){var c=h[a];if(!!c)for(var d=0,e=c.length;d<e;d++)c[d](i.get(a),b)},i.get=function(a){return g[a]||null},i.loginUserId=null,i.loginUserIsVip=!1,i.loginUserIsNormalVip=!1,i.loginUserIsSuperVip=!1,i.getLoginUser=function(){if(i.loginUserId===null)return null;return i.get(i.loginUserId)},i.setLoginUser=function(a){if(a&&a.id){a.isLoginUser=!0,i.loginUserId=i.update(a);var b=i.getLoginUser();i.loginUserIsVip=b.isVip,i.loginUserIsNormalVip=b.isNormalVip,i.loginUserIsSuperVip=b.isSuperVip}},i.currentUserId=null,i.loginUserPage=!0,i.getCurrentUser=function(){if(i.currentUserId===null)return null;return i.get(i.currentUserId)},i.setCurrentUser=function(a){a&&a.id&&(i.currentUserId=i.update(a),a.id!==i.loginUserId&&(i.loginUserPage=!1))},i.isLoginUserPage=function(){if(i.currentUserId!==null&&i.loginUserId!==i.currentUserId)return!1;return!0},i.isAvatarCheck=function(){return i.getLoginUser().isAvatarBlock?!1:!0};return i});define("utils/Utils",function(a,b,c){"use strict";var d=a("lib/jquery"),e=d(window),f=d(document.body),g=a("utils/OimageUrl"),h=a("utils/Log"),i={};i.ARROW_LEFT_CODE=37,i.ARROW_RIGHT_CODE=39,i.ARROW_UP_CODE=38,i.ARROW_DOWN_CODE=40,i.ENTER_CODE=13,i.tipsHideInterval=2e3,i.MIN_PICSIZE=10240,i.MAX_PICSIZE=8388608,i.EMAIL_REG=/^[a-zA-Z0-9_\-\.]{1,}@[a-zA-Z0-9_\-]{1,}\.[a-zA-Z0-9_\-.]{1,}$/,i.NICKNAME_REG=/^[\u4e00-\u9fa5\w_]+$/i,i.REALNAME_REG=/^[\u4e00-\u9fa5a-z ]+$/i,i.COMPANY_REG=/^[^<>]+$/i,i.SCHOOL_REG=/^[\u4e00-\u9fa5（）()\w ]*$/i,i.MOBILE_REG=/^0*(13|14|15|18)\d{9}$/,i.MOBILECODE_REG=/^[0-9]{6}$/,i.IDCARD_REG=/^(\d{18,18}|\d{15,15}|\d{17,17}[xX])$/,i.VERIFYCODE_REG=/^[\w]{5}$/,i.INVITECODE_REG=/^[\w]{4,10}$/,i.IMG_FILE_REG=/^image\/\w+$/,i.URL_REG=/^(http)s?:\/\/(?:[\w-]+\.?)+[\.\/\?%&=#@\[\]\-+_!:*~\w-]+|(www)\.(?:[\w-]+\.?)+[\.\/\?%&=#@\[\]\-+_!:*~\w-]+$/i,i.FULLWIDTH_REG=/[\uFE30-\uFFA0\u2E80-\u9FFF\uac00-\ud7ff\u3000‘“”’]/g,i.AVATAR_VER="131210",i.isIe6=d.browser.msie&&d.browser.version<7?!0:!1;var j='<div class="loadingBox"><span><em class="icon-loadingB"></em>$TEXT$</span></div>';i.LOADING_BIG=function(a){a=a||"\u52a0\u8f7d\u4e2d...";return j.replace("$TEXT$",a)};var k='<div class="loadingBoxS"><span><em class="icon-loadingS"></em>$TEXT$</span></div>';i.LOADING_SMALL=function(a){a=a||"\u52a0\u8f7d\u4e2d...";return k.replace("$TEXT$",a)},i.S4=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},i.N5=function(){return((1+Math.random())*65536|0).toString(8).substring(1)},i.pageWidth=function(){return parseFloat(document.documentElement.clientWidth)},i.pageHeight=function(){return Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight)},i.pageMaxHeight=function(){return Math.max(d(window).height(),d(document).height())},i.getXY=function(a){var b=a.offsetLeft,c=a.offsetTop;while((a=a.offsetParent)!=null)b+=a.offsetLeft,c+=a.offsetTop;return{top:c,left:b}},i.autoClose=function(a,b){var c=a||this.$elem,e=b||this.$trigger,g=this,h=function(a){var b=d(a.target).parents().andSelf();d.inArray(c[0],b)===-1&&d.inArray(e[0],b)===-1&&g.hide(a)};f.bind("click",h);return h},i.random=function(a){return Math.floor(a*(Math.random()%1))},i.randomOimageUrl=function(){var a={};return function(b,c,d,e,f,g){if(typeof b!="string"||b==="")throw"Oimage Url is Error!!!";var h=b+"|"+c+"|"+d+"|"+e+"|"+g+"|"+f;if(!a[h]){b=i.encodeSpecialHtmlChar(b);var j=b.lastIndexOf(".");j=b.substr(j-1,1),j<0&&(j=b.length-1);var k=String(j).charCodeAt()%2+1,l="http://htimg"+k+".cache.netease.com/image?"+(typeof c=="number"?"w="+c:"")+(typeof d=="number"?"&h="+d:"")+"&url="+encodeURIComponent(b)+"&gif="+(e?0:1)+"&quality="+(f?f:85);typeof g!="undefined"&&(l+="&fill=0"),a[h]=l}return a[h]}}(),i.buildCursor=function(a){return a.timestamp},i.updateNewCount=function(a,b,c){b=parseInt(b),b!==0?(b=b>99?"99+":b,b=c?"("+b+")":b,a.addClass("show").find(".js-item").text(b)):a.removeClass("show")},i.parseURL=function(a){var b=/^(?:([A-Za-z]+):(\/{0,3}))?([0-9.\-A-Za-z]+\.[0-9A-Za-z]+)?(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/,c=["url","scheme","slash","host","port","path","query","hash"],d=b.exec(a),e={};for(var f=0,g=c.length;f<g;f++)e[c[f]]=d[f]||"";return e},i.encodeSpecialHtmlChar=function(a){if(a){a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");return a}return""},i.decodeSpecialHtmlChar=function(a){if(a){var b=["&quot;","&amp;","&lt;","&gt;"],c=['"',"&","<",">"],d=c.length;for(var e=0;e<d;e++)a=a.replace(new RegExp(b[e],"g"),c[e]);return a}return""},i.countChars=function(a,b,c,e){if(a){var f=i.strLen(a),g=[],h=0;if(e){var j=d("<div></div>").html(a);a=j.text(),j=null}if(f<=b)return a;for(var k=0;k<f;k++){var l=a.charAt(k);/[^\x00-\xff]/.test(l)?h+=2:h+=1;if(h>b)break;g.push(l)}return c?g.join(""):g.join("")+"..."}return""},i.strLen=function(a){var b=a.replace(/[^\x00-\xff\s]/g,"**").length;return b},i.textTips=function(a,b,c){var c=c||"";typeof b=="undefined"||b==="hide"?a.addClass("hidden"):b==="error"?a.removeClass("text-icon-tips-warning text-icon-tips-access text-icon-tips-pass text-icon-tips-help hidden").addClass("text-icon-tips-error").html('<em class="icon-error-s"></em>'+c):b==="warning"?a.removeClass("text-icon-tips-error text-icon-tips-access text-icon-tips-pass text-icon-tips-help hidden").addClass("text-icon-tips-warning").html('<em class="icon-warning-s"></em>'+c):b==="pass"?a.removeClass("text-icon-tips-error text-icon-tips-warning text-icon-tips-access text-icon-tips-help hidden").addClass("text-icon-tips-pass").html(c||'<em class="icon-correct-m"></em>'):b==="help"?a.removeClass("text-icon-tips-error text-icon-tips-warning text-icon-tips-access text-icon-tips-pass hidden").addClass("text-icon-tips-help").html('<em class="icon-help"></em>'+c):b==="access"&&a.removeClass("text-icon-tips-error text-icon-tips-warning text-icon-tips-pass text-icon-tips-help hidden").addClass("text-icon-tips-access").html('<em class="icon-correct-s"></em>'+c)},i.selectValue=function(b,c,d,e){var f=a("utils/data/selectData"),e=e||"";if(parseInt(c)===0||c==="")return typeof d=="undefined"?"\u672a\u8bbe\u7f6e":d===!1?"":d;if(b==="province")return f.city.all()[c];if(b==="city"){var g=c.split(/[-_~]/),h=g[0],i=g[1],j="";parseInt(i)!==0&&i!==""&&(j=f.city.city[h][i]);return j}return f[b][c]+e},i.specialCity=function(b,c){var d=a("utils/data/selectData");if(d.city.specialCity[b])return d.city.specialCity[b];return i.selectValue("city",b+"-"+c)},i.replaceEmpty=function(a,b,c){var c=c||"";return!a||a===""?b?b:"\u672a\u8bbe\u7f6e":a+c},i.reqSelectValue=function(b,c,d,e,f,g){var h=e?"<"+e+">":"",i=e?"</"+e+">":"",f=f||"",j=a("utils/data/selectData"),k=parseInt(c),l=parseInt(d);if(b==="age"||b==="height")b=!1;if(k===0&&l!==0)return h+(b?j[b][l]:l)+i+f+"\u4ee5\u4e0b";if(k!==0&&l===0)return h+(b?j[b][k]:k)+i+f+"\u4ee5\u4e0a";if(k!==0&&l!==0){var m=h+(b?j[b][k]:k)+"\u5230"+(b?j[b][l]:l)+i+f;return g?m:m+"\u4e4b\u95f4"}return"\u4e0d\u9650"},i.constellationValue=function(b){if(b.length===12)return"\u661f\u5ea7\u4e0d\u9650";var c=a("utils/data/selectData"),d=[];for(var e=0;e<b.length;e++)d[e]=c.constellation[b[e]]+"\u5ea7";return d.join("\uff0c")},i.educationValue=function(b,c){if(parseInt(b)===1&&c)return"\u5b66\u5386\u4e0d\u9650";var d="",e=a("utils/data/selectData");d=e.education[b]||"\u5b66\u5386",d=parseInt(b)!==0&&c?d+"\u53ca\u4ee5\u4e0a":d;return d},i.cityValue=function(a,b){return i.selectValue("province",a,!1)+i.selectValue("city",a+"-"+b,!1)},i.userSexName=function(a){a=parseInt(a);if(a===1)return"\u4ed6";if(a===2)return"\u5979";return""},i.userSexTitle=function(a){a=parseInt(a);if(a===1)return"\u7537";if(a===2)return"\u5973";return""},i.defaultAvatars={1:"http://img1.cache.netease.com/love/image/common/avatar/default_male_big.png",2:"http://img1.cache.netease.com/love/image/common/avatar/default_female_big.png"},i.userAvatar=function(a,b,c,d){var e="";typeof arguments[0]=="object"?e=a.url?a.url:i.defaultAvatars[a.sex]||i.defaultAvatars[1]:typeof arguments[0]=="string"&&(e=a!==""?a:i.defaultAvatars[c]||i.defaultAvatars[1]);return g(e,b,b,1)},i.tmpl=function(a,b){var c=/\W/.test(a)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):i.cache[a]=i.cache[a]||i.tmpl(document.getElementById(a).innerHTML);return b?c(b):c},i.preLoadSWF=function(b,c){var e=i.S4(),g=d('<div style="width:1px;height:1px;position:absolute;left:-9999px;"><div id="'+e+'"></div></div>').appendTo(f);a("lib/swfobject").embedSWF(b,e,1,1,"10.1.0","","","","",function(a){if(a.success)var b=d("#"+e)[0],f=setInterval(function(){try{b.PercentLoaded()===100&&(clearInterval(f),c&&c({success:!0}),g.remove())}catch(a){}},20);else c&&c({success:!1}),g.remove()})},i.snsShare=function(a,b,c){var d={163:{url:"http://t.163.com/article/user/checkLogin.do?",link:"link",source:"source",title:"info",images:"images",togImg:"togImg",key:"key"},tqq:{url:"http://share.v.t.qq.com/index.php?c=share&a=index&",link:"url",title:"title",pic:"pic",appkey:"appkey"},weibo:{url:"http://service.weibo.com/share/share.php?",link:"url",source:"source",title:"title",images:"pic",key:"appkey"},qzone:{url:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?",link:"url",title:"title",pics:"pics",desc:"desc",summary:"summary"},renren:{url:"http://widget.renren.com/dialog/share?",link:"link",title:"title",images:"images",desc:"description"},douban:{url:"http://shuo.douban.com/!service/share?",link:"href",title:"name"}},e=c.width||700,f=c.height||600;a.bind("click",function(a){var g=d[b].url,h=[];c.link&&(c.link+="?vendor=sns.share&utm_source=sns&utm_campaign=sns.share");for(var i in c)d[b][i]&&h.push(d[b][i]+"="+encodeURIComponent(c[i]));window.open(g+h.join("&"),"_blank","width="+e+",height="+f)})},i.qaShare=function(a,b){var c=a.width||700,e=a.height||600,f=[];for(var g in a)f.push(g+"="+encodeURIComponent(a[g]));window.open("/question/share?"+f.join("&"),"_blank","width="+c+",height="+e),h.doLog({parameter:{method:"qashare"},elem:d(b.currentTarget)})},i.captureShare=function(a){var a=d.extend({param:{},width:700,height:600,url:"",method:"",elem:null},a);a.elem.delegate(".weibo-trigger, .txweibo-trigger, .douban-trigger, .qzone-trigger, .renren-trigger","click",function(b){var c=d(b.currentTarget),e="weibo";c.hasClass("txweibo-trigger")?e="txweibo":c.hasClass("douban-trigger")?e="douban":c.hasClass("qzone-trigger")?e="qzone":c.hasClass("renren-trigger")&&(e="renren"),a.param.type=e;var f=[];for(var g in a.param)f.push(g+"="+encodeURIComponent(a.param[g]));window.open(a.url+"?"+f.join("&"),"_blank","width="+a.width+",height="+a.height),a.method&&h.doLog({parameter:{method:a.method},elem:c})})},i.createTextarea=function(a){var b=a.textarea||null,c=d(document.createElement("TEXTAREA"));c.css({height:"0",position:"absolute",left:"-50000px",top:"-10000px",visibility:"hidden"}),setTimeout(function(){c.css({fontSize:b.css("fontSize"),fontFamily:b.css("fontFamily"),fontWeight:b.css("fontWeight"),lineHeight:b.css("lineHeight"),"padding-top":b.css("padding-top"),"padding-bottom":b.css("padding-bottom"),"padding-left":b.css("padding-left"),"padding-right":b.css("padding-right"),overflow:"hidden",wordBreak:b.css("wordBreak"),wordWrap:b.css("wordWrap"),width:b.css("width")})},30),f.append(c);return c},i.createSpan=function(a){var b=a.textarea||null,c=d(document.createElement("SPAN"));setTimeout(function(){c.css({fontSize:b.css("fontSize"),fontFamily:b.css("fontFamily"),fontWeight:b.css("fontWeight"),lineHeight:b.css("lineHeight"),position:"absolute",top:"-20000px",left:"-10000px",visibility:"hidden"})},50),f.append(c);return c},i.textAutoBreak=function(a,b,c){var d=c.tempSpanElem,e=c.tempTextareaElem,f=a.split("\n"),g=[],b=b||474,h=c.start||0;for(var j=0;j<f.length;j++){var k=f[j];k===""?g.push(""):d.text(k).width()>b?g.push(i.breakLongText(e,k,b)):g.push(k)}return g.join("\n")},i.breakLongText=function(a,b,c){a.val(" ");var d=a[0].scrollHeight,e=[],f="",g="";for(var h=0,i=b.length;h<i;h++){f=f+b.charAt(h);var j=a.val(f)[0].scrollHeight;j>d&&(e.push(f.substring(0,f.length-1)),e.push("\n"),f=f.substring(f.length-1,f.length),d=a.val("")[0].scrollHeight),h===i-1&&e.push(f)}return e.join("")},i.btnSending=function(a){this.sendBtnDefaultText=a.text(),a.html(a.data("loadingtext")),a.parents(".js-btn:first").addClass("disabled")},i.btnSended=function(a){a.text(this.sendBtnDefaultText),a.parents(".js-btn:first").removeClass("disabled")},i.cookieStr=function(a,b,c,d){var e="";if(c){var f=0,g=new Date;c==="today"&&(c=1,f=g.getHours()*3600+g.getMinutes()*60+g.getSeconds()),g.setTime(g.getTime()+c*24*60*60*1e3-f*1e3),e="; expires="+g.toGMTString()}var h=a+"="+b+e+"; path=/";h=d?h+";domain="+d:h;return h},i.formRedirect=function(a,b,c,e){var g=d("<form></form>");g.attr("target",b||"_blank"),g.attr("method",c||"GET"),g.attr("action",a);var h=[];d.each(e,function(a,b){h.push('<input type="hidden" name="'+a+'" value="'+b+'" />')}),g.html(h.join("")),f.append(g),g.submit(),setTimeout(function(){g.remove()},100)},i.isPlaceholderSupport=function(){return"placeholder"in document.createElement("input")}(),i.placeholder=function(a){if(!i.isPlaceholderSupport){var b=a.attr("placeholder");i.inputDefaultVal(a,b)}},i.inputDefaultVal=function(a,b){typeof b!="undefined"&&b!==""&&(a.bind("focus",function(){d.trim(a.val())===b&&a.val("")}).bind("blur",function(){d.trim(a.val())===""&&a.val(b)}),d.trim(a.val())===""&&a.val(b))},i.bindInput=function(a,b){var c=parseInt(a.data("bindenter"))||0,e=parseInt(a.data("maxlength"))||0;c===1&&a.bind("keypress",function(c){var e=c.which||c.keyCode;e===i.ENTER_CODE&&b&&b(d.trim(a.val()))}),e!==0&&a.bind("input propertychange",function(b){var c=i.countChars(a.val(),e,!0);c!==a.val()&&a.val(c)})},i.supportCSS3=function(a){var b=document.createElement("div"),c=["O","Moz","ms","webkit"],d=c.length;if(a in b.style)return!0;a=a.replace(/^[a-z]/,function(a){return a.toUpperCase()});while(d--)if(c[d]+a in b.style)return!0;return!1},i.bindNumAnimation=function(a,b){var b=d.extend({interval:10,multiple:.2,callback:null,elem:null},b),c={sumNum:0,left_num:null,interval:null,doSum:function(){this.left_num!==0?(this.sumNum=this.left_num!==null?this.sumNum+Math.ceil(this.left_num*b.multiple):Math.ceil(a*b.multiple),this.left_num=a-this.sumNum,b.callback&&b.callback({sumNum:this.sumNum}),b.elem&&b.elem.text(this.sumNum)):clearInterval(this.interval)},start:function(){var c=this;a!==0&&(this.interval=setInterval(function(){c.doSum()},b.interval))},stop:function(){clearInterval(this.interval)}};return c},i.commaNumber=function(a){var b=String(a).split("."),c=function(a){return a.length<=3?a:c(a.substr(0,a.length-3))+","+a.substr(a.length-3)};b[0]=c(b[0]);return b.join(".")},i.formatFloat=function(a,b){var c=Math.pow(10,b);return parseInt(a*c,10)/c},i.formatTime=function(a,b){var c=parseInt(a/3600)%24,d=parseInt(a/60)%60,e=parseInt(a%60);c=c<10?"0"+c:c,d=d<10?"0"+d:d,e=e<10?"0"+e:e,c=String(c),d=String(d),e=String(e);return{hour:c==="NaN"?"00":c,min:d==="NaN"?"00":d,second:e==="NaN"?"00":e}},i.bindFloatElemAnim=function(a){var b=d.extend({dura:1e3},a),c=b.targetElem;c.bind(b.event,function(a,e){var f=c.offset(),g=d('<span style="position:absolute;left:'+f.left+"px;top:"+f.top+'px;opacity:0;">'+e.text+"</span>").appendTo("body");g.css({fontSize:c.css("fontSize"),fontFamily:c.css("fontFamily"),fontWeight:c.css("fontWeight"),color:c.css("color"),top:parseInt(g.css("top"))-g.innerHeight()/2+"px"}),setTimeout(function(){g.animate({top:"-=20",opacity:1},b.dura).animate({opacity:0},200,function(){g.remove()})},100)})};return i});define("utils/OimageUrl",function(a,b,c){"use strict";var d={},e=function(a){if(a){a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;");return a}return""},f=function(a,b,c,e,f){if(typeof a!="string"||a==="")throw"Oimage Url is Error!!!";if(!c||c==="")c=b;f=f||85;var e=typeof e=="number"&&e===1?1:0,g=a+"|"+b+"|"+c+"|"+e+"|"+f;if(!d[g]){a=a.replace(/#.?$/,"");var h="http://imgsize.ph.126.net/?imgurl="+a+"_"+b+"x"+c+"x"+e+"x"+f+".jpg";d[g]=h}return d[g]};return f});define("utils/Log",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/data/RequestMap"),g={pFeed:"pHome",pTrend:"pTrend",pNotify:"pMessage",pDigg:"pM_like",pHeed:"pM_followers",pMessage:"pM_talk",pPhoto:"pImage",pFollowing:"pFollowing",pFollower:"pFollower",pSearch:"pSearch",pLogin:"plogin",pSignfail:"pSign_fail",pIdcard:"pV_name",pMobile:"pV_mobile",pFace:"pS_face",pPassword:"pS_password",pMineProfile:"pMine",pUserProfile:"pUser",pUserCard:"pUserCard",pApp:"pApp",pSignup:"pSignup",pCharge:"charge",pChargeBill:"chargebill",pExpenseBill:"expensebill",pServices:"pVaservices",pPayHelp:"payitems",pOrderError:"paytrouble",pVisitor:"pM_visitor",pPark:"pPark",pQa:"pQa",pAstro:"pAstro",pInvite:"pInviteCard",pRecomm:"pXunrenlist",pSubject:"pXunrenpage",pEscape:"pParkescape",pAccount:"pAccount",pGiftReceive:"pM_gift",pDigging:"pM_digging",pDislike:"pDislike",pTopiclist:"pTopiclist",pTopic:"pTopic",pLovefm:"pLovefm",pLovefmGuest:"pLovefmguest",pInvite2013:"pInvite2013",pParty:"pParty",pPartyList:"pPartyList",pStar:"pStar",pBrowse:"pBrowse"},h={navi:"nav",avatar:"avatar",nickname:"nickname",userIntro:"intro",feeds:"feeds",feedFoot:"ugc",visitor:"visitor",basicInfoBox:"basicinfor",album:"album",requirement:"requirement",detailInfoBox:"exinfor",lifeViewBox:"view",monologBox:"monolog",corpinvite:"intrologin",ursLogin:"session",signupOpen:"nickname",signupAvatar:"avatar",signupVerified:"verified",updateie6:"updateie6",usertimeline:"usertimeline",userRecommend:"rec",edit:"edit",detail:"detail",loginBox:"quickLogin",app_iphone:"iphone",app_android:"android",login_app:"app",newQa:"newqa",nonQa:"nonqa",oldQa:"oldqa",skipQa:"skipqa",sameQa:"sameqa",qaSee:"qasee",qaUpdate:"qarec",photolayer:"piclayer",payNavi:"navi",payErrorTips:"paytips",visitorTips:"tips",visitorLimitTips:"limitTips",inviteSignup:"signup",inviteLogin:"login",inviteSignupLogin:"signup_logined",profilePhotolayer:"figure",subjectUser:"user",appQRBox:"appQR",feedVip:"feedfiltervip",rightVipRank:"rightviprank",rightToCharge:"righttocharge",qaPublishRight:"qa",publishRight:"right",goodNews:"rightAd_goodNews",rightvipad:"rightvipad",rightvipuser:"rightvipuser",rightAdAct:"rightAd_act",rightAd2:"rightAd_AD2",rightAd3:"rightAd_AD3",rightAdFocus:"rightAd_focus",bottomTips:"bottom",profileInfo:"infor",profileQa:"qa",opensvip:"openvip",openvip:"openvip",likeLimit:"favlimit",dislikeLimit:"hidelimit",likeNotice:"favnotice",profileOnline:"online",dmUpOpen:"dmup",hideNoticeOpen:"hide.notice",stickerOpen:"vipsticker",giftBoxOpen:"giftbox",diggOpen:"digg.notice",topic:"topic",lovefmUser:"user",openLogin:"login",openReg:"reg",focus:"focus"},i=d.extend({},g,h),j=[new Image,new Image,new Image,new Image,new Image,new Image,new Image,new Image,new Image,new Image],k=function(a){return Math.floor(a*(Math.random()%1))},l=e.extend({init:function(){},keyFrom:function(a){var b=d(a).first();if(b[0]===window)return"window";var c=d.map(b.parents().andSelf(),function(a){var b=d(a);return b.data("keyfrom")||i[b.data("log")]||undefined});return c.join(".")},getType:function(a){var b=null;return((b=typeof a)==="object"?Object.prototype.toString.call(a).slice(8,-1):b).toLowerCase()},paramConcat:function(a,b){var c="",e="",f=!1;e=decodeURI(d(b).attr("href"));if(a&&this.getType(a)==="object")for(var g in a)if(g=="method"&&a[g]==""){for(var h in this.methodFromMap){var i=new RegExp(h);if(i.exec(e)!=null){f=!0,c+="&"+g+"="+this.methodFromMap[h];break}}f||(c+="&"+g+"=click")}else c+="&"+g+"="+a[g];a&&this.getType(a)==="string"&&(c+="&"+a);return c},doLog:function(a){this.$elem=d(a.elem),this.parameter=a.parameter,a.path=a.path||"/page.do",a.path.indexOf("/")===-1?this.path=f[a.path].url:this.path=a.path;var b="";if(this.path.indexOf("?")===-1){var c=this.keyFrom(this.$elem);b=this.path+"?"+"keyfrom="+c+this.paramConcat(this.parameter,this.$elem)}else{var c=this.keyFrom(this.$elem);b=this.path+"&"+"keyfrom="+c+this.paramConcat(this.parameter,c)}this.send(b)},send:function(a){if(typeof a=="undefined")throw"no valid logger address";var b=j[k(10)],c="";a.match(/^http:\/\/.+/)?c=a:c="http://"+location.host+(/^\//.test(a)?a:"/"+a),c+="&__rnd="+(new Date).getTime(),b.src=c}}),m=null;return{doLog:function(a){m===null&&(m=new l),m.doLog(a)},keyFrom:function(a){m===null&&(m=new l);return m.keyFrom(a)},send:function(a){m===null&&(m=new l);return m.send(a)}}});define("utils/data/RequestMap",function(a,b,c){var d={sendStatus:{url:"/trend/add",login:!0,silent:!0},feedList:{url:"/feed/list",login:!0,silent:!0},feedSecondLeft:{url:"/feed/secondsleft",login:!0,silent:!0},trendList:{url:"/trend/list",login:!0,silent:!0},userTrendList:{url:"/trend/usertimeline",login:!0,silent:!0,redirect:!0},addFav:{url:"/relation/follow",login:!0,silent:!0},cancelFav:{url:"/relation/unfollow",login:!0,silent:!0},addShield:{url:"/relation/reject",login:!0,silent:!0},addDigg:{url:"/messages/like/praise",login:!0,silent:!0},sayHi:{url:"/messages/like/sayHi",login:!0,silent:!0},loginUserInfo:{url:"/user/logininfo",login:!0,silent:!0},closeUser:{url:"/user/closeUser",login:!0,silent:!0},sendMess:{url:"/messages/add",login:!0,silent:!0},deleteMess:{url:"/messages/delete",login:!0,silent:!0},flushMessNewCount:{url:"/messages/flush",login:!0,silent:!0},messageList:{url:"/messages/dmTimeline",login:!0,silent:!0},deleteSession:{url:"/messages/deleteSession",login:!0,silent:!0},singleSession:{url:"/messages/singleSession",login:!0,silent:!0},newCount:{url:"/newCount",login:!0},newFeeds:{url:"/home/newFeeds",login:!0},newFeedsNew:{url:"/feed/newFeeds",login:!0},newTrends:{url:"/trend/newInfo",login:!0},trendDelete:{url:"/trend/delete",login:!0},heedList:{url:"/messages/followers/list",login:!0,silent:!0},diggList:{url:"/messages/like/praiseList",login:!0,silent:!0},noticeList:{url:"/messages/notice",login:!0,silent:!0},cleanNotice:{url:"/messages/clean",login:!0,silent:!0},noticeSearch:{url:"/messages/search",login:!0,silent:!0},followingList:{url:"/following/list",login:!0,silent:!0},followerList:{url:"/followers/list",login:!0,silent:!0},getBigPhotoInfo:{url:"/photo/singlePhoto",login:!0,silent:!0,redirect:!0},deletePhoto:{url:"/photo/delete",login:!0,silent:!0},sliderPhotoList:{url:"/photo/list",login:!0,silent:!0,redirect:!0},segmentPhotoList:{url:"/photo/segmentPhotoList",login:!0,silent:!0,redirect:!0},settingProfilePhoto:{url:"/settings/avatars",login:!0,silent:!0,redirect:!0},profilePhotoList:{url:"/user/avatarList",login:!0,silent:!0,redirect:!0},getProfilePhotoInfo:{url:"/user/avatar",login:!0,silent:!0,redirect:!0},searchList:{url:"/search/user/list",login:!1,silent:!0},cityInfo:{url:"/user/addOtherCity",login:!1},visitorList:{url:"/messages/visitor/list",login:!0},visitors:{url:"/visitor/latestvisitor",login:!0},userGuide:{url:"/user/novice",login:!0},matchCondition:{url:"/match/require",login:!0,silent:!0,redirect:!0},matchAgree:{url:"/match/view",login:!0,silent:!0,redirect:!0},newUserGuideStep1:{url:"/user/addUser",login:!1,silent:!0},newUserGuideStep2:{url:"/user/registAvatar",login:!0},updateAvatar:{url:"/user/portraits",login:!0,silent:!0},updateBasicInfo:{url:"/user/updateUser",login:!0,silent:!0},updateLoverDesc:{url:"/user/require",login:!0,silent:!0},updateLifeView:{url:"/user/marrage",login:!0,silent:!0},verifyIdCard:{url:"/verifyName",login:!0,silent:!0},verifyMobile:{url:"/verifyMobile",login:!0,silent:!0},mobileCodeGender:{url:"/genMobileCodeNew",login:!1},companySuggest:{url:"/suggest/corp",login:!0},loginUpdateInfo:{url:"/user/addUser",login:!1},addToAlbum:{url:"/photo/add",login:!0},corpMailInvite:{url:"/user/inviteCode",login:!0},updateInviteCode:{url:"/user/updateCode",login:!1},updateMonolog:{url:"/user/monolog/update",login:!0,silent:!0},canMonologUpdate:{url:"/user/monolog/canupdate",login:!0,silent:!0},checkNickName:{url:"/user/checkName",login:!1},getEmotion:{url:"/emotion/getAll",login:!0},sendLetter:{url:"/trend/writeLoveNotes",login:!0,silent:!0},reportBlock:{url:"/blacklist/add",login:!0,silent:!0},cancelBlock:{url:"/blacklist/remove",login:!0,silent:!0},addAnswer:{url:"/question/answer",login:!0,silent:!0},skipQuestion:{url:"/question/skip",login:!0,silent:!0},newQuestion:{url:"/question/suggest",login:!0,silent:!0},questionRecommend:{url:"/question/suggestUserList",login:!0,silent:!0},questionList:{url:"/question/questionList",login:!0,silent:!0},compareList:{url:"/question/compareList",login:!0,silent:!0},unverifyWeibo:{url:"/user/verify/unverifyMicroblog",login:!0,silent:!0},unverifyDouban:{url:"/user/verify/unverifyDouban",login:!0,silent:!0},rightAds:{url:"/operation/rightAds",login:!0,silent:!0},goodNews:{url:"/operation/successfulStory",login:!0,silent:!0},rightActivities:{url:"/operation/activities",login:!1,silent:!0},payLogin:{url:"/pay/login",login:!0,silent:!0},saveNewOrder:{url:"/pay/saveNewOrder",login:!0,silent:!0},saveNewOrderForDeal:{url:"/pay/saveNewOrderForDeal",login:!0,silent:!0},chargeBillList:{url:"/pay/orderList",login:!0,silent:!0},expenseBillList:{url:"/pay/dealInfoList",login:!0,silent:!0},closeTrade:{url:"/pay/closeTrade",login:!0,silent:!0},closeDeal:{url:"/pay/closeDeal",login:!0,silent:!0},visitBuy:{url:"/pay/visitBuy",login:!0,silent:!0},informBuy:{url:"/pay/onlineRemindBuy",login:!0,silent:!0},loginRemind:{url:"/settings/onlineRemind/set",login:!0,silent:!0},createNewDeal:{url:"/pay/createNewDeal",login:!0,silent:!0},payDeal:{url:"/pay/deal",login:!0,silent:!0},signForCoin:{url:"/pay/signed",login:!0,silent:!0},astroSuggest:{url:"/park/astroSuggest",login:!0,silent:!0},companyNameVerify:{url:"/corp/getEmail",login:!0,silent:!0},companyMailVerify:{url:"/corp/emailAuth",login:!0,silent:!0},commitVerifyFile:{url:"/corp/imageAuth",login:!0,silent:!0},getChartlet:{url:"/chartlet/list",login:!0,silent:!0},createPresentDeal:{url:"/pay/createPresentDeal",login:!0,silent:!0},recommendList:{url:"/park/xunrenlist",login:!1,silent:!0},deblocking:{url:"/user/plead",login:!1,silent:!1},balloonBuy:{url:"/pay/buyService?serviceId=-6491788925688873261",login:!1,silent:!0},singlesDayBuy:{url:"/pay/buyService?serviceId=31890713254037487",login:!1,silent:!0},getGift:{url:"/gift/getGifts",login:!0,silent:!0},giftReceiveList:{url:"/messages/giftList",login:!0,silent:!0},giftBoxList:{url:"/gift/giftBoxList",login:!0,silent:!0},getTag:{url:"/tag/all",login:!0,silent:!0},saveTag:{url:"/tag/save",login:!0,silent:!0},vipBuy:{url:"/pay/buyTimeService",login:!0,silent:!0},upgradeVip:{url:"/deal/vip/upgradeVIPService",login:!0,silent:!0},createUpgradeDeal:{url:"/deal/vip/createNewUpgradeDeal",login:!0,silent:!0},diggingList:{url:"/messages/like/sendPraiseList",login:!0,silent:!0},unDislike:{url:"/dislike/unDislike",login:!0,silent:!0},dislikeList:{url:"/dislike/list",login:!0,silent:!0},topicList:{url:"/park/topic/list",login:!1,silent:!0},partyList:{url:"/park/partylist",login:!1,silent:!0},addTopicComment:{url:"/park/topic/comment/add",login:!0,silent:!0},deleteTopicComment:{url:"/park/topic/comment/delete",login:!0,silent:!0},topicCommentList:{url:"/park/topic/comment/list",login:!1,silent:!0},guestList:{url:"/park/lovefm/guestlist",login:!0,silent:!0},exchangeCoupon:{url:"/coupon/getCode",login:!0,silent:!0},couponConfirm:{url:"/coupon/exchange",login:!0,silent:!0},checkVerifyCode:{url:"/photo/checkVerifyCode",login:!1,silent:!1},partySignup:{url:"/park/party/apply",login:!0,silent:!0},topBannerList:{url:"/banner/homeTop",login:!0,silent:!0},topBannerClose:{url:"/banner/homeTop/close",login:!0,silent:!0},femaleStarList:{url:"/park/star/starlist",login:!1,silent:!0},maleStarList:{url:"/park/star/starlist",login:!1,silent:!0},getToShowInfo:{url:"/park/star/bid",login:!0,silent:!0},getRanking:{url:"/park/star/bidRank",login:!0,silent:!0},createStarDeal:{url:"/deal/star/createNewDeal",login:!0,silent:!0}};return d});define("utils/data/selectData",function(a,b,c){var d=a("lib/jquery"),e={sex:{1:"\u7537",2:"\u5973"},openedCity:{"1-0":"\u5317\u4eac","2-0":"\u4e0a\u6d77","7-1":"\u5e7f\u5dde","5-1":"\u676d\u5dde","7-3":"\u6df1\u5733","3-0":"\u5929\u6d25","4-0":"\u91cd\u5e86","5-0":"\u6d59\u6c5f","6-0":"\u6c5f\u82cf","7-0":"\u5e7f\u4e1c","8-0":"\u798f\u5efa","9-0":"\u6e56\u5357","10-0":"\u6e56\u5317","11-0":"\u8fbd\u5b81","12-0":"\u5409\u6797","13-0":"\u9ed1\u9f99\u6c5f","14-0":"\u6cb3\u5317","15-0":"\u6cb3\u5357","16-0":"\u5c71\u4e1c","17-0":"\u9655\u897f","18-0":"\u7518\u8083","19-0":"\u9752\u6d77","20-0":"\u65b0\u7586","21-0":"\u5c71\u897f","22-0":"\u56db\u5ddd","23-0":"\u8d35\u5dde","24-0":"\u5b89\u5fbd","25-0":"\u6c5f\u897f","26-0":"\u4e91\u5357","27-0":"\u5185\u8499\u53e4","28-0":"\u5e7f\u897f","29-0":"\u897f\u85cf","30-0":"\u5b81\u590f","31-0":"\u6d77\u5357","32-0":"\u9999\u6e2f","33-0":"\u6fb3\u95e8","34-0":"\u53f0\u6e7e","35-0":"\u6d77\u5916","36-0":"\u5176\u4ed6"},education:{1:"\u5927\u4e13\u4ee5\u4e0b",2:"\u5927\u4e13",3:"\u672c\u79d1",4:"\u7855\u58eb",5:"\u535a\u58eb"},industry:{1:"\u8ba1\u7b97\u673a/\u4e92\u8054\u7f51/\u901a\u4fe1",2:"\u516c\u52a1\u5458/\u4e8b\u4e1a\u5355\u4f4d",3:"\u6559\u5e08",4:"\u533b\u751f",5:"\u62a4\u58eb",6:"\u7a7a\u4e58\u4eba\u5458",7:"\u751f\u4ea7/\u5de5\u827a/\u5236\u9020",8:"\u5546\u4e1a/\u670d\u52a1\u4e1a/\u4e2a\u4f53\u7ecf\u8425",9:"\u91d1\u878d/\u94f6\u884c/\u6295\u8d44/\u4fdd\u9669",10:"\u6587\u5316/\u5e7f\u544a/\u4f20\u5a92",11:"\u5a31\u4e50/\u827a\u672f/\u8868\u6f14",12:"\u5f8b\u5e08/\u6cd5\u52a1",13:"\u6559\u80b2/\u57f9\u8bad/\u7ba1\u7406\u54a8\u8be2",14:"\u5efa\u7b51/\u623f\u5730\u4ea7/\u7269\u4e1a",15:"\u6d88\u8d39\u96f6\u552e/\u8d38\u6613/\u4ea4\u901a\u7269\u6d41",16:"\u9152\u5e97\u65c5\u6e38",17:"\u73b0\u4ee3\u519c\u4e1a",18:"\u5728\u6821\u5b66\u751f"},marriageStatus:{1:"\u672a\u5a5a",2:"\u79bb\u5f02",3:"\u4e27\u5076",4:"\u5df2\u5a5a"},marriageStatusFilter:{1:"\u672a\u5a5a",2:"\u79bb\u5f02",3:"\u4e27\u5076"},lookingFor:{1:"\u7ed3\u5a5a\u5bf9\u8c61",2:"\u604b\u4eba",3:"\u666e\u901a\u670b\u53cb",4:"\u77e5\u5df1"},house:{1:"\u5df2\u8d2d\u623f",2:"\u79df\u623f",3:"\u5355\u4f4d\u5bbf\u820d",4:"\u548c\u5bb6\u4eba\u540c\u4f4f"},birthOrder:{1:"\u72ec\u751f\u5b50\u5973",2:"\u8001\u5927",3:"\u8001\u4e8c",4:"\u8001\u4e09",5:"\u8001\u56db",6:"\u8001\u4e94\u53ca\u66f4\u5c0f",7:"\u8001\u5e7a"},childStatus:{1:"\u65e0\u5c0f\u5b69",2:"\u6709\u5c0f\u5b69\u5f52\u81ea\u5df1",3:"\u6709\u5c0f\u5b69\u5f52\u5bf9\u65b9"},religion:{1:"\u65e0\u5b97\u6559\u4fe1\u4ef0",2:"\u5927\u4e58\u4f5b\u6559\u663e\u5b97",3:"\u5927\u4e58\u4f5b\u6559\u5bc6\u5b97",4:"\u5927\u4e58\u4f5b\u6559\u51c0\u5b97",5:"\u5c0f\u4e58\u4f5b\u6559",6:"\u9053\u6559",7:"\u5112\u6559",8:"\u57fa\u7763\u6559\u5929\u4e3b\u6559\u6d3e",9:"\u57fa\u7763\u6559\u4e1c\u6b63\u6559\u6d3e",10:"\u57fa\u7763\u6559\u65b0\u6559\u6d3e",11:"\u72b9\u592a\u6559",12:"\u4f0a\u65af\u5170\u6559\u4ec0\u53f6\u6d3e",13:"\u4f0a\u65af\u5170\u6559\u900a\u5c3c\u6d3e",14:"\u5370\u5ea6\u6559",15:"\u795e\u9053\u6559",16:"\u8428\u6ee1\u6559",17:"\u5176\u4ed6\u6559\u6d3e"},car:{1:"\u5df2\u8d2d\u8f66",2:"\u672a\u8d2d\u8f66"},blood:{1:"A",2:"B",3:"AB",4:"O"},nationality:{1:"\u6c49",2:"\u8499\u53e4",3:"\u56de",4:"\u85cf",5:"\u7ef4\u543e\u5c14",6:"\u82d7",7:"\u5f5d",8:"\u58ee",9:"\u5e03\u4f9d",10:"\u671d\u9c9c",11:"\u6ee1",12:"\u4f97",13:"\u7476",14:"\u767d",15:"\u571f\u5bb6",16:"\u54c8\u5c3c",17:"\u54c8\u8428\u514b",18:"\u50a3",19:"\u9ece",20:"\u5088\u50f3",21:"\u4f64",22:"\u7572",23:"\u9ad8\u5c71",24:"\u62c9\u795c",25:"\u6c34",26:"\u4e1c\u4e61",27:"\u7eb3\u897f",28:"\u666f\u9887",29:"\u67ef\u5c14\u514b\u5b5c",30:"\u571f",31:"\u8fbe\u65a1\u5c14",32:"\u4eeb\u4f6c",33:"\u7f8c",34:"\u5e03\u6717",35:"\u6492\u62c9",36:"\u6bdb\u5357",37:"\u4ee1\u4f6c",38:"\u9521\u4f2f",39:"\u963f\u660c",40:"\u666e\u7c73",41:"\u5854\u5409\u514b",42:"\u6012",43:"\u4e4c\u5b5c\u522b\u514b",44:"\u4fc4\u7f57\u65af",45:"\u9102\u6e29\u514b",46:"\u5fb7\u6602",47:"\u4fdd\u5b89",48:"\u88d5\u56fa",49:"\u4eac",50:"\u5854\u5854\u5c14",51:"\u72ec\u9f99",52:"\u9102\u4f26\u6625",53:"\u8d6b\u54f2",54:"\u95e8\u5df4",55:"\u73de\u5df4",56:"\u57fa\u8bfa"},position:{1:"\u666e\u901a\u804c\u5458",2:"\u4e2d\u5c42\u7ba1\u7406\u8005",3:"\u9ad8\u5c42\u7ba1\u7406\u8005",4:"\u4f01\u4e1a\u4e3b",5:"\u5b66\u751f"},salary:{"-1":"2000\u5143\u4ee5\u4e0b",1:"2000-4000\u5143",2:"4000-6000\u5143",3:"6000-10000\u5143",4:"10000-15000\u5143",5:"15000-20000\u5143",6:"20000-50000\u5143",7:"50000\u5143\u4ee5\u4e0a"},salaryArray:[{key:-1,val:"2000\u5143\u4ee5\u4e0b"},{key:1,val:"2000-4000\u5143"},{key:2,val:"4000-6000\u5143"},{key:3,val:"6000-10000\u5143"},{key:4,val:"10000-15000\u5143"},{key:5,val:"15000-20000\u5143"},{key:6,val:"20000-50000\u5143"},{key:7,val:"50000\u5143\u4ee5\u4e0a"}],searchSalaryArray:[{key:-1,val:"2000\u5143\u4ee5\u4e0b"},{key:1,val:"2000\u5143\u4ee5\u4e0a"},{key:2,val:"4000\u5143\u4ee5\u4e0a"},{key:3,val:"6000\u5143\u4ee5\u4e0a"},{key:4,val:"10000\u5143\u4ee5\u4e0a"},{key:5,val:"15000\u5143\u4ee5\u4e0a"},{key:6,val:"20000\u5143\u4ee5\u4e0a"},{key:7,val:"50000\u5143\u4ee5\u4e0a"}],status:{1:"\u5bfb\u89c5\u5bf9\u8c61\u4e2d",3:"\u5df2\u6709\u5bf9\u8c61\uff0c\u4e0d\u518d\u5bfb\u89c5"},expDegree:{1:"\u5927\u4e13\u53ca\u4ee5\u4e0a",2:"\u672c\u79d1\u53ca\u4ee5\u4e0a",3:"\u7855\u58eb\u53ca\u4ee5\u4e0a",4:"\u535a\u58eb\u53ca\u4ee5\u4e0a"},expSalary:{"-1":2e3,1:4e3,2:6e3,3:1e4,4:2e4,5:5e4},expSalaryArray:[{key:-1,val:2e3},{key:1,val:4e3},{key:2,val:6e3},{key:3,val:1e4},{key:4,val:2e4},{key:5,val:5e4}],cooking:{1:"\u4f1a\u505a\u996d\uff0c\u5e0c\u671b\u5bf9\u65b9\u4e5f\u4f1a",2:"\u4f1a\u505a\u996d\uff0c\u5bf9\u53e6\u4e00\u534a\u6ca1\u8981\u6c42",3:"\u4e0d\u592a\u4f1a\uff0c\u5bf9\u53e6\u4e00\u534a\u6ca1\u8981\u6c42",4:"\u4e0d\u592a\u4f1a\uff0c\u5e0c\u671b\u5bf9\u65b9\u53a8\u827a\u6bd4\u6211\u597d"},arrangement:{1:"\u5de5\u4f5c\u65f6\u95f4\u56fa\u5b9a\uff0c\u4e0d\u63a5\u53d7\u5bf9\u65b9\u51fa\u5dee",2:"\u5de5\u4f5c\u65f6\u95f4\u56fa\u5b9a\uff0c\u4e0d\u4ecb\u610f\u5bf9\u65b9\u51fa\u5dee",3:"\u5de5\u4f5c\u7ecf\u5e38\u51fa\u5dee",4:"\u5de5\u4f5c\u5076\u5c14\u51fa\u5dee"},smoking:{1:"\u4e0d\u5438\u70df\uff0c\u4e14\u5f88\u53cd\u611f\u5438\u70df",2:"\u4e0d\u5438\u70df\uff0c\u4f46\u4e5f\u4e0d\u53cd\u611f",3:"\u5076\u5c14\u5438\u70df",4:"\u7ecf\u5e38\u5438\u70df"},drink:{1:"\u4e0d\u559d\u9152\uff0c\u4e14\u5f88\u53cd\u611f\u559d\u9152",2:"\u4e0d\u559d\u9152\uff0c\u4f46\u4e5f\u4e0d\u53cd\u611f",3:"\u793e\u4ea4\u9700\u8981\u65f6\u624d\u559d",4:"\u7ecf\u5e38\u559d\u9152"},loveAndMarriage:{1:"\u80fd\u63a5\u53d7\u95ea\u5a5a",2:"\u4e00\u5e74\u5185",3:"\u4e24\u5e74\u5185",4:"\u4e09\u5e74\u53ca\u4ee5\u4e0a",5:"\u6682\u65f6\u4e0d\u60f3\u7ed3\u5a5a"},needChild:{1:"\u60f3\u8981\u5b69\u5b50",2:"\u4e0d\u60f3\u8981\u5b69\u5b50",3:"\u89c6\u60c5\u51b5\u800c\u5b9a"},withParents:{1:"\u4e0d\u4ecb\u610f",2:"\u4ecb\u610f"},housework:{1:"\u8fd9\u662f\u59bb\u5b50\u7684\u5206\u5185\u4e8b",2:"\u592b\u59bb\u5e73\u5747\u5206\u914d",3:"\u8c01\u6709\u65f6\u95f4\u8c01\u505a",4:"\u592b\u59bb\u5404\u81ea\u627f\u62c5\u81ea\u5df1\u64c5\u957f\u7684\u5bb6\u52a1"},financial:{1:"\u7531\u592b\u59bb\u5171\u540c\u8ba1\u5212",2:"\u592b\u59bb\u5404\u81ea\u652f\u914d\u5404\u81ea\u7684\u6536\u5165",3:"\u7531\u59bb\u5b50\u6253\u7406",4:"\u7531\u4e08\u592b\u6253\u7406"},constellation:{1:"\u9b54\u7faf",2:"\u6c34\u74f6",3:"\u53cc\u9c7c",4:"\u767d\u7f8a",5:"\u91d1\u725b",6:"\u53cc\u5b50",7:"\u5de8\u87f9",8:"\u72ee\u5b50",9:"\u5904\u5973",10:"\u5929\u79e4",11:"\u5929\u874e",12:"\u5c04\u624b"},zodiac:{1:"\u9f20",2:"\u725b",3:"\u864e",4:"\u5154",5:"\u9f99",6:"\u86c7",7:"\u9a6c",8:"\u7f8a",9:"\u7334",10:"\u9e21",11:"\u72d7",12:"\u732a"},height:function(a,b,c){var d={},e=1;b=b||150,c=c||210;for(var f=b;f<=c;f++)d[f]=f,e+=1;return d},age:function(a,b,c){var d={},e=1;b=b||18,c=c||60;for(var f=b;f<=c;f++)d[f]=f,e+=1;return d},city:{all:function(){return d.extend(this.mainland,this.overseas)},mainland:{1:"\u5317\u4eac",2:"\u4e0a\u6d77",3:"\u5929\u6d25",4:"\u91cd\u5e86",5:"\u6d59\u6c5f",6:"\u6c5f\u82cf",7:"\u5e7f\u4e1c",8:"\u798f\u5efa",9:"\u6e56\u5357",10:"\u6e56\u5317",11:"\u8fbd\u5b81",12:"\u5409\u6797",13:"\u9ed1\u9f99\u6c5f",14:"\u6cb3\u5317",15:"\u6cb3\u5357",16:"\u5c71\u4e1c",17:"\u9655\u897f",18:"\u7518\u8083",19:"\u9752\u6d77",20:"\u65b0\u7586",21:"\u5c71\u897f",22:"\u56db\u5ddd",23:"\u8d35\u5dde",24:"\u5b89\u5fbd",25:"\u6c5f\u897f",26:"\u4e91\u5357",27:"\u5185\u8499\u53e4",28:"\u5e7f\u897f",29:"\u897f\u85cf",30:"\u5b81\u590f",31:"\u6d77\u5357"},overseas:{32:"\u9999\u6e2f",33:"\u6fb3\u95e8",34:"\u53f0\u6e7e",35:"\u6d77\u5916",36:"\u5176\u4ed6\u5730\u533a"},opened:{1:"\u5317\u4eac",2:"\u4e0a\u6d77","7-1":"\u5e7f\u5dde","5-1":"\u676d\u5dde","7-3":"\u6df1\u5733"},specialCity:{1:"\u5317\u4eac",2:"\u4e0a\u6d77",3:"\u5929\u6d25",4:"\u91cd\u5e86"},specialCities:[1,2,3,4,32,33,34,36],city:{1:{1:"\u4e1c\u57ce\u533a",2:"\u897f\u57ce\u533a",3:"\u5d07\u6587\u533a",4:"\u5ba3\u6b66\u533a",5:"\u671d\u9633\u533a",6:"\u4e30\u53f0\u533a",7:"\u77f3\u666f\u5c71\u533a",8:"\u6d77\u6dc0\u533a",9:"\u95e8\u5934\u6c9f\u533a",10:"\u623f\u5c71\u533a",11:"\u901a\u5dde\u533a",12:"\u987a\u4e49\u533a",13:"\u660c\u5e73\u533a",14:"\u5927\u5174\u533a",15:"\u6000\u67d4\u533a",16:"\u5e73\u8c37\u533a",17:"\u5bc6\u4e91\u53bf",18:"\u5ef6\u5e86\u53bf"},2:{1:"\u9ec4\u6d66\u533a",2:"\u5362\u6e7e\u533a",3:"\u5f90\u6c47\u533a",4:"\u957f\u5b81\u533a",5:"\u9759\u5b89\u533a",6:"\u666e\u9640\u533a",7:"\u95f8\u5317\u533a",8:"\u8679\u53e3\u533a",9:"\u6768\u6d66\u533a",10:"\u95f5\u884c\u533a",11:"\u5b9d\u5c71\u533a",12:"\u5609\u5b9a\u533a",13:"\u6d66\u4e1c\u65b0\u533a",14:"\u91d1\u5c71\u533a",15:"\u677e\u6c5f\u533a",16:"\u9752\u6d66\u533a",17:"\u5357\u6c47\u533a",18:"\u5949\u8d24\u533a",19:"\u5d07\u660e\u53bf"},3:{1:"\u548c\u5e73\u533a",2:"\u6cb3\u4e1c\u533a",3:"\u6cb3\u897f\u533a",4:"\u5357\u5f00\u533a",5:"\u6cb3\u5317\u533a",6:"\u7ea2\u6865\u533a",7:"\u5858\u6cbd\u533a",8:"\u6c49\u6cbd\u533a",9:"\u5927\u6e2f\u533a",10:"\u4e1c\u4e3d\u533a",11:"\u897f\u9752\u533a",12:"\u6d25\u5357\u533a",13:"\u5317\u8fb0\u533a",14:"\u6b66\u6e05\u533a",15:"\u5b9d\u577b\u533a",16:"\u5b81\u6cb3\u53bf",17:"\u9759\u6d77\u53bf",18:"\u84df\u53bf"},4:{1:"\u4e07\u5dde\u533a",2:"\u6daa\u9675\u533a",3:"\u6e1d\u4e2d\u533a",4:"\u5927\u6e21\u53e3\u533a",5:"\u6c5f\u5317\u533a",6:"\u6c99\u576a\u575d\u533a",7:"\u4e5d\u9f99\u5761\u533a",8:"\u5357\u5cb8\u533a",9:"\u5317\u789a\u533a",10:"\u4e07\u76db\u533a",11:"\u53cc\u6865\u533a",12:"\u6e1d\u5317\u533a",13:"\u5df4\u5357\u533a",14:"\u9ed4\u6c5f\u533a",15:"\u957f\u5bff\u533a",16:"\u7da6\u6c5f\u53bf",17:"\u6f7c\u5357\u53bf",18:"\u94dc\u6881\u53bf",19:"\u5927\u8db3\u53bf",20:"\u8363\u660c\u53bf",21:"\u74a7\u5c71\u53bf",22:"\u6881\u5e73\u53bf",23:"\u57ce\u53e3\u53bf",24:"\u4e30\u90fd\u53bf",25:"\u57ab\u6c5f\u53bf",26:"\u6b66\u9686\u53bf",27:"\u5fe0\u53bf",28:"\u5f00\u53bf",29:"\u4e91\u9633\u53bf",30:"\u5949\u8282\u53bf",31:"\u5deb\u5c71\u53bf",32:"\u5deb\u6eaa\u53bf",33:"\u77f3\u67f1\u53bf",34:"\u79c0\u5c71\u53bf",35:"\u9149\u9633\u53bf",36:"\u5f6d\u6c34\u53bf",37:"\u6c5f\u6d25\u5e02",38:"\u5408\u5ddd\u5e02",39:"\u6c38\u5ddd\u5e02",40:"\u5357\u5ddd\u5e02"},5:{1:"\u676d\u5dde",2:"\u5b81\u6ce2",3:"\u6e29\u5dde",4:"\u5609\u5174",5:"\u6e56\u5dde",6:"\u7ecd\u5174",7:"\u91d1\u534e",8:"\u8862\u5dde",9:"\u821f\u5c71",10:"\u53f0\u5dde",11:"\u4e3d\u6c34"},6:{1:"\u5357\u4eac",2:"\u65e0\u9521",3:"\u5f90\u5dde",4:"\u5e38\u5dde",5:"\u82cf\u5dde",6:"\u5357\u901a",7:"\u8fde\u4e91\u6e2f",8:"\u6dee\u5b89",9:"\u76d0\u57ce",10:"\u626c\u5dde",11:"\u9547\u6c5f",12:"\u6cf0\u5dde",13:"\u5bbf\u8fc1"},7:{1:"\u5e7f\u5dde",2:"\u97f6\u5173",3:"\u6df1\u5733",4:"\u73e0\u6d77",5:"\u6c55\u5934",6:"\u4f5b\u5c71",7:"\u6c5f\u95e8",8:"\u6e5b\u6c5f",9:"\u8302\u540d",10:"\u8087\u5e86",11:"\u60e0\u5dde",12:"\u6885\u5dde",13:"\u6c55\u5c3e",14:"\u6cb3\u6e90",15:"\u9633\u6c5f",16:"\u6e05\u8fdc",17:"\u4e1c\u839e",18:"\u4e2d\u5c71",19:"\u6f6e\u5dde",20:"\u63ed\u9633",21:"\u4e91\u6d6e"},8:{1:"\u798f\u5dde",2:"\u53a6\u95e8",3:"\u8386\u7530",4:"\u4e09\u660e",5:"\u6cc9\u5dde",6:"\u6f33\u5dde",7:"\u5357\u5e73",8:"\u9f99\u5ca9",9:"\u5b81\u5fb7"},9:{1:"\u957f\u6c99",2:"\u682a\u6d32",3:"\u6e58\u6f6d",4:"\u8861\u9633",5:"\u90b5\u9633",6:"\u5cb3\u9633",7:"\u5e38\u5fb7",8:"\u5f20\u5bb6\u754c",9:"\u76ca\u9633",10:"\u90f4\u5dde",11:"\u6c38\u5dde",12:"\u6000\u5316",13:"\u5a04\u5e95",14:"\u6e58\u897f"},10:{1:"\u6b66\u6c49",2:"\u9ec4\u77f3",3:"\u5341\u5830",4:"\u5b9c\u660c",5:"\u8944\u6a0a",6:"\u9102\u5dde",7:"\u8346\u95e8",8:"\u5b5d\u611f",9:"\u8346\u5dde",10:"\u9ec4\u5188",11:"\u54b8\u5b81",12:"\u968f\u5dde",13:"\u6069\u65bd",14:"\u4ed9\u6843",15:"\u6f5c\u6c5f",16:"\u5929\u95e8",17:"\u795e\u519c\u67b6"},11:{1:"\u6c88\u9633",2:"\u5927\u8fde",3:"\u978d\u5c71",4:"\u629a\u987a",5:"\u672c\u6eaa",6:"\u4e39\u4e1c",7:"\u9526\u5dde",8:"\u8425\u53e3",9:"\u961c\u65b0",10:"\u8fbd\u9633",11:"\u76d8\u9526",12:"\u94c1\u5cad",13:"\u671d\u9633",14:"\u846b\u82a6\u5c9b"},12:{1:"\u957f\u6625",2:"\u5409\u6797",3:"\u56db\u5e73",4:"\u8fbd\u6e90",5:"\u901a\u5316",6:"\u767d\u5c71",7:"\u677e\u539f",8:"\u767d\u57ce",9:"\u5ef6\u8fb9"},13:{1:"\u54c8\u5c14\u6ee8",2:"\u9f50\u9f50\u54c8\u5c14",3:"\u9e21\u897f",4:"\u9e64\u5c97",5:"\u53cc\u9e2d\u5c71",6:"\u5927\u5e86",7:"\u4f0a\u6625",8:"\u4f73\u6728\u65af",9:"\u4e03\u53f0\u6cb3",10:"\u7261\u4e39\u6c5f",11:"\u9ed1\u6cb3",12:"\u7ee5\u5316",13:"\u5927\u5174\u5b89\u5cad"},14:{1:"\u77f3\u5bb6\u5e84",2:"\u5510\u5c71",3:"\u79e6\u7687\u5c9b",4:"\u90af\u90f8",5:"\u90a2\u53f0",6:"\u4fdd\u5b9a",7:"\u5f20\u5bb6\u53e3",8:"\u627f\u5fb7",9:"\u6ca7\u5dde",10:"\u5eca\u574a",11:"\u8861\u6c34"},15:{1:"\u90d1\u5dde",2:"\u5f00\u5c01",3:"\u6d1b\u9633",4:"\u5e73\u9876\u5c71",5:"\u5b89\u9633",6:"\u9e64\u58c1",7:"\u65b0\u4e61",8:"\u7126\u4f5c",9:"\u6fee\u9633",10:"\u8bb8\u660c",11:"\u6f2f\u6cb3",12:"\u4e09\u95e8\u5ce1",13:"\u5357\u9633",14:"\u5546\u4e18",15:"\u4fe1\u9633",16:"\u5468\u53e3",17:"\u9a7b\u9a6c\u5e97",18:"\u6d4e\u6e90"},16:{1:"\u6d4e\u5357",2:"\u9752\u5c9b",3:"\u6dc4\u535a",4:"\u67a3\u5e84",5:"\u4e1c\u8425",6:"\u70df\u53f0",7:"\u6f4d\u574a",8:"\u6d4e\u5b81",9:"\u6cf0\u5b89",10:"\u5a01\u6d77",11:"\u65e5\u7167",12:"\u83b1\u829c",13:"\u4e34\u6c82",14:"\u5fb7\u5dde",15:"\u804a\u57ce",16:"\u6ee8\u5dde",17:"\u83cf\u6cfd"},17:{1:"\u897f\u5b89",2:"\u94dc\u5ddd",3:"\u5b9d\u9e21",4:"\u54b8\u9633",5:"\u6e2d\u5357",6:"\u5ef6\u5b89",7:"\u6c49\u4e2d",8:"\u6986\u6797",9:"\u5b89\u5eb7",10:"\u5546\u6d1b"},18:{1:"\u5170\u5dde",2:"\u5609\u5cea\u5173",3:"\u91d1\u660c",4:"\u767d\u94f6",5:"\u5929\u6c34",6:"\u6b66\u5a01",7:"\u5f20\u6396",8:"\u5e73\u51c9",9:"\u9152\u6cc9",10:"\u5e86\u9633",11:"\u5b9a\u897f",12:"\u9647\u5357",13:"\u4e34\u590f",14:"\u7518\u5357"},19:{1:"\u897f\u5b81",2:"\u6d77\u4e1c",3:"\u6d77\u5317",4:"\u9ec4\u5357",5:"\u6d77\u5357",6:"\u679c\u6d1b",7:"\u7389\u6811",8:"\u6d77\u897f"},20:{1:"\u4e4c\u9c81\u6728\u9f50",2:"\u514b\u62c9\u739b\u4f9d",3:"\u5410\u9c81\u756a",4:"\u54c8\u5bc6",5:"\u660c\u5409",6:"\u535a\u5c14\u5854\u62c9",7:"\u5df4\u97f3\u90ed\u695e",8:"\u963f\u514b\u82cf",9:"\u514b\u5b5c\u52d2\u82cf",10:"\u5580\u4ec0",11:"\u548c\u7530",12:"\u4f0a\u7281",13:"\u5854\u57ce",14:"\u963f\u52d2\u6cf0",15:"\u77f3\u6cb3\u5b50",16:"\u963f\u62c9\u5c14",17:"\u56fe\u6728\u8212\u514b",18:"\u4e94\u5bb6\u6e20"},21:{1:"\u592a\u539f",2:"\u5927\u540c",3:"\u9633\u6cc9",4:"\u957f\u6cbb",5:"\u664b\u57ce",6:"\u6714\u5dde",7:"\u664b\u4e2d",8:"\u8fd0\u57ce",9:"\u5ffb\u5dde",10:"\u4e34\u6c7e",11:"\u5415\u6881"},22:{1:"\u6210\u90fd",2:"\u81ea\u8d21",3:"\u6500\u679d\u82b1",4:"\u6cf8\u5dde",5:"\u5fb7\u9633",6:"\u7ef5\u9633",7:"\u5e7f\u5143",8:"\u9042\u5b81",9:"\u5185\u6c5f",10:"\u4e50\u5c71",11:"\u5357\u5145",12:"\u7709\u5c71",13:"\u5b9c\u5bbe",14:"\u5e7f\u5b89",15:"\u8fbe\u5dde",16:"\u96c5\u5b89",17:"\u5df4\u4e2d",18:"\u8d44\u9633",19:"\u963f\u575d",20:"\u7518\u5b5c",21:"\u51c9\u5c71"},23:{1:"\u8d35\u9633",2:"\u516d\u76d8\u6c34",3:"\u9075\u4e49",4:"\u5b89\u987a",5:"\u94dc\u4ec1",6:"\u9ed4\u897f\u5357",7:"\u6bd5\u8282",8:"\u9ed4\u4e1c\u5357",9:"\u9ed4\u5357"},24:{1:"\u5408\u80a5",2:"\u829c\u6e56",3:"\u868c\u57e0",4:"\u6dee\u5357",5:"\u9a6c\u978d\u5c71",6:"\u6dee\u5317",7:"\u94dc\u9675",8:"\u5b89\u5e86",9:"\u9ec4\u5c71",10:"\u6ec1\u5dde",11:"\u961c\u9633",12:"\u5bbf\u5dde",13:"\u5de2\u6e56",14:"\u516d\u5b89",15:"\u4eb3\u5dde",16:"\u6c60\u5dde",17:"\u5ba3\u57ce"},25:{1:"\u5357\u660c",2:"\u666f\u5fb7\u9547",3:"\u840d\u4e61",4:"\u4e5d\u6c5f",5:"\u65b0\u4f59",6:"\u9e70\u6f6d",7:"\u8d63\u5dde",8:"\u5409\u5b89",9:"\u5b9c\u6625",10:"\u629a\u5dde",11:"\u4e0a\u9976"},26:{1:"\u6606\u660e",2:"\u66f2\u9756",3:"\u7389\u6eaa",4:"\u4fdd\u5c71",5:"\u662d\u901a",6:"\u4e3d\u6c5f",7:"\u666e\u6d31",8:"\u4e34\u6ca7",9:"\u695a\u96c4",10:"\u7ea2\u6cb3",11:"\u6587\u5c71",12:"\u897f\u53cc\u7248\u7eb3",13:"\u5927\u7406",14:"\u5fb7\u5b8f",15:"\u6012\u6c5f",16:"\u8fea\u5e86"},27:{1:"\u547c\u548c\u6d69\u7279",2:"\u5305\u5934",3:"\u4e4c\u6d77",4:"\u8d64\u5cf0",5:"\u901a\u8fbd",6:"\u9102\u5c14\u591a\u65af",7:"\u547c\u4f26\u8d1d\u5c14",8:"\u5df4\u5f66\u6dd6\u5c14",9:"\u4e4c\u5170\u5bdf\u5e03\u76df",10:"\u5174\u5b89\u76df",11:"\u9521\u6797\u90ed\u52d2\u76df",12:"\u963f\u62c9\u5584\u76df"},28:{1:"\u5357\u5b81",2:"\u67f3\u5dde",3:"\u6842\u6797",4:"\u68a7\u5dde",5:"\u5317\u6d77",6:"\u9632\u57ce\u6e2f",7:"\u94a6\u5dde",8:"\u8d35\u6e2f",9:"\u7389\u6797",10:"\u767e\u8272",11:"\u8d3a\u5dde",12:"\u6cb3\u6c60",13:"\u6765\u5bbe",14:"\u5d07\u5de6"},29:{1:"\u62c9\u8428",2:"\u660c\u90fd",3:"\u5c71\u5357",4:"\u65e5\u5580\u5219",5:"\u90a3\u66f2",6:"\u963f\u91cc",7:"\u6797\u829d"},30:{1:"\u94f6\u5ddd",2:"\u77f3\u5634\u5c71",3:"\u5434\u5fe0",4:"\u56fa\u539f",5:"\u4e2d\u536b"},31:{1:"\u6d77\u53e3",2:"\u4e09\u4e9a",3:"\u4e94\u6307\u5c71",4:"\u743c\u6d77",5:"\u510b\u5dde",6:"\u6587\u660c",7:"\u4e07\u5b81",8:"\u4e1c\u65b9",9:"\u5b9a\u5b89",10:"\u5c6f\u660c",11:"\u6f84\u8fc8",12:"\u4e34\u9ad8",13:"\u767d\u6c99",14:"\u660c\u6c5f",15:"\u4e50\u4e1c",16:"\u9675\u6c34",17:"\u4fdd\u4ead",18:"\u743c\u4e2d",19:"\u897f\u6c99\u7fa4\u5c9b",20:"\u5357\u6c99\u7fa4\u5c9b",21:"\u4e2d\u6c99\u7fa4\u5c9b"},32:{1:"\u4e2d\u897f\u533a",2:"\u4e1c\u533a",3:"\u4e5d\u9f99\u57ce\u533a",4:"\u89c2\u5858\u533a",5:"\u5357\u533a",6:"\u6df1\u6c34\u57d7\u533a",7:"\u9ec4\u5927\u4ed9\u533a",8:"\u6e7e\u4ed4\u533a",9:"\u6cb9\u5c16\u65fa\u533a",10:"\u79bb\u5c9b\u533a",11:"\u8475\u9752\u533a",12:"\u5317\u533a",13:"\u897f\u8d21\u533a",14:"\u6c99\u7530\u533a",15:"\u5c6f\u95e8\u533a",16:"\u5927\u57d4\u533a",17:"\u8343\u6e7e\u533a",18:"\u5143\u6717\u533a"},33:{1:"\u6fb3\u95e8"},34:{1:"\u53f0\u5317\u5e02",2:"\u9ad8\u96c4\u5e02",3:"\u57fa\u9686\u5e02",4:"\u53f0\u4e2d\u5e02",5:"\u53f0\u5357\u5e02",6:"\u65b0\u7af9\u5e02",7:"\u5609\u4e49\u5e02",9:"\u53f0\u5317\u53bf",10:"\u5b9c\u5170\u53bf",11:"\u6843\u56ed\u53bf",12:"\u65b0\u7af9\u53bf",13:"\u82d7\u6817\u53bf",14:"\u53f0\u4e2d\u53bf",15:"\u5f70\u5316\u53bf",16:"\u5357\u6295\u53bf",17:"\u4e91\u6797\u53bf",18:"\u5609\u4e49\u53bf",19:"\u53f0\u5357\u53bf",20:"\u9ad8\u96c4\u53bf",21:"\u5c4f\u4e1c\u53bf",22:"\u6f8e\u6e56\u53bf",23:"\u53f0\u4e1c\u53bf",24:"\u82b1\u83b2\u53bf"},35:{1:"\u7f8e\u56fd",2:"\u52a0\u62ff\u5927",3:"\u6fb3\u5927\u5229\u4e9a",4:"\u65b0\u897f\u5170",5:"\u82f1\u56fd",6:"\u6cd5\u56fd",7:"\u5fb7\u56fd",8:"\u6377\u514b",9:"\u8377\u5170",10:"\u745e\u58eb",11:"\u5e0c\u814a",12:"\u632a\u5a01",13:"\u745e\u5178",14:"\u4e39\u9ea6",15:"\u82ac\u5170",16:"\u7231\u5c14\u5170",17:"\u5965\u5730\u5229",18:"\u610f\u5927\u5229",19:"\u4e4c\u514b\u5170",20:"\u4fc4\u7f57\u65af",21:"\u897f\u73ed\u7259",22:"\u97e9\u56fd",23:"\u65b0\u52a0\u5761",24:"\u9a6c\u6765\u897f\u4e9a",25:"\u5370\u5ea6",26:"\u6cf0\u56fd",27:"\u65e5\u672c",28:"\u5df4\u897f",29:"\u963f\u6839\u5ef7",30:"\u5357\u975e",31:"\u57c3\u53ca"},36:{1:"\u5176\u4ed6\u5730\u533a"}}}};return e});define("lib/swfobject",function(a,b,c){function Y(a){var b=/[\\\"<>\.;]/,c=b.exec(a)!=null;return c&&typeof encodeURIComponent!=d?encodeURIComponent(a):a}function X(a,b){if(!!A){var c=b?"visible":"hidden";w&&S(a)?S(a).style.visibility=c:W("#"+a,"visibility:"+c)}}function W(a,b,c,f){if(!B.ie||!B.mac){var g=l.getElementsByTagName("head")[0];if(!g)return;var h=c&&typeof c=="string"?c:"screen";f&&(y=null,z=null);if(!y||z!=h){var i=T("style");i.setAttribute("type","text/css"),i.setAttribute("media",h),y=g.appendChild(i),B.ie&&B.win&&typeof l.styleSheets!=d&&l.styleSheets.length>0&&(y=l.styleSheets[l.styleSheets.length-1]),z=h}B.ie&&B.win?y&&typeof y.addRule==e&&y.addRule(a,b):y&&typeof l.createTextNode!=d&&y.appendChild(l.createTextNode(a+" {"+b+"}"))}}function V(a){var b=B.pv,c=a.split(".");c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0;return b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function U(a,b,c){a.attachEvent(b,c),r[r.length]=[a,b,c]}function T(a){return l.createElement(a)}function S(a){var b=null;try{b=l.getElementById(a)}catch(c){}return b}function R(a){var b=S(a);if(b){for(var c in b)typeof b[c]=="function"&&(b[c]=null);b.parentNode.removeChild(b)}}function Q(a){var b=S(a);b&&b.nodeName=="OBJECT"&&(B.ie&&B.win?(b.style.display="none",function(){b.readyState==4?R(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function P(a,b,c){var d=T("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function O(a,b,c){var f,g=S(c);if(B.wk&&B.wk<312)return f;if(g){typeof a.id==d&&(a.id=c);if(B.ie&&B.win){var i="";for(var j in a)a[j]!=Object.prototype[j]&&(j.toLowerCase()=="data"?b.movie=a[j]:j.toLowerCase()=="styleclass"?i+=' class="'+a[j]+'"':j.toLowerCase()!="classid"&&(i+=" "+j+'="'+a[j]+'"'));var k="";for(var l in b)b[l]!=Object.prototype[l]&&(k+='<param name="'+l+'" value="'+b[l]+'" />');g.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+i+">"+k+"</object>",q[q.length]=a.id,f=S(a.id)}else{var m=T(e);m.setAttribute("type",h);for(var n in a)a[n]!=Object.prototype[n]&&(n.toLowerCase()=="styleclass"?m.setAttribute("class",a[n]):n.toLowerCase()!="classid"&&m.setAttribute(n,a[n]));for(var o in b)b[o]!=Object.prototype[o]&&o.toLowerCase()!="movie"&&P(m,o,b[o]);g.parentNode.replaceChild(m,g),f=m}}return f}function N(a){var b=T("div");if(B.win&&B.ie)b.innerHTML=a.innerHTML;else{var c=a.getElementsByTagName(e)[0];if(c){var d=c.childNodes;if(d){var f=d.length;for(var g=0;g<f;g++)(d[g].nodeType!=1||d[g].nodeName!="PARAM")&&d[g].nodeType!=8&&b.appendChild(d[g].cloneNode(!0))}}}return b}function M(a){if(B.ie&&B.win&&a.readyState!=4){var b=T("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(N(a),b),a.style.display="none",function(){a.readyState==4?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(N(a),a)}function L(a,b,c,e){x=!0,u=e||null,v={success:!1,id:c};var f=S(c);if(f){f.nodeName=="OBJECT"?(s=N(f),t=null):(s=f,t=c),a.id=i;if(typeof a.width==d||!/%$/.test(a.width)&&parseInt(a.width,10)<310)a.width="310";if(typeof a.height==d||!/%$/.test(a.height)&&parseInt(a.height,10)<137)a.height="137";l.title=l.title.slice(0,47)+" - Flash Player Installation";var g=B.ie&&B.win?"ActiveX":"PlugIn",h="MMredirectURL="+k.location.toString().replace(/&/g,"%26")+"&MMplayerType="+g+"&MMdoctitle="+l.title;typeof b.flashvars!=d?b.flashvars+="&"+h:b.flashvars=h;if(B.ie&&B.win&&f.readyState!=4){var j=T("div");c+="SWFObjectNew",j.setAttribute("id",c),f.parentNode.insertBefore(j,f),f.style.display="none",function(){f.readyState==4?f.parentNode.removeChild(f):setTimeout(arguments.callee,10)}()}O(a,b,c)}}function K(){return!x&&V("6.0.65")&&(B.win||B.mac)&&!(B.wk&&B.wk<312)}function J(a){var b=null,c=S(a);if(c&&c.nodeName=="OBJECT")if(typeof c.SetVariable!=d)b=c;else{var f=c.getElementsByTagName(e)[0];f&&(b=f)}return b}function I(){var a=p.length;if(a>0)for(var b=0;b<a;b++){var c=p[b].id,e=p[b].callbackFn,f={success:!1,id:c};if(B.pv[0]>0){var g=S(c);if(g)if(V(p[b].swfVersion)&&!(B.wk&&B.wk<312))X(c,!0),e&&(f.success=!0,f.ref=J(c),e(f));else if(p[b].expressInstall&&K()){var h={};h.data=p[b].expressInstall,h.width=g.getAttribute("width")||"0",h.height=g.getAttribute("height")||"0",g.getAttribute("class")&&(h.styleclass=g.getAttribute("class")),g.getAttribute("align")&&(h.align=g.getAttribute("align"));var i={},j=g.getElementsByTagName("param"),k=j.length;for(var l=0;l<k;l++)j[l].getAttribute("name").toLowerCase()!="movie"&&(i[j[l].getAttribute("name")]=j[l].getAttribute("value"));L(h,i,c,e)}else M(g),e&&e(f)}else{X(c,!0);if(e){var m=J(c);m&&typeof m.SetVariable!=d&&(f.success=!0,f.ref=m),e(f)}}}}function H(){var a=l.getElementsByTagName("body")[0],b=T(e);b.setAttribute("type",h);var c=a.appendChild(b);if(c){var f=0;(function(){if(typeof c.GetVariable!=d){var e=c.GetVariable("$version");e&&(e=e.split(" ")[1].split(","),B.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)])}else if(f<10){f++,setTimeout(arguments.callee,10);return}a.removeChild(b),c=null,I()})()}else I()}function G(){n?H():I()}function F(a){if(typeof k.addEventListener!=d)k.addEventListener("load",a,!1);else if(typeof l.addEventListener!=d)l.addEventListener("load",a,!1);else if(typeof k.attachEvent!=d)U(k,"onload",a);else if(typeof k.onload=="function"){var b=k.onload;k.onload=function(){b(),a()}}else k.onload=a}function E(a){w?a():o[o.length]=a}function D(){if(!w){try{var a=l.getElementsByTagName("body")[0].appendChild(T("span"));a.parentNode.removeChild(a)}catch(b){return}w=!0;var c=o.length;for(var d=0;d<c;d++)o[d]()}}var d="undefined",e="object",f="Shockwave Flash",g="ShockwaveFlash.ShockwaveFlash",h="application/x-shockwave-flash",i="SWFObjectExprInst",j="onreadystatechange",k=window,l=document,m=navigator,n=!1,o=[G],p=[],q=[],r=[],s,t,u,v,w=!1,x=!1,y,z,A=!0,B=function(){var a=typeof l.getElementById!=d&&typeof l.getElementsByTagName!=d&&typeof l.createElement!=d,b=m.userAgent.toLowerCase(),c=m.platform.toLowerCase(),i=c?/win/.test(c):/win/.test(b),j=c?/mac/.test(c):/mac/.test(b),o=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,p=!1,q=[0,0,0],r=null;if(typeof m.plugins!=d&&typeof m.plugins[f]==e)r=m.plugins[f].description,r&&(typeof m.mimeTypes==d||!m.mimeTypes[h]||!!m.mimeTypes[h].enabledPlugin)&&(n=!0,p=!1,r=r.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),q[0]=parseInt(r.replace(/^(.*)\..*$/,"$1"),10),q[1]=parseInt(r.replace(/^.*\.(.*)\s.*$/,"$1"),10),q[2]=/[a-zA-Z]/.test(r)?parseInt(r.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof k.ActiveXObject!=d)try{var s=new ActiveXObject(g);s&&(r=s.GetVariable("$version"),r&&(p=!0,r=r.split(" ")[1].split(","),q=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)]))}catch(t){}return{w3:a,pv:q,wk:o,ie:p,win:i,mac:j}}(),C=function(){!B.w3||((typeof l.readyState!=d&&l.readyState=="complete"||typeof l.readyState==d&&(l.getElementsByTagName("body")[0]||l.body))&&D(),w||(typeof l.addEventListener!=d&&l.addEventListener("DOMContentLoaded",D,!1),B.ie&&B.win&&(l.attachEvent(j,function(){l.readyState=="complete"&&(l.detachEvent(j,arguments.callee),D())}),k==top&&function(){if(!w){try{l.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}D()}}()),B.wk&&function(){if(!w){if(!/loaded|complete/.test(l.readyState)){setTimeout(arguments.callee,0);return}D()}}(),F(D)))}(),Z=function(){B.ie&&B.win&&window.attachEvent("onunload",function(){var a=r.length;for(var b=0;b<a;b++)r[b][0].detachEvent(r[b][1],r[b][2]);var c=q.length;for(var d=0;d<c;d++)Q(q[d]);for(var e in B)B[e]=null;B=null;for(var f in $)$[f]=null;$=null})}(),$={registerObject:function(a,b,c,d){if(B.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,p[p.length]=e,X(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){if(B.w3)return J(a)},embedSWF:function(a,b,c,f,g,h,i,j,k,l){var m={success:!1,id:b};B.w3&&!(B.wk&&B.wk<312)&&a&&b&&c&&f&&g?(X(b,!1),E(function(){c+="",f+="";var n={};if(k&&typeof k===e)for(var o in k)n[o]=k[o];n.data=a,n.width=c,n.height=f;var p={};if(j&&typeof j===e)for(var q in j)p[q]=j[q];if(i&&typeof i===e)for(var r in i)typeof p.flashvars!=d?p.flashvars+="&"+r+"="+i[r]:p.flashvars=r+"="+i[r];if(V(g)){var s=O(n,p,b);n.id==b&&X(b,!0),m.success=!0,m.ref=s}else{if(h&&K()){n.data=h,L(n,p,b,l);return}X(b,!0)}l&&l(m)})):l&&l(m)},switchOffAutoHideShow:function(){A=!1},ua:B,getFlashPlayerVersion:function(){return{major:B.pv[0],minor:B.pv[1],release:B.pv[2]}},hasFlashPlayerVersion:V,createSWF:function(a,b,c){return B.w3?O(a,b,c):undefined},showExpressInstall:function(a,b,c,d){B.w3&&K()&&L(a,b,c,d)},removeSWF:function(a){B.w3&&Q(a)},createCSS:function(a,b,c,d){B.w3&&W(a,b,c,d)},addDomLoadEvent:E,addLoadEvent:F,getQueryParamValue:function(a){var b=l.location.search||l.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(a==null)return Y(b);var c=b.split("&");for(var d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return Y(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(x){var a=S(i);a&&s&&(a.parentNode.replaceChild(s,a),t&&(X(t,!0),B.ie&&B.win&&(s.style.display="block")),u&&u(v)),x=!1}}};return $});define("task/user/setUserAccount",function(a,b,c){var d=a("lib/jquery"),e=a("task/basic/Task"),f=a("model/UserAccount");(new e("setUserAccount",function(){var a=d("#data_userAccount");if(a.size()){var b=new f(d.parseJSON(a.html()));a.remove()}})).add()});define("model/UserAccount",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=a("model/UserData"),g={},h={},i=e.extend({init:function(a){this.userId=i.update(a)},get:function(){return g[this.userId]}}),j=["totalBalance","donatedBalance"];i.update=function(a){var b=!1,c=a.userId,e=g[c];if(e!==undefined)for(var f=0,h=j.length;f<h;f++){var k=j[f];if(k in a&&k in e&&a[k]!==e[k]){b=!0;break}}g[c]=d.extend(!0,e,a),b&&i.publishUpdate(c);return c},i.get=function(a){return g[a]},i.bindUpdate=function(a,b){var c=h[a]||[];c.push(b),h[a]=c},i.publishUpdate=function(a){var b=h[a];if(b!==undefined)for(var c=0,d=b.length;c<d;c++)b[c](i.get(a))};return i});define("task/widget/error",function(a,b,c){"use strict";var d=a("task/basic/Task");(new d("ErrorManager",function(){var b=a("utils/error/ErrorManager");b.bindEvent()})).add()});define("utils/error/ErrorManager",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/box/floatBox/LoginBox"),f=a("widget/box/floatBox/PayLoginBox"),g=a("model/UserData"),h=a("widget/box/floatBox/SpamVerifyBox"),i=a("module/message/MessageAction"),j=a("widget/box/floatBox/ConfirmBox"),k=d(document.body),l={networkErrorCount:0,loginBox:null,bindEvent:function(){k.bind("error",d.proxy(this.handleError,this))},handleError:function(a,b,c){if(b==="needLogin"){if(this.loginBox===null){var d=null;g.passport&&g.passport!==""&&(d={isLoginedUrs:!0,loginPassport:g.passport,loginType:g.loginType}),this.loginBox=new e(null,{data:d||{}})}this.loginBox.show()}else if(b==="spamVerify"){var k=new h(null,{jqXHR:c});k.show()}else if(b==="spamBlocked"){var l=new j(null,{title:"\u5e10\u53f7\u5f02\u5e38\u63d0\u793a",data:{type:"warning",content:"\u60a8\u7684\u64cd\u4f5c\u8fc7\u4e8e\u9891\u7e41\u4e86\uff0c\u5e10\u53f7\u6682\u65f6\u88ab\u5c01\u7981\uff0c\u8bf7\u8054\u7cfb\u5c0f\u7ea2\u5a18\u89e3\u7981",submitBtnText:"\u79c1\u4fe1\u5c0f\u7ea2\u5a18",isHideCancel:!0},callBack:function(a,b){a.status==="ok"?i.doMessageToAdmin(b):b&&(location.href="/")}});l.show()}else if(b==="spamNotice"){var m=c,l=new j(null,{title:"\u9891\u7e41\u64cd\u4f5c\u63d0\u793a",data:{type:"warning",content:'\u64cd\u4f5c\u8fc7\u4e8e\u9891\u7e41\uff0c\u8bf7\u7b49\u5f85<b class="text-red">10</b>\u79d2\u540e\u518d\u6b21\u63d0\u4ea4',isHideCancel:!0},callBack:function(a,b){a.status==="ok"&&m&&m()}});l.show()}else if(b==="payLoginAgain"){var d={isDisableCookieUserName:!0,isLoginedUrs:!1,loginPassport:c.session.sess_type===1?c.session.sess_email:"",loginType:c.session.sess_type};d.loginPassport!==""&&(d.isUserNameDisable=!0);var n=new f(null,{data:d||{}});n.show(c.callback)}}};return l});define("widget/box/floatBox/LoginBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/box/floatBox/Box"),f=a("utils/tmpl"),g=a("utils/Utils"),h=a("utils/Cookie"),i=a("utils/suggest/EmailSuggest"),j=a("utils/Log"),k=h.get("email")||"",l=e.extend({defaults:{isLoginedUrs:!1,loginPassport:"",loginType:"",isDisableCookieUserName:!1},init:function(a,b){this._super(a,b),this.config.data=d.extend({},this.defaults,b.data),this.data=this.config.data||{}},preRender:function(){return{title:this.config.title||"\u767b\u5f55\u82b1\u7530",bodyContent:f.formatTemplate(a("template/floatbox/loginBox"),d.extend({},this.data))}},postRender:function(){this._super(),this.$elem.addClass("poplayer-login"),this.$username=this.$elem.find(".js-username"),this.$password=this.$elem.find(".js-password"),this.$usernameLabel=this.$elem.find(".js-usernameLabel"),this.$passwordLabel=this.$elem.find(".js-passwordLabel"),this.$tips=this.$elem.find(".js-tips"),this.initModules()},initModules:function(){new i(this.$username,{title:"\u8bf7\u9009\u62e9\u6216\u7ee7\u7eed\u8f93\u5165...",className:"email-suggest"}),!this.data.isDisableCookieUserName&&k&&this.$username.val()===""&&this.$username.val(k),this.checkUserNameEmpty(),this.checkPasswordEmpty()},checkUserNameEmpty:function(a){this.$username.val()===""&&this.$usernameLabel.removeClass("hidden")},checkPasswordEmpty:function(a){this.$password.val()===""&&this.$passwordLabel.removeClass("hidden")},bindEvent:function(){this._super();var a=this;this.$usernameLabel.bind("click",function(b){a.$usernameLabel.addClass("hidden"),a.$username.focus()}),this.$passwordLabel.bind("click",function(b){a.$passwordLabel.addClass("hidden"),a.$password.focus()}),this.$username.bind("focus",function(b){a.$usernameLabel.addClass("hidden")}),this.$password.bind("focus",function(b){a.$passwordLabel.addClass("hidden")}),this.$username.bind("blur email:complete",d.proxy(this.checkUsername,this)),this.$password.bind("blur",d.proxy(this.checkPassword,this)),this.$elem.delegate(".","click",submit-triggerd.proxy(this.onConfirm,this)),this.$elem.bind("keyup",function(b){b&&b.keyCode&&b.keyCode===13&&(d.trim(a.$password.val())===""?a.$password.focus():a.onConfirm(b))})},show:function(){this._super(),this.reset()},hide:function(a){this._super(),a&&this.config.callBack&&this.config.callBack({status:"cancel"})},onConfirm:function(a){if(!!this.preCheck()){this.config.callBack&&this.config.callBack({status:"ok"}),a&&j.doLog({parameter:{method:"login"},elem:d(a.target)}),this.$elem.find("form").submit();return!1}},checkUsername:function(){this.checkUserNameEmpty();var a=this.$username.val();if(a===""){g.textTips(this.$tips,"error","\u901a\u884c\u8bc1\u4e0d\u80fd\u4e3a\u7a7a");return!1}if(!a.match(g.EMAIL_REG)&&!a.match(g.MOBILE_REG)){g.textTips(this.$tips,"error","\u901a\u884c\u8bc1\u683c\u5f0f\u9519\u8bef");return!1}g.textTips(this.$tips,"hide","");return!0},checkPassword:function(){this.checkPasswordEmpty();var a=this.$password.val();if(a===""){g.textTips(this.$tips,"error","\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a");return!1}g.textTips(this.$tips,"hide","");return!0},reset:function(){g.textTips(this.$tips,"hide",""),this.data.isDisableCookieUserName||this.$username.val(k),this.$password.val(""),this.$passwordLabel.removeClass("hidden")},preCheck:function(){return this.checkUsername()&&this.checkPassword()}});return l});define("widget/box/floatBox/Box",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("utils/tmpl"),f=a("widget/box/Box"),g=a("utils/Utils"),h=a("utils/layer/MaskLayer"),i=d(window),j=d(document.body),k=f.extend({preRender:function(){return{}},renderTmpl:function(b){return d(e.formatTemplate(a("template/floatbox/basic"),b))},postRender:function(){this.$mainElem=this.$elem.find(".js-main")},show:function(){this._super(),this.$elem.css({visibility:"visible"});var a={};this.config.maskzIndex&&(a.zIndex=this.config.maskzIndex),this.maskLayer=new h,this.maskLayer.show(a),this.bindResize(),this.setPosition()},setPosition:function(){this.onVerticalMiddle(),this.onCenter()},bindResize:function(){i.bind("resize",d.proxy(this.resizeHandler,this)),this.config.escDisable||j.bind("keydown",d.proxy(this.hideHandler,this))},unbindResize:function(){i.unbind("resize",d.proxy(this.resizeHandler,this)),this.config.escDisable||j.unbind("keydown",d.proxy(this.hideHandler,this))},resizeHandler:function(){this.setPosition()},hideHandler:function(a){a.which===27&&this.hide()},hide:function(){this._super(),this.maskLayer&&this.maskLayer.hide(),this.unbindResize()},delayHide:function(a){a=a||2e3;var b=this;setTimeout(function(){b.hide()},a)}});return k});typeof process!="undefined"&&(process.title==="node"||process.title==="grunt")&&(define=function(a){exports.formatTemplate=a().formatTemplate,exports.replaceString=a().replaceString}),define("utils/tmpl",function(a,b,c){function n(a,b){b=b||{};if(typeof a=="function")return a(b);return m(a,b)}function m(a,b){var c="",e=/^[a-zA-Z0-9\/]+?$/.test(a)?d[a]=d[a]||m(document.getElementById("tmpl_"+a).innerHTML):new Function("tmplData","tmpl",l(a));if(b)try{return e(b,n)}catch(f){typeof console!==undefined&&console.error&&console.error("error in templates ",a,":",f,f.stack)}return e}function l(a){return"var p=[];with(tmplData){p.push('"+a.replace(f,"").replace(g,"").replace(e," ").replace(h,">$1<").split("<%").join("\t").replace(i,"$1\r").replace(j,"',$1,'").split("\t").join("');\n").split("%>").join("\np.push('").split("\r").join("\\'")+"');}return p.join('');"}function k(){var a={};for(var b=0;b<arguments.length;b++){var c=arguments[b];if(c&&typeof c=="object")for(var d in c)c[d]!==undefined&&c.hasOwnProperty(d)&&(a[d]=c[d])}return a}var d={},e=/[\r\t\n]/g,f=/^\s+/,g=/\s+$/,h=/>\s*(.*?)\s*</g,i=/((^|%>)[^\t]*)'/g,j=/\t=(.*?)%>/g;return{formatTemplate:n,replaceString:l}});define("widget/box/Box",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/Utils"),g=d(window),h=e.extend({init:function(a,b){this.$elem=null,this.config=b||{},this.data=this.config.data||{},this.isShow=!1,this.isBindEvent=!1},render:function(){if(this.$elem===null){var a=this.preRender(),b=d.extend({},a,this.data);this.$elem=this.renderTmpl(b)}this.isBindEvent||(this.postRender(),this.bindEvent(),this.isBindEvent=!0);return this.$elem},preRender:function(){return{}},postRender:function(){},renderTmpl:function(){throw new Error("abstract function!")},bindEvent:function(){this.$elem.delegate(".close-trigger","click",d.proxy(this.hide,this))},show:function(){this.render().appendTo("body").show(),this.isShow=!0},hide:function(){this.$elem!==null&&this.$elem.detach(),this.isShow=!1},setPosition:function(){},onTextTips:function(a,b,c){f.textTips(a,b,c)},onVerticalMiddle:function(a){var b=f.isIe6?g.scrollTop():0,c=(g.height()-this.$mainElem.height())/2;c=Math.max(c,0)+b,a?this.$mainElem.stop().animate({top:c,duration:500,easing:"easeInOutExpo"}):this.$mainElem.css({top:c})},onCenter:function(){var a=g.width()/2-this.$mainElem.width()/2;a=Math.max(a,0),this.$mainElem.css({left:a})}});return h});define("utils/layer/MaskLayer",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("basic/Class"),f=a("widget/Module"),g=a("utils/Utils"),h=d(window),i=f.extend({defaults:{zIndex:999},renderTmpl:function(){return d('<div class="masklayer"></div>')},postRender:function(){g.isIe6&&(this.$iframe=d('<iframe class="masklayer-iframe" scrolling="no" frameborder="0"></iframe>'))},show:function(a){this.render(),this.config=d.extend({},this.defaults,a),this.$elem.css("zIndex",this.config.zIndex).appendTo("body"),g.isIe6&&(this.$elem.css("position","absolute"),this.$iframe.css("zIndex",this.config.zIndex-1).appendTo("body")),this.resizeHandler(),this.bindResize()},hide:function(){this.$elem!==null&&this.$elem.detach(),this.$iframe&&this.$iframe.detach(),this.unbindResize()},bindResize:function(){this.bindResizeEvent=d.proxy(this.resizeHandler,this),h.bind("resize",this.bindResizeEvent),g.isIe6&&(this.bindScrollEvent=d.proxy(this.resizeHandler,this),h.bind("scroll",this.bindScrollEvent))},unbindResize:function(){h.unbind("resize",this.bindResizeEvent),g.isIe6&&h.unbind("scroll",this.bindScrollEvent)},resizeHandler:function(){var a=h.width(),b=h.height(),c=g.pageMaxHeight();this.$elem.css({width:a}),g.isIe6?(this.$elem.css({height:c,position:"absolute"}),this.$iframe.css({height:c,width:a})):this.$elem.css({height:b})}});return i});define("widget/Module",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("basic/Class"),f=e.extend({defaults:{},init:function(a,b){typeof a!="string"&&(this.$elem=a),this.config=d.extend({},this.defaults,b),this.data=this.config.data,this.isBindEvent=!1},render:function(){if(!this.$elem){var a=this.preRender(),b=d.extend(a,this.data);this.$elem=this.renderTmpl(b)}this.isBindEvent||(this.postRender(),this.bindEvent(),this.isBindEvent=!0);return this.$elem},preRender:function(){return{}},postRender:function(){},renderTmpl:function(a){throw"Abstract Method!!!"},parseData:function(a){return a},bindEvent:function(){this.isBindEvent=!0}});return f});define("template/floatbox/basic",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="poplayer"><div class="poplayer-main js-main"><div class="poplayer-hd js-hd"><a class="icon-close close-trigger" title="\u5173\u95ed" href="javascript:;"></a><h3 class="js-title">',title,"</h3>"),typeof subtitle!="undefined"&&subtitle&&p.push('<span class="text-md poplayer-subtitle">',subtitle,"</span>"),p.push('</div><div class="js-body">',bodyContent,"</div></div></div>");return p.join("")}});define("utils/Cookie",function(a,b,c){var d=a("lib/jquery"),e={set:function(a,b,c){var d="";if(c){var e=0,f=new Date;c==="today"&&(c=1,e=f.getHours()*3600+f.getMinutes()*60+f.getSeconds()),f.setTime(f.getTime()+c*24*60*60*1e3-e*1e3),d="; expires="+f.toGMTString()}document.cookie=a+"="+b+d+"; path=/"},get:function(a){var b=a+"=",c=document.cookie.split(";");for(var d=0;d<c.length;d++){var e=c[d];while(e.charAt(0)===" ")e=e.substring(1,e.length);if(e.indexOf(b)===0)return decodeURIComponent(e.substring(b.length,e.length))}return null},del:function(a){this.set(a,"",-1)}};return e});define("utils/suggest/EmailSuggest",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/Utils"),g=d(window),h=e.extend({init:function(a,b){this.$inputElem=a,this.$elem=null,this.config=b||{},this.$userNameLabel=this.$inputElem.parent().find(".js-usernameLabel"),this.isShow=!1,this.bindEvent()},bindEvent:function(){this.$inputElem.bind("paste cut input keydown",d.proxy(this.input,this)),this.$inputElem.bind("focus",d.proxy(this.onFocus,this)),this.$inputElem.bind("blur",d.proxy(function(){var a=this;this.blurTimer=setTimeout(function(){a.onBlur()},100)},this))},render:function(){if(this.$elem===null){var a=this.config.title?"<h3>"+this.config.title+"</h3>":"";this.$elem=d("<div>"+a+'<ul class="js-list"></ul></div>'),this.postRender()}return this.$elem},postRender:function(){var a=this;this.$elem.addClass(this.config.className),this.$listElem=this.$elem.find(".js-list"),this.$listElem.delegate("li","mouseover",function(b){var c=d(b.currentTarget),e=c.data("index");a.currentItem(e)}),this.$listElem.delegate("li","click",function(b){a.blurTimer&&clearTimeout(a.blurTimer),a.onSubmit()})},input:function(a){var b=a.which||a.keyCode;if(b===38||b===40||b===13||b===27||b===9)switch(b){case 38:a.preventDefault(),this.curPrevItem();break;case 40:a.preventDefault(),this.curNextItem();break;case 13:this.onSubmit();break;case 27:a.preventDefault(),this.hide();break;case 9:this.onSubmit();break;default:}else{var c=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){c.onInput(a)},30)}},onFocus:function(){var a=d.trim(this.$inputElem.val()),b=this.getInputValHash(a);d.inArray(b.suffix,h.mailArray)===-1&&this.$inputElem.trigger("keydown")},onBlur:function(){var a=this.getInputValHash(),b=this.inMailArrayIndex(a.suffix);this.$listElem&&this.$userNameLabel.is(":hidden")&&(a.suffix===""||b!==-1)&&this.onSubmit(),this.hide()},onInput:function(a){this.render();var b=f.encodeSpecialHtmlChar(d.trim(this.$inputElem.val()));if(b==="")this.hide();else{var c=this.getInputValHash();this.filterList(b,c.suffix);if(this.mailArray.length===0){this.hide();return}this.$listElem.html(this.renderList(c.key)),this.isShow||this.show(),this.currentItem(0)}},getInputValHash:function(){var a=f.encodeSpecialHtmlChar(d.trim(this.$inputElem.val())),b=a.indexOf("@"),c="",e="";b!==-1?(c=a.substring(0,b),e=a.substr(b+1,a.length)):c=a;return{key:c,suffix:e}},filterList:function(a,b){this.mailArray=[];if(!b)this.mailArray=d.merge(this.mailArray,h.mailArray),/^[0-9]*$/.test(a)&&this.mailArray.unshift("");else for(var c=0,e=h.mailArray.length;c<e;c++)h.mailArray[c].indexOf(b)===0&&this.mailArray.push(h.mailArray[c])},inMailArrayIndex:function(a){var b=-1;for(var c=0,d=h.mailArray.length;c<d;c++)if(h.mailArray[c].indexOf(a)===0){b=c;break}return b},renderList:function(a){var b=[],c=0;for(c,len=this.mailArray.length;c<len;c++)b.push('<li data-index="'+c+'"">'),b.push(a),this.mailArray[c]!==""&&b.push("@"),b.push(this.mailArray[c]),b.push("</li>");this.index=-1;return b.join("")},curPrevItem:function(){var a=this.index-1;a<0&&(a=this.mailArray.length-1),this.currentItem(a)},curNextItem:function(){var a=this.index+1;a>this.mailArray.length-1&&(a=0),this.currentItem(a)},currentItem:function(a){this.index=a,this.$listElem.find("> li").removeClass("current").eq(a).addClass("current")},setInputVal:function(){this.$listElem&&this.index!==-1&&this.$inputElem.val(this.$listElem.find("> li").eq(this.index).html()).trigger("email:complete")},onSubmit:function(){this.setInputVal(),this.hide()},show:function(){this.isShow=!0,this.$elem.appendTo("body"),this.setPosition(),g.bind("resize",d.proxy(this.resizeHandler,this))},hide:function(){this.isShow=!1,this.$elem&&this.$elem.detach(),this.index=-1,g.unbind("resize",d.proxy(this.resizeHandler,this))},setPosition:function(){var a=this.$inputElem.parent().offset();this.$elem.css({left:a.left,top:a.top+this.$inputElem.height()+5})},resizeHandler:function(){this.isShow&&this.setPosition()}});h.mailArray=["163.com","126.com","yeah.net","qq.com","vip.163.com","vip.126.com","188.com","gmail.com","sina.com","hotmail.com"];return h});define("template/floatbox/loginBox",function(require){return function(tmplData){var p=[];with(tmplData){p.push('<div class="poplayer-bd">');if(isLoginedUrs){p.push('<div class="poplayer-login-passport">');if(loginType){p.push("");var loginSource={qq:"\u817e\u8bafQQ",weibo:"\u65b0\u6d6a\u5fae\u535a"};p.push("<p>\u6b22\u8fce\u901a\u8fc7",loginSource[loginType],"\u767b\u5f55\u7f51\u6613\u82b1\u7530\uff0c\u60a8\u53ef\u4ee5\u65e0\u9700\u6ce8\u518c\u7f51\u6613\u901a\u884c\u8bc1\u76f4\u63a5\u5f00\u901a\u82b1\u7530</p>")}else p.push('<p>\u60a8\u7684\u5e10\u53f7\uff1a<span class="text-red">',loginPassport,"</span></p><p>\u5f53\u524d\u5df2\u767b\u5f55\u7f51\u6613\u901a\u884c\u8bc1\uff0c\u53ef\u4ee5\u76f4\u63a5\u5f00\u901a\u82b1\u7530</p>");p.push('<a class="btnM btn-red" href="/register">\u5feb\u901f\u5f00\u901a</a></div>')}else p.push('<form action="https://reg.163.com/logins.jsp" method="POST" id="loginForm" name="loginForm" target="_self"><ul class="poplayer-loginGroup"><li class="poplayer-login-tips"><span class="text-icon-tips js-tips hidden"></span></li><li class="form-row"><div class="form-input-wrapper"><label class="form-input-label text-gray js-usernameLabel hidden">\u7f51\u6613\u901a\u884c\u8bc1/\u624b\u673a\u53f7</label><input class="form-input js-username" name="username" type="text" autocomplete="off" '),typeof isUserNameDisable!="undefined"&&isUserNameDisable&&p.push('value="',loginPassport,'" disabled="disabled"'),p.push('disableautocomplete /></div></li><li class="form-row"><div class="form-input-wrapper"><label class="form-input-label text-gray js-passwordLabel hidden">\u5bc6\u7801</label><input class="form-input js-password" name="password" type="password" /></div></li><li class="form-row"><a class="forgot" href="http://reg.163.com/RecoverPasswd1.shtml" target="_blank" >\u5fd8\u8bb0\u5bc6\u7801\uff1f</a><div class="form-control"><input id="saveLogin" name="savelogin" class="form-checkbox" type="checkbox" value="1" checked="checked" /><label class="form-checkbox-label" for="saveLogin">\u4e0b\u6b21\u81ea\u52a8\u767b\u5f55</label></div></li><li class="form-btn"><input id="loginCallBack" type="hidden" name="url" value="',typeof callbackUrl!="undefined"?callbackUrl:location.href,'"><input type="hidden" value="ht" name="product"><input type="hidden" name="type" value="1"><a class="btnM btn-red submit-trigger" href="javascript:;" onclick="return false;">\u767b\u5f55</a></li></ul></form>');p.push('<div class="poplayer-login-other"><div class="poplayer-login-signup">'),isLoginedUrs?p.push('<p class="text-gray">\u5df2\u6709\u82b1\u7530\u5e10\u53f7\uff1f</p><a class="btn btn-gray" href="/logout">\u767b\u5f55</a>'):(p.push('<p class="text-gray">\u6ca1\u6709\u82b1\u7530\u5e10\u53f7\uff1f</p><a class="btn btn-gray" href="/'),typeof CONFIG!="undefined"&&typeof CONFIG.vendor!="undefined"&&CONFIG.vendor!==""&&p.push("?vendor=",CONFIG.vendor,""),p.push('">\u7acb\u5373\u6ce8\u518c</a>')),p.push("</div>");var baseURL="http://reg.163.com/outerLogin/oauth2/connect.do?target=$TARGET$&product=ht&url=$URL$&url2="+location.href;baseURL=typeof jointLoginCallback!="undefined"&&jointLoginCallback?baseURL.replace("$URL$",jointLoginCallback):baseURL.replace("$URL$",location.href);var weiboCallback="/logout?url="+encodeURIComponent(baseURL.replace("$TARGET$",3)),qqCallback="/logout?url="+encodeURIComponent(baseURL.replace("$TARGET$",1));p.push('<dl class="poplayer-login-joint"><dt class="text-gray">\u5176\u4ed6\u5e10\u53f7\u767b\u5f55</dt><dd><a class="poplayer-login-sina" href="',weiboCallback,'" title="\u4f7f\u7528\u65b0\u6d6a\u5fae\u535a\u5e10\u53f7\u767b\u9646"><em class="icon-sina"></em><span>\u65b0\u6d6a\u5fae\u535a</span></a></dd><dd><a class="poplayer-login-qq" href="',qqCallback,'" title="\u4f7f\u7528QQ\u5e10\u53f7\u767b\u9646"><em class="icon-qq"></em><span>QQ</span></a></dd></dl></div></div>')}return p.join("")}});define("widget/box/floatBox/PayLoginBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/box/floatBox/LoginBox"),f=a("utils/DataSource"),g=a("utils/Error"),h=a("utils/Log"),i=a("utils/tmpl"),j=a("utils/Utils"),k=e.extend({preRender:function(){return{title:"\u4e3a\u4e86\u786e\u4fdd\u652f\u4ed8\u5b89\u5168\uff0c\u8bf7\u767b\u5f55\u82b1\u7530\u9a8c\u8bc1",bodyContent:i.formatTemplate(a("template/floatbox/loginBox"),d.extend({},this.data))}},onConfirm:function(a){if(!(!this.preCheck()||d.isPlainObject(this.request)&&this.request.readyState!==4)){var b=this.parseParams(),c=this;this.request=f.ajax("payLogin",{async:!1,type:"post",data:b,success:function(a){a.result?(c.hide(),c.onSuccess()):j.textTips(c.$tips,"error","\u5bc6\u7801\u9519\u8bef")}}),h.doLog({parameter:{method:"login"},elem:d(a.currentTarget)});return!1}},parseParams:function(){var a={};a.password=d.trim(this.$password.val());return a},show:function(a){this._super(),this.successCallBack=a},onSuccess:function(){this.successCallBack&&this.successCallBack()}});return k});define("utils/DataSource",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("model/UserData"),f=a("utils/Error"),g=a("utils/data/RequestMap"),h=a("widget/box/floatBox/IntegrityTipsBox"),i=a("widget/box/floatBox/NeedVerifyBox"),j=a("widget/box/floatBox/NeedAvatarBox"),k=a("utils/Log"),l=d(document.body),m={keyFrom:null,triggerElem:null,requestMap:g,parseArguments:function(a){var b=a[0],c=this.requestMap[b];d.isPlainObject(c)&&(this.debug&&c.testUrl?a[0]=c.testUrl:a[0]=c.url);return a},parseRequest:function(a,b){var c={},f=b[0],g=this.requestMap[f],h=d.extend({},g);h.login=h.login||!1,h.silent=h.silent||!1,h.redirect=h.redirect||!1;if(d.isPlainObject(g)&&h.login&&e.getLoginUser()===null)l.trigger("error",["needLogin"]);else{b=m.parseArguments(b);try{c=a.apply(null,b)}catch(i){return c}c.resend=function(){b[0]=f,m.parseRequest(a,b)};var j=c.error;c.error=function(a){a&&j.call(c,function(b){b.status!==421&&a.apply(null,arguments)});return c};return h.silent?this.bindError(c,h):c}},get:function(){return this.parseRequest(d.get,arguments)},getJSON:function(){return this.parseRequest(d.getJSON,arguments)},ajax:function(){return this.parseRequest(d.ajax,arguments)},getScript:function(){return this.parseRequest(d.getScript,arguments)},post:function(){return this.parseRequest(d.post,arguments)},postJSON:function(){var a=arguments[0],b=arguments[arguments.length-1],c=d("#data_"+a);if(c.size()>0){b(d.parseJSON(c.html())),c.remove();return null}return this.parseRequest(d.post,arguments)},bindError:function(a,b){var c=this.triggerElem;this.triggerElem=null;return a.statusCode({521:d.proxy(function(){this.userNoLogin(b.login)},this),547:d.proxy(function(){this.needAvatar()},this),564:this.loginUserBlock,565:d.proxy(function(){this.targetUserBlock(c,b.redirect)},this),573:d.proxy(function(){this.targetUserBlacked(c)},this),576:d.proxy(function(){this.integrityError(c)},this),591:d.proxy(function(){this.aboardNeedVerify(c)},this),592:d.proxy(function(){this.needVerify()},this),426:d.proxy(function(){this.spamVerify(a)},this)})},throwNoFound:function(){},callError:function(a){var b=d.parseJSON(a.responseText),c=parseInt(b.code);!b.code||c===1},throwError:function(){l.trigger("error",["network",{type:"error",text:"\u7f51\u7edc\u592a\u5fd9\u5566\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u8fde\u63a5:)"}])},throwSysError:function(){l.trigger("error",["network",{type:"error",text:"\u670d\u52a1\u5668\u51fa\u73b0\u9519\u8bef\uff01"}])},setTrigger:function(a){this.triggerElem=a;return this},userNoLogin:function(a){a===!0&&(location.href="/")},loginUserBlock:function(){location.href="/error/block"},targetUserBlock:function(a,b){b?location.href="/404":a!==null&&(a.data("userblock")==="refresh"?location.reload():f.showWinTipsBox("warning",f.Code(565),null,a))},targetUserBlacked:function(a){a!==null&&f.showWinTipsBox("warning",f.Code(573),null,a)},integrityError:function(a){if(a!==null){var b="message";a.hasClass("mess-trigger")||(b="QA");var c=new h(null,{tipsType:b});c.show(),k.doLog({parameter:{method:"limit"},elem:a})}},aboardNeedVerify:function(a){a!==null&&f.showWinTipsBox("warning",f.Code(591),null,a)},needVerify:function(){var a=new i(null,{});a.show()},needAvatar:function(){var a=new j(null,{data:{content:"\u60a8\u9700\u8981\u5148\u6dfb\u52a0\u6e05\u6670\u7f8e\u89c2\u7684\u672c\u4eba\u8fd1\u7167\u624d\u80fd\u548c\u5bf9\u65b9\u4e92\u52a8\uff01"}});a.show()},spamVerify:function(a){l.trigger("error",["spamVerify",a])}};return m});define("utils/Error",function(a,b,c){var d=a("lib/jquery"),e=a("widget/box/winBox/TipsBox").getInstance(),f=a("widget/box/floatBox/TipsBox"),g={};g.Code=function(a){var b={425:["\u60a8\u8bc4\u8bba\u7684\u592a\u9891\u7e41",""],520:["\u670d\u52a1\u5668\u9519\u8bef",""],521:["\u60a8\u8fd8\u6ca1\u6709\u767b\u5f55",""],522:["\u6ca1\u6709\u627e\u5230\u8be5\u7528\u6237",""],523:["\u5b57\u7b26\u8d85\u957f",""],524:["\u56fe\u7247\u592a\u591a",""],525:["\u52a8\u6001\u4e2d\u6ca1\u6709\u56fe\u7247",""],526:["\u4e0a\u4f20\u56fe\u7247\u51fa\u9519",""],527:["\u771f\u5b9e\u59d3\u540d\u4e0e\u8eab\u4efd\u8bc1\u53f7\u4e0d\u5339\u914d",""],528:["\u7528\u6237\u4fe1\u606f\u4fee\u6539\u5931\u8d25",""],529:["\u4e0a\u4f20\u6570\u636e\u4e3a\u7a7a",""],530:["\u4e0a\u4f20\u6570\u636e\u8fc7\u5927",""],531:["\u4e0a\u4f20\u5931\u8d25",""],532:["\u5bc6\u7801\u88ab\u4fdd\u62a4",""],533:["\u66f4\u6362\u5bc6\u7801\u5931\u8d25",""],534:["\u60a8\u7684\u64cd\u4f5c\u592a\u9891\u7e41",""],535:["\u52a8\u6001\u88ab\u5220\u9664",""],540:["\u8bf7\u6c42\u53c2\u6570\u7684\u683c\u5f0f\u9519\u8bef",""],541:["\u8bf7\u6c42\u5fc5\u987b\u7684\u53c2\u6570\u9519\u8bef",""],542:["\u522b\u8d2a\u5fc3\u54e6\uff0c\u4f60\u5df2\u7ecf\u559c\u6b22\u5f88\u591a\u4eba\u4e86",""],543:["\u8be5\u52a8\u6001\u5df2\u88ab\u5220\u9664",""],544:["\u8be5\u7167\u7247\u5df2\u88ab\u5220\u9664",""],545:["\u8bf7\u52ff\u91cd\u590d\u8d5e",""],546:["\u7528\u6237\u6ca1\u6709\u6ce8\u518c",""],547:["\u60a8\u7684\u5934\u50cf\u8fd8\u6ca1\u6709\u5ba1\u6838\u901a\u8fc7\uff0c<br />\u8fd8\u4e0d\u80fd\u548c\u5176\u4ed6\u7528\u6237\u8fdb\u884c\u4e92\u52a8",""],548:["\u7528\u6237url\u751f\u6210\u5931\u8d25",""],550:["\u7528\u6237\u88ab\u62c9\u9ed1",""],551:["\u9a8c\u8bc1\u7801\u9519\u8bef",""],552:["\u60a8\u586b\u5199\u7684\u6027\u522b\u4e0e\u8eab\u4efd\u8bc1\u4fe1\u606f\u4e0d\u5339\u914d",""],553:["\u5bf9\u4e0d\u8d77\uff0c\u8be5\u4f01\u4e1a\u90ae\u7bb1\u5df2\u7ecf\u7533\u8bf7\u8fc7\u9080\u8bf7\u7801\uff01",""],554:["\u5bf9\u4e0d\u8d77\uff0c\u6682\u53ea\u5bf9\u90e8\u5206\u4f01\u4e1a\u53d1\u9001\u9080\u8bf7\u7801\u3002",""],555:["\u9080\u8bf7\u7801\u5df2\u88ab\u4f7f\u7528",""],556:["\u5bf9\u4e0d\u8d77\uff0c\u60a8\u8f93\u5165\u7684\u90ae\u7bb1\u9519\u8bef\uff0c\u6216\u6682\u4e0d\u5728\u5185\u6d4b\u4f01\u4e1a\u540d\u5355\u4e2d\uff0c\u8bf7\u671f\u5f85\u5f00\u653e\u6ce8\u518c\u518d\u8bd5",""],557:["\u8bf7\u8f93\u5165\u9080\u8bf7\u7801",""],558:["\u7528\u6237\u8f93\u5165\u4e0d\u7b26\u5408\u8981\u6c42",""],559:["\u8be5\u6635\u79f0\u4e0d\u53ef\u7528",""],560:["\u56fe\u7247\u5730\u5740\u975e\u6cd5",""],561:["\u9a8c\u8bc1\u7801\u9519\u8bef",""],562:["\u4e0d\u80fd\u8d5e\u81ea\u5df1",""],563:["\u60a8\u9a8c\u8bc1\u6b21\u6570\u592a\u8fc7\u9891\u7e41\uff0c\u8bf7\u4f7f\u7528\u624b\u673a\u8ba4\u8bc1\u5427",""],564:["\u60a8\u5df2\u88ab\u5c01\u7981",""],565:["\u8be5\u7528\u6237\u5df2\u88ab\u5c01\u7981\uff0c\u65e0\u6cd5\u4e92\u52a8",""],566:["\u62b1\u6b49\uff0c\u5185\u5bb9\u8fdd\u53cd\u76f8\u5173\u6cd5\u5f8b\u6cd5\u89c4\uff0c\u8bf7\u4fee\u6539",""],567:["\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u4f7f\u7528\u624b\u673a\u8ba4\u8bc1\u6216\u8fc7\u4f1a\u91cd\u8bd5",""],568:["\u8be5\u8eab\u4efd\u8bc1\u53f7\u5df2\u5728\u82b1\u7530\u8ba4\u8bc1\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165",""],569:["\u8be5\u624b\u673a\u53f7\u5df2\u5728\u82b1\u7530\u8ba4\u8bc1\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165",""],570:["\u6ca1\u6709\u8fdb\u884c\u8eab\u4efd\u8ba4\u8bc1\uff0c\u65e0\u6cd5\u4e92\u52a8",""],571:["\u60c5\u4e66\u6ca1\u6709\u6587\u5b57",""],573:["\u4f60\u5df2\u88ab\u5bf9\u65b9\u62c9\u9ed1\uff0c\u65e0\u6cd5\u4e92\u52a8",""],574:["\u8be5\u529f\u80fd\u5df2\u8fbe\u4f7f\u7528\u4e0a\u9650",""],576:["\u771f\u53ef\u60dc\uff0c\u4f60\u7684\u8d44\u6599\u5b8c\u6574\u5ea6\u8fd8\u6ca1\u6709\u8fbe\u523030%\uff0c\u6682\u65f6\u4e0d\u80fd\u548c\u7f8e\u5973\u4ea4\u6d41",""],579:["\u56de\u7b54\u65f6\u95f4\u95f4\u9694\u592a\u77ed",""],581:["\u4eca\u65e5\u8df3\u8fc7\u9898\u6570\u8fbe\u5230\u4e0a\u9650",""],582:["\u4e0d\u80fd\u91cd\u590d\u6253\u62db\u547c",""],583:["\u62b1\u6b49\uff0c\u53d1\u9001\u5185\u5bb9\u4e2d\u5305\u542b\u654f\u611f\u5185\u5bb9\uff0c\u8bf7\u68c0\u67e5\u540e\u91cd\u65b0\u53d1\u9001\u3002",""],584:["\u62b1\u6b49\uff0c\u53d1\u9001\u5185\u5bb9\u4e2d\u5305\u542b\u654f\u611f\u5185\u5bb9\uff0c\u8bf7\u68c0\u67e5\u540e\u91cd\u65b0\u53d1\u9001\u3002",""],585:["\u6682\u65f6\u4e0d\u80fd\u8d2d\u4e70\u6536\u8d39\u670d\u52a1",""],586:["\u6d88\u8d39\u8ba2\u5355\u4e0d\u5b58\u5728",""],590:["\u8ba2\u5355\u6216\u652f\u4ed8\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8d2d\u4e70\u5e76\u652f\u4ed8",""],591:["\u60a8\u7684\u8ba4\u8bc1\u6b63\u5728\u5ba1\u6838\u4e2d\uff0c\u6682\u4e0d\u80fd\u4e92\u52a8\uff01",""],592:["\u4e3a\u4e86\u4fdd\u8bc1\u4ea4\u53cb\u5b89\u5168\u548c\u771f\u5b9e\u6027\uff0c\u8bf7\u5148\u5b8c\u6210\u624b\u673a\u53f7\u6216\u8eab\u4efd\u8bc1\u53f7\u8ba4\u8bc1",""],593:["\u751f\u6210\u8ba2\u5355ID\u5f02\u5e38",""],594:["\u7528\u6237\u6536\u8d39\u5e10\u53f7\u4e0d\u5b58\u5728",""],595:["\u6d3b\u52a8\u4e0d\u5b58\u5728",""],596:["\u60a8\u5df2\u8d2d\u4e70\u6b64\u670d\u52a1\uff0c\u53ef\u6c38\u4e45\u4f7f\u7528\uff0c\u4e0d\u9700\u8981\u518d\u6b21\u8d2d\u4e70",""],598:["\u4e3a\u4fdd\u8bc1\u5b89\u5168\u4ee5\u9632\u53d7\u9a97\uff0c\u8bf7\u52ff\u4f7f\u7528\u7ad9\u5916\u8054\u7cfb\u65b9\u5f0f\u6c9f\u901a",""],600:["\u6700\u591a\u53ef\u9009\u62e910\u4e2a\u6807\u7b7e\u5c55\u793a",""]};return b[a]&&b[a][0]?b[a][0]:""},g.showTips=function(a){var a=d.extend({json:{}},a),b=parseInt(a.json.code)||1;if(b===1)return!1;var c=b===599?a.json.apiErrorMessage:g.Code(b);c&&g.showWinTipsBox("warning",c,a.evt,a.triggerElem);return!0},g.Tips=function(a,b,c){var d=g.Code(a);if(a===1||d==="")return!1;b?g.showWinTipsBox("warning",d,b,c):g.showWinTipsBox("warning",d,null,c);return!0},g.showWinTipsBox=function(a,b,c,d){e.show(c,{data:{type:a,text:b},triggerElem:d})},g.showFloatTipsBox=function(a,b){var c=new f(null,{data:{type:a,text:b}});c.show(),c.delayHide(1500)};return g});define("widget/box/winBox/TipsBox",function(a,b,c){var d=a("lib/jquery"),e=a("widget/box/winBox/Box"),f=a("utils/tmpl"),g=e.extend({init:function(a,b){this._super(a,b)},renderTmpl:function(){return d(f.formatTemplate(a("template/winbox/tipsBox"),{}))},postRender:function(){this.$typeElem=this.$elem.find(".js-type"),this.$textElem=this.$elem.find(".js-text"),this.$arrowElem=this.$elem.find(".js-arrow")},show:function(a,b){this.timer&&clearTimeout(this.timer),this._super(a,b),this.$typeElem.removeClass("correct error warning").addClass(b.data.type),this.$textElem.html(b.data.text),this.setPosition();var c=this;this.timer=setTimeout(function(){c.hide()},2e3)},bindEvent:function(){this._super()},setPosition:function(){var a=this.$trigger,b=a.offset(),c=this.$elem.width();this.$elem.css({top:b.top-this.$elem.innerHeight()-10,left:b.left+a.innerWidth()/2-c/2}),this.$arrowElem.css({left:c/2-7})}}),h=null;return{getInstance:function(){h===null&&(h=new g);return h},getNewInstance:function(a,b){return new g(a,b)}}});define("widget/box/winBox/Box",function(a,b,c){var d=a("lib/jquery"),e=a("widget/box/Box"),f=a("utils/Utils"),g=d(window),h=d(document.body),i=e.extend({init:function(a,b){this._super(a,b),this.isBindAutoClose=!1},show:function(a,b){this._super(),this.config=b||{},this.data=this.config.data||{},this.config.triggerElem?this.$trigger=this.config.triggerElem:typeof a!="undefined"&&(this.$trigger=d(a.currentTarget)),this.hideCallBack=this.config.hideCallBack,!this.isBindAutoClose&&this.config.autoClose&&(this.autoClose=f.autoClose.call(this),this.isBindAutoClose=!0),this.config.bindResize&&this.bindResize(),this.setPosition();return this.$elem},hide:function(){this.reset(),this.hideCallBack&&this.hideCallBack(),this.config.autoClose&&(h.unbind("click",this.autoClose),this.isBindAutoClose=!1),this.config.bindResize&&g.unbind("resize",d.proxy(this.setPosition,this)),this._super()},bindResize:function(){g.bind("resize",d.proxy(this.setPosition,this))},reset:function(){}});return i});define("template/winbox/tipsBox",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="winlayer tipsBox"><em class="icon-winlayer-arrowDown js-arrow"></em><div class="tipsBox-inner js-inner"><span class="tipsBox-left js-type"><em class="icon-correct-m"></em><em class="icon-warning-m"></em><em class="icon-error-m"></em></span><p class="js-text"></p></div></div>');return p.join("")}});define("widget/box/floatBox/TipsBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("utils/tmpl"),f=a("widget/box/floatBox/Box"),g=f.extend({preRender:function(){return{title:"",bodyContent:e.formatTemplate(a("template/floatbox/tipsBox"),this.data)}},postRender:function(){this._super(),this.$elem.addClass("poplayer-tipsBox")}});return g});define("template/floatbox/tipsBox",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="poplayer-bd"><p class="text-middle-tips"><span class="fS14">'),type=="correct"?p.push('<em class="icon-correct-m"></em>'):type=="warning"?p.push('<em class="icon-warning-m"></em>'):type=="error"&&p.push('<em class="icon-error-m"></em>'),p.push("",text,"</span></p>"),typeof desc!="undefined"&&desc!==""&&p.push('<p class="poplayer-desc">',desc,"</p>"),p.push("</div>");return p.join("")}});define("widget/box/floatBox/IntegrityTipsBox",function(a,b,c){var d=a("lib/jquery"),e=a("widget/box/floatBox/Box"),f=a("utils/tmpl"),g=a("utils/Utils"),h=a("utils/Log"),i=a("model/UserData"),j=e.extend({init:function(a,b){this._super(a,b),this.data.tipsType=b.tipsType||!1,this.data.url=i.getLoginUser().url},preRender:function(){return{title:this.config.title||"\u8bf7\u5b8c\u5584\u8d44\u6599",bodyContent:f.formatTemplate(a("template/floatbox/integrityTipsBox"),this.data)}},postRender:function(){this._super(),this.$elem.addClass("poplayer-integrity")},bindEvent:function(){this._super(),this.$elem.delegate(".submit-trigger","click",d.proxy(this.onSubmit,this))},hide:function(a){this._super(),a&&this.config.callBack&&this.config.callBack({status:"cancel"})},onSubmit:function(a){this.hide()}});return j});define("template/floatbox/integrityTipsBox",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="poplayer-bd"><div class="poplayer-messbox"><div class="poplayer-mess"><em class="icon-integrity-heart"></em>'),tipsType==="QA"?p.push('\u771f\u53ef\u60dc\uff0c\u4f60\u7684\u8d44\u6599\u5b8c\u6574\u5ea6\u8fd8\u6ca1\u8fbe\u5230<strong class="text-red">30%</strong>\uff0c\u6682\u65f6\u8fd8\u4e0d\u80fd\u67e5\u770bTA\u7684Q&A\u3002'):p.push('\u771f\u53ef\u60dc\uff0c\u4f60\u7684\u8d44\u6599\u5b8c\u6574\u5ea6\u8fd8\u6ca1\u8fbe\u5230<strong class="text-red">30%</strong>\uff0c\u6682\u65f6\u4e0d\u80fd\u548cTA\u4ea4\u6d41\u3002'),p.push("</div>"),tipsType==="QA"?p.push('<div class="poplayer-desc"></div>'):p.push('<div class="poplayer-desc">\u5df2\u7ecf\u6709<strong>80%</strong>\u7684\u7528\u6237\u7545\u804a\u65e0\u963b\u3002</div>'),p.push('</div></div><div class="poplayer-ft"><div class="poplayer-btn n-btn-box"><div><a href="/',url,'?info=1" target="_blank" class="btn btn-red submit-trigger">\u5b8c\u5584\u8d44\u6599</a><a href="javascript:;" class="btn btn-gray close-trigger">\u53d6\u6d88</a></div></div></div>');return p.join("")}});define("widget/box/floatBox/NeedVerifyBox",function(a,b,c){var d=a("lib/jquery"),e=a("widget/box/floatBox/Box"),f=a("utils/tmpl"),g=a("utils/Utils"),h=a("utils/Log"),i=a("model/UserData"),j=e.extend({init:function(a,b){this._super(a,b)},preRender:function(){return{title:this.config.title||"\u9700\u8981\u5148\u5b8c\u6210\u8eab\u4efd\u8ba4\u8bc1",bodyContent:f.formatTemplate(a("template/floatbox/needVerify"),this.data)}},postRender:function(){this._super(),this.$elem.addClass("poplayer-needVerify")},bindEvent:function(){this._super(),this.$elem.delegate(".submit-trigger","click",d.proxy(this.onSubmit,this))},hide:function(a){this._super(),a&&this.config.callBack&&this.config.callBack({status:"cancel"})},onSubmit:function(a){this.hide()}});return j});define("template/floatbox/needVerify",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="poplayer-bd"><div class="poplayer-messbox"><span class="poplayer-mess"><em class="icon-warning-b"></em>\u4e3a\u4e86\u4fdd\u8bc1\u4ea4\u53cb\u5b89\u5168\u548c\u771f\u5b9e\u6027\uff0c\u8bf7\u5148\u5b8c\u6210\u624b\u673a\u53f7\u6216\u8eab\u4efd\u8bc1\u53f7\u8ba4\u8bc1</span></div><p class="poplayer-desc">\u82b1\u7530\u7528\u6237\u5747\u5df2\u5b8c\u6210\u8fc7\u8ba4\u8bc1</p></div><div class="poplayer-ft"><div class="poplayer-btn n-btn-box"><div><a href="/verified/mobile" target="_blank" class="btn btn-red ">\u53bb\u8ba4\u8bc1</a></div></div></div>');return p.join("")}});define("widget/box/floatBox/NeedAvatarBox",function(a,b,c){var d=a("lib/jquery"),e=a("widget/box/floatBox/Box"),f=a("utils/tmpl"),g=a("utils/Utils"),h=a("utils/Log"),i=a("model/UserData"),j=e.extend({init:function(a,b){this._super(a,b)},preRender:function(){return{title:this.config.title||"\u9700\u8981\u4e0a\u4f20\u771f\u5b9e\u5934\u50cf",bodyContent:f.formatTemplate(a("template/floatbox/needAvatar"),this.data)}},postRender:function(){this._super(),this.$elem.addClass("poplayer-needAvatar")},bindEvent:function(){this._super(),this.$elem.delegate(".submit-trigger","click",d.proxy(this.onSubmit,this))},hide:function(a){this._super(),a&&this.config.callBack&&this.config.callBack({status:"cancel"})},onSubmit:function(a){this.hide()}});return j});define("template/floatbox/needAvatar",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="poplayer-bd"><div class="poplayer-messbox"><span class="poplayer-mess"><em class="icon-warning-b"></em>',content,'</span></div></div><div class="poplayer-ft"><div class="poplayer-btn n-btn-box"><div><a href="/settings/face" target="_blank" class="btn btn-red ">\u53bb\u4e0a\u4f20\u5934\u50cf</a></div></div></div>');return p.join("")}});define("widget/box/floatBox/SpamVerifyBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/box/floatBox/Box"),f=a("utils/tmpl"),g=a("utils/Utils"),h=a("utils/Error"),i=a("utils/verify/ProfileVerify"),j=a("utils/DataSource"),k=e.extend({preRender:function(){return{title:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",bodyContent:f.formatTemplate(a("template/floatbox/spamVerifyBox"),{})}},postRender:function(){this._super(),this.$elem.addClass("poplayer-spamVerify"),this.$codeImg=this.$elem.find(".js-codeImg"),this.$verifyCode=this.$elem.find(".js-verifyCode"),this.$verifyCodeTips=this.$verifyCode.parents(".js-row").find(".js-tips"),this.verify=new i({verifyCode:this.$verifyCode.parents(".js-row")});var a=this;setTimeout(function(){a.$verifyCode.val("").focus()},100)},bindEvent:function(){this._super(),this.$elem.delegate(".codeRefresh-trigger","click",d.proxy(this.refreshCode,this)),this.$elem.delegate(".submit-trigger","click",d.proxy(this.onSubmit,this))},refreshCode:function(){g.textTips(this.$verifyCodeTips,"hide"),this.$codeImg.attr("src","/photo/verifyNew?type=1&rnd="+Math.random()*1e3),this.$verifyCode.val("").focus()},preCheck:function(){if(this.verify.checkAll())return!0;return!1},parseParams:function(){return{verifyCode:d.trim(this.$verifyCode.val())}},onSubmit:function(a){if(!(!this.preCheck()||d.isPlainObject(this.request)&&this.request.readyState!==4)){var b=this.parseParams(),c=this;this.request=j.postJSON("checkVerifyCode",b,function(b){var d=parseInt(b.code)||1;h.Tips(d,a)||c.onSuccess()})}},onSuccess:function(){this.hide(),this.config.jqXHR.resend()}});return k});define("utils/verify/ProfileVerify",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/Utils"),g=a("utils/verify/VerifyItem"),h=e.extend({methods:{},DEFAULT:{tipSelector:".js-tips",passClass:"pass",errorClass:"error",requiredClass:"required"},init:function(a,b){this.elems=a,this.config=d.extend({},this.DEFAULT,b);for(var c in this.elems){this["$"+c]=d(this.elems[c]);try{this.methods[c]=this[c+"Init"]()}catch(e){}}},nickNameInit:function(){var a={input:"input",regExp:new RegExp(f.NICKNAME_REG),ingoreEmpty:!1,minLength:3,maxLength:24,verifyType:"nickname",triggerEvents:["blur"],ignoreFullWidth:!1};typeof this.config.nickName.checkCallBack!="undefined"&&(a.checkCallBack=this.config.nickName.checkCallBack);return new g(this.$nickName,a)},realnameInit:function(){return new g(this.$realname,{input:"input",regExp:new RegExp(f.REALNAME_REG),ingoreEmpty:!1,minLength:2,maxLength:24,verifyType:"realname",triggerEvents:["blur"],ignoreFullWidth:!1})},mobileInit:function(){return new g(this.$mobile,{regExp:new RegExp(f.MOBILE_REG),verifyType:"mobile",ingoreEmpty:!1,minLength:11,maxLength:11})},aboardMobileInit:function(){return new g(this.$aboardMobile,{regExp:new RegExp(f.MOBILE_REG),verifyType:"mobile",ingoreEmpty:!1,minLength:11,maxLength:11})},microblogInit:function(){return new g(this.$microblog,{regExp:new RegExp(/^(http)s?:\/\/[\w\-\.]+[\/\w=_\-]*$/i),ingoreEmpty:!0,verifyType:"microblog",maxLength:45})},doubanInit:function(){return new g(this.$douban,{regExp:new RegExp(/^(http)s?:\/\/[\w\-\.]+[\/\w=_\-\.]*$/i),ingoreEmpty:!0,verifyType:"douban",maxLength:45})},idCardInit:function(){return new g(this.$idCard,{regExp:new RegExp(f.IDCARD_REG),verifyType:"idcard",minLength:15,maxLength:18})},mobileCodeInit:function(){return new g(this.$mobileCode,{regExp:new RegExp(f.MOBILECODE_REG),verifyType:"mobileCode",ingoreEmpty:!1,minLength:4,maxLength:10})},schoolInit:function(){return new g(this.$school,{regExp:new RegExp(f.SCHOOL_REG),verifyType:"school",maxLength:60,ingoreEmpty:!0,enablePassIcon:!1})},companyInit:function(){return new g(this.$company,{regExp:new RegExp(f.COMPANY_REG),verifyType:"company",maxLength:50,ingoreEmpty:!0,enablePassIcon:!1})},weightInit:function(){return new g(this.$weight,{regExp:new RegExp(/^[0-9]{1,3}\.*[0-9]{0,}$/),verifyType:"weight",maxValue:400,minValue:25,ingoreEmpty:!0})},verifyCodeInit:function(){return new g(this.$verifyCode,{regExp:new RegExp(f.VERIFYCODE_REG),verifyType:"verifyCode",ingoreEmpty:!1,enablePassIcon:!1})},inviteCodeInit:function(){return new g(this.$inviteCode,{regExp:new RegExp(f.INVITECODE_REG),verifyType:"inviteCode",ingoreEmpty:!0})},checkAll:function(a){var b=a||!1,c=!0;for(var d in this.elems)if(this.methods[d].getResult(b)===!1){c=!1;break}return c}});return h});define("utils/verify/VerifyItem",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("utils/Utils"),f=a("basic/Class"),g=f.extend({init:function(a,b){this.$elem=a,this.$input=b.input?a.find(b.input):a.find(":input, select"),this.regExp=b.regExp||null,this.verifyType=b.verifyType,this.ingoreEmpty=b.ingoreEmpty||!1,this.maxValue=b.maxValue||!1,this.minValue=b.minValue||!1,this.maxLength=b.maxLength||!1,this.minLength=b.minLength||!1,this.triggerEvents=b.triggerEvents||["blur"],this.ignoreFullWidth=b.ignoreFullWidth||!1,this.checkCallBack=b.checkCallBack,this.enablePassIcon=typeof b.enablePassIcon!="undefined"?b.enablePassIcon:!0,this.$tips=b.$tips||this.$elem.find(".js-tips"),this.bindEvent()},parseResult:function(a){var b={"nickname.empty":"\u8bf7\u8f93\u5165\u6635\u79f0","nickname.long":"\u6635\u79f0\u592a\u957f","nickname.short":"\u6635\u79f0\u592a\u77ed","nickname.wrongFormat":"\u683c\u5f0f\u9519\u8bef","realname.empty":"\u8bf7\u8f93\u5165\u771f\u5b9e\u59d3\u540d","realname.long":"\u771f\u5b9e\u59d3\u540d\u592a\u957f","realname.short":"\u771f\u5b9e\u59d3\u540d\u592a\u77ed","realname.wrongFormat":"\u683c\u5f0f\u9519\u8bef","idcard.empty":"\u8bf7\u8f93\u5165\u8eab\u4efd\u8bc1\u53f7","idcard.long":"\u8eab\u4efd\u8bc1\u53f7\u4e0d\u6b63\u786e","idcard.short":"\u8eab\u4efd\u8bc1\u53f7\u4e0d\u6b63\u786e","idcard.wrongFormat":"\u8eab\u4efd\u8bc1\u53f7\u4e0d\u6b63\u786e","mobile.empty":"\u8bf7\u8f93\u5165\u624b\u673a\u53f7","mobile.long":"\u8f93\u5165\u7684\u624b\u673a\u53f7\u7801\u6709\u8bef","mobile.short":"\u8f93\u5165\u7684\u624b\u673a\u53f7\u7801\u6709\u8bef","mobile.wrongFormat":"\u8f93\u5165\u7684\u624b\u673a\u53f7\u7801\u6709\u8bef","mobileCode.empty":"\u8bf7\u8f93\u5165\u77ed\u4fe1\u4e2d\u7684\u9a8c\u8bc1\u7801","mobileCode.long":"\u9a8c\u8bc1\u7801\u9519\u8bef","mobileCode.short":"\u9a8c\u8bc1\u7801\u9519\u8bef","mobileCode.wrongFormat":"\u9a8c\u8bc1\u7801\u9519\u8bef","company.empty":"","company.long":"\u516c\u53f8\u540d\u79f0\u592a\u957f","company.short":"\u516c\u53f8\u540d\u79f0\u592a\u77ed","company.wrongFormat":"\u516c\u53f8\u540d\u79f0\u683c\u5f0f\u9519\u8bef","school.empty":"","school.long":"\u5b66\u6821\u540d\u79f0\u592a\u957f","school.wrongFormat":"\u5b66\u6821\u540d\u79f0\u683c\u5f0f\u9519\u8bef","weight.empty":"","weight.big":"\u6240\u586b\u4f53\u91cd\u4e0d\u5728\u6709\u6548\u8303\u56f4\u5185","weight.small":"\u6240\u586b\u4f53\u91cd\u4e0d\u5728\u6709\u6548\u8303\u56f4\u5185","weight.wrongFormat":"\u6240\u586b\u4f53\u91cd\u683c\u5f0f\u9519\u8bef","microblog.long":"\u5fae\u535a\u5730\u5740\u8fc7\u957f","microblog.short":"\u5fae\u535a\u5730\u5740\u8fc7\u77ed","microblog.wrongFormat":"\u5fae\u535a\u5730\u5740\u683c\u5f0f\u9519\u8bef","douban.long":"\u8c46\u74e3\u5730\u5740\u8fc7\u957f","douban.short":"\u8c46\u74e3\u5730\u5740\u8fc7\u77ed","douban.wrongFormat":"\u8c46\u74e3\u5730\u5740\u683c\u5f0f\u9519\u8bef","verifyCode.empty":"\u9a8c\u8bc1\u7801\u4e0d\u80fd\u4e3a\u7a7a","verifyCode.wrongFormat":"\u9a8c\u8bc1\u7801\u683c\u5f0f\u9519\u8bef","inviteCode.empty":"","inviteCode.wrongFormat":"\u9080\u8bf7\u7801\u683c\u5f0f\u9519\u8bef"};return b[a]},bindEvent:function(){var a=this;for(var b=0;b<this.triggerEvents.length;b++)this.$input.bind(this.triggerEvents[b],d.proxy(this.onEvent,this));this.$input.bind("focus",function(){e.textTips(a.$tips,"hide")})},onEvent:function(){var a=d.trim(this.$input.val()),b=this.checkInput(a);a===""&&this.ingoreEmpty?(e.textTips(this.$tips,"hide"),this.checkCallBack&&this.checkCallBack(this.$elem,b)):b==="ok"&&this.enablePassIcon?(e.textTips(this.$tips,"pass"),this.checkCallBack&&this.checkCallBack(this.$elem,b)):b==="ok"&&!this.enablePassIcon?(e.textTips(this.$tips,"hide"),this.checkCallBack&&this.checkCallBack(this.$elem,b)):e.textTips(this.$tips,"error",this.parseResult(this.verifyType+"."+b))},checkInput:function(a){var b=d.trim(a),c=this.ignoreFullWidth?b:b.replace(e.FULLWIDTH_REG,"**"),f=null;if(this.ingoreEmpty&&d.trim(b)==="")return"ok";if(this.ingoreEmpty===!1&&d.trim(b)==="")return"empty";if(this.maxLength&&c.length>this.maxLength)return"long";if(this.minLength&&c.length<this.minLength)return"short";if(this.maxValue&&parseInt(b)>this.maxValue)return"big";if(this.minValue&&parseInt(b)<this.minValue)return"small";if(this.regExp&&!this.regExp.test(b))return"wrongFormat";return"ok"},getResult:function(a){var b=this.$input.val(),c=this.checkInput(b);if(c==="ok")return!0;a||this.$input.blur();return!1}});return g});define("template/floatbox/spamVerifyBox",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="poplayer-bd"><p class="fS14" style="padding-bottom: 4px;">\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801</p><div class="form-row js-row"><div class="form-control"><input class="form-input code-input js-verifyCode" type="text"><img src="/photo/verifyNew?type=1" class="code-img js-codeImg"><a onclick="return false;" href="javascript:;" class="code-change link-lightBlue codeRefresh-trigger">\u6362\u4e00\u5f20</a></div><div class="form-tips"><span class="text-icon-tips js-tips hidden"></span></div></div></div><div class="poplayer-ft"><div class="poplayer-btn n-btn-box"><div class="js-btn"><a class="btn btn-red n-btn-sure submit-trigger" href="javascript:;">\u786e\u8ba4</a></div></div></div>');return p.join("")}});define("module/message/MessageAction",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("utils/DataSource"),f=a("widget/box/floatBox/MessageBox"),g=a("widget/box/floatBox/FeedbackBox"),h=a("utils/Error"),i=a("utils/Utils"),j=a("utils/Log"),k={doMessage:function(a,b){if(!d.isPlainObject(this.messRequest)||this.messRequest.readyState===4){var c=this,f=d(a.currentTarget);this.messRequest=e.setTrigger(f).postJSON("singleSession",{withUserId:b.data.user.id},function(d){var e=parseInt(d.code,10)||1;h.Tips(e,a)||k.showMessageLayer.call(c,b,d.session)}),j.doLog({parameter:{method:"msgclick"},elem:f})}},showMessageLayer:function(a,b){var c=a.data,d={target:this,isNotice:this.isNotice||!1,defaultTip:a.defaultTip||"",noMessTips:a.noMessTips||!1,tag:a.tag||"",data:{userId:c.user.id,nickName:c.user.nickName,sexName:i.userSexName(c.user.sex),relationData:c.relationData,totalCount:b.totalCount}},e=new f(null,d);e.show()},doMessageToAdmin:function(a){var b={noMessTips:!0,data:{user:{id:"1398972104992685069",nickName:"\u82b1\u7530\u5c0f\u7ea2\u5a18"}}};k.doMessage(a,b)},doFeedBackMessage:function(){var a={data:{userId:"1398972104992685069",nickName:"\u82b1\u7530\u5c0f\u7ea2\u5a18"}};k.showFeedbackBox.call(null,a),j.doLog({parameter:{method:"msgclick"},elem:"body"})},showFeedbackBox:function(a){var b=new g(null,a);b.show()}};return k});define("widget/box/floatBox/MessageBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/box/floatBox/Box"),f=a("sendbox/MessageSendBox"),g=a("widget/box/floatBox/TipsBox"),h=a("model/UserData"),i=a("utils/tmpl"),j=a("utils/Cookie"),k=a("utils/Utils"),l=d(window),m=d("body"),n=e.extend({preRender:function(){var b=d.extend({},this.data),c=h.getLoginUser();b.loginUser=c,b.defaultTip=this.config.defaultTip;return{title:"\u53d1\u9001\u79c1\u4fe1",bodyContent:i.formatTemplate(a("template/floatbox/messageBox"),b)}},bindEvent:function(){this._super(),this.$elem.bind("message:send:success",d.proxy(this.onSuccess,this)),this.$elem.bind("chartlet:send:success",d.proxy(this.onChartletSent,this)),this.$elem.delegate(".close-tips-trigger","click",d.proxy(this.onCloseTips,this)),this.$elem.bind("ajax:error",d.proxy(this.onSpamNotice,this)),this.$elem.bind("floatmessage:emotion:show",d.proxy(this.onEmotionShow,this)),this.$elem.bind("floatmessage:emotion:hide",d.proxy(this.onEmotionHide,this)),this.config.isNotice&&m.bind("notice:newItem",d.proxy(this.updateTarget,this))},postRender:function(){this.$elem.addClass("poplayer-sendMessage"),this._super();var a={data:{userId:this.data.userId,relationData:this.data.relationData},isShowDefaultTip:this.config.defaultTip!==""?!0:!1,tag:this.config.tag,floatMessageBox:this},b=new f(this.$elem,a);b.render(),this.messageSendBox=b,this.flagDistance=0,!this.config.noMessTips&&parseInt(j.get("boxMessTips"),10)!==1&&(this.$tipsElem=d(n.tips),this.$tipsElem.insertBefore(this.$elem.find(".js-addressee")))},onVerticalMiddle:function(a){var b=k.isIe6?l.scrollTop():0,c=(l.height()-this.$mainElem.height())/2-this.flagDistance;c=Math.max(c,0)+b,a?this.$mainElem.stop().animate({top:c,duration:500,easing:"easeInOutExpo"}):this.$mainElem.css({top:c})},sendCallBack:function(a){this.config.target.$elem&&this.config.target.$elem.trigger("floatmessage:send:success",[this.config.target,a])},onSuccess:function(a,b){var c=this;this.hide();var d=new g(null,{data:{type:"correct",text:"\u53d1\u9001\u6210\u529f\uff01"}});d.show(),d.delayHide(1500),setTimeout(function(){c.sendCallBack(b)},1800)},onChartletSent:function(a,b){this.hideTextarea("hide"),this.showChatletSentTips();var c=this;setTimeout(function(){c.sendCallBack(b)},1800);return!1},showChatletSentTips:function(){var a=this.$elem.find(".js-chartletSentTips");a.removeClass("hidden");var b=this;setTimeout(function(){a.addClass("hidden"),b.hideTextarea("show")},1500)},hideTextarea:function(a){var b=this.messageSendBox.$textarea;a==="hide"?b.attr("data-color",b.css("color")).css("color","#FFF"):b.css("color",b.attr("data-color")).focus()},show:function(){this._super();var a=this;setTimeout(function(){a.config.defaultTip===""&&a.messageSendBox.$textarea.focus()},10)},hide:function(){var a=this.messageSendBox.emotion;a.isShow&&a.hide(),this.config.isNotice&&d("body").unbind("notice:newItem",d.proxy(this.updateTarget,this)),this._super()},onCloseTips:function(){this.$tipsElem.remove(),j.set("boxMessTips",1,365)},updateTarget:function(a,b){this.config.target&&(this.config.target=b)},onSpamNotice:function(a,b){var c=this;b.status===427?(c.hide(),m.trigger("error",["spamNotice",function(){c.show()}])):b.status===428&&(c.hide(),m.trigger("error",["spamBlocked"]))},onEmotionShow:function(){this.flagDistance=120,this.setPosition()},onEmotionHide:function(){this.flagDistance=0,this.setPosition()}});n.tips='<p class="mess-tips-close" style="margin: -3px 0 5px -5px; padding-left: 8px;"><span>\u63d0\u9192\uff1a\u8bf7\u9009\u62e9\u719f\u6089\u7684\u73af\u5883\u89c1\u9762\uff0c\u4e0d\u8981\u548c\u4efb\u4f55\u4eba\u4ea7\u751f\u91d1\u94b1\u5f80\u6765\uff0c\u4ee5\u9632\u88ab\u9a97\u3002</span></p>';return n});define("sendbox/MessageSendBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("sendbox/BasicSendBox"),f=a("utils/Log"),g=a("model/UserData"),h=a("sendbox/widget/Emotion"),i=e.extend({_defaults:{ajaxUrl:"sendMess",maxHeight:168,maxLen:400,isCountChar:!0,isAutoHeight:!0,isShowDefaultTip:!1,tag:"",floatMessageBox:null},init:function(a,b){b=d.extend({},this._defaults,b),this._super(a,b)},postRender:function(){this._super(),this.$setTopElem=this.$elem.find(".js-setTop")},bindEvent:function(){this._super(),this.emotion=h.getInstance(null,{autoClose:!0,floatMessageBox:this.config.floatMessageBox,floatMessBoxElem:this.$elem,targetSendBox:this,data:this.data,bindResize:!0})},parseParams:function(){var a=d.trim(this.$textarea.val()),b={withUserId:this.data.userId,content:this.config.tag!==""?"#"+this.config.tag+"#"+a:a};g.getLoginUser().isSuperVip&&(b.isSetTop=this.$setTopElem.is(":checked")?1:0),d.extend(b,this.data.relationData);return b},onSendLog:function(a){f.doLog({parameter:{method:a.isSetTop===1?"tobuydmup":"dm"},elem:this.$elem})},onSuccess:function(a){this.onClearText(),this.$elem.trigger("message:send:success",[a]),this.$textarea.focus()},onReSend:function(){g.getLoginUser().isSuperVip&&this.$setTopElem.attr("checked",!1),this.$elem.find(".submit-trigger").trigger("click")}});return i});define("sendbox/BasicSendBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/Module"),f=a("sendbox/widget/TextArea"),g=a("sendbox/widget/WordCounter"),h=a("sendbox/SendBoxAction"),i=a("model/UserData"),j=a("utils/Log"),k=e.extend({defaults:{ajaxUrl:"",minLen:0,maxLen:326,maxHeight:null,isAutoHeight:!1,isCountChar:!1,isShowDefaultTip:!1},init:function(a,b){this._super(a,b),this.checkTimer=null,this.isBindEvent=!1},postRender:function(){this.$textarea=this.$elem.find("textarea"),this.$btn=this.$elem.find(".js-btn")},bindEvent:function(){this._super(),this.wordCounter=new g(this.$elem.find(".js-wordCounter"),{textarea:this.$textarea,minLen:this.config.minLen,maxLen:this.config.maxLen,isCountChar:this.config.isCountChar}),this.textarea=new f(this.$textarea,{maxHeight:this.config.maxHeight}),this.config.isAutoHeight&&this.bindAutoHeight(),this.config.isShowDefaultTip&&(d.trim(this.$textarea.val())!==""&&this.$elem.find(".js-default-tip").hide(),this.bindDefaultTip()),this.$elem.delegate(".submit-trigger","click",d.proxy(this.onSubmit,this)),this.bindCtrlEnter(),this.bindCheckInput()},bindAutoHeight:function(){this.textarea&&this.textarea.bindAutoHeight()},bindCtrlEnter:function(){h.bindCtrlEnter.call(this)},bindCheckInput:function(){h.bindCheckInput.call(this)},bindDefaultTip:function(){h.bindDefaultTip.call(this)},onCtrlEnter:h.ctrlEnter,onCheckInput:h.checkInput,checkInputVal:h.checkInputVal,onClearText:function(){this.$textarea.val("").keyup()},onRest:function(){},onSubmit:h.submit,onSend:h.send,parseParams:h.parseParams,onSuccess:function(){throw"Abstract Method!!!"},onSendLog:function(){},onSendSuccessLog:function(){}});return k});define("sendbox/widget/TextArea",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=e.extend({_timer:null,init:function(a,b){this.$elem=d(a),this.config=b||{},this.maxHeight=this.config.maxHeight||f.MAX_HEIGHT,this.bindEvent()},bindEvent:function(){this.$elem.bind("mouseup mousedown keyup keydown",d.proxy(this.onBlur,this))},bindAutoHeight:function(){this.$elem.bind("keyup",d.proxy(this.setHeight,this))},setHeight:function(){this.minHeight||(this.minHeight=this.$elem.height());var a=this;this.autoHeightTimer&&clearTimeout(this.autoHeightTimer),this.autoHeightTimer=setTimeout(function(){a.temptextAreaElem||a.createTempTextArea(),a.temptextAreaElem.value=a.$elem.val();var b=parseFloat(a.temptextAreaElem.scrollHeight);b>a.minHeight?a.maxHeight&&b>a.maxHeight?a.$elem.css({height:a.maxHeight+"px",overflowY:"auto"}):a.$elem.css({height:b+"px",overflowY:"hidden"}):a.$elem.css({height:a.minHeight+"px",overflowY:"hidden"})},80)},createTempTextArea:function(){var a=this.$elem.width(),b=d("#js_tmp_textarea")[0];b?this.temptextAreaElem=b:(b=d(document.createElement("TEXTAREA"))[0],b.id="js_tmp_textarea",b.style.height="0px",b.style.position="absolute",b.style.top="-10000px",b.style.height="0px",b.style.overflow="hidden",this.temptextAreaElem=b,d("body").append(b)),b.style.width=a+"px",b.style.lineHeight=this.$elem.css("lineHeight"),b.style.fontSize=this.$elem.css("fontSize"),b.style.fontFamily=this.$elem.css("fontFamily")},onBlur:function(a){if(d.inArray(a.which,[17])===-1){var b=this;b._timer&&clearTimeout(b._timer),b._timer=setTimeout(function(){b.$elem.data("lastPosition",b.$elem.getCaretPosition())},100)}},toInputPos:function(){this.$elem.focus().setCaretTo(this.$elem.data().lastPosition);return this},appendText:function(a){this.toInputPos(),this.$elem.appendAfterCaret(a);return this},appendTextToEnd:function(a){this.$elem.focusToEnd().appendAfterCaret(a);return this},clear:function(){this.$elem.val("").trigger("keyup");return this}});f.MAX_HEIGHT=105;return f});define("sendbox/widget/WordCounter",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("basic/Class"),f=e.extend({init:function(a,b){this.$elem=a,this.config=b||{},this.minLen=this.config.minLen,this.maxLen=this.config.maxLen||f.MAX_LEN,this.$textareaElem=this.config.textarea,this.timer=null,this.isError=!1,this.config.isCountChar=this.config.isCountChar||!1,this.config.isCountChar||(this.minLenVal=this.minLen/2),this.bindEvent()},bindEvent:function(){this.$textareaElem.bind("paste cut input keyup",d.proxy(this.onInput,this))},onInput:function(a){var b=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){var a=0,c=0;b.config.isCountChar?(a=f.countChar(b.$textareaElem.val()),c=b.maxLen-a):(a=f.count(b.$textareaElem.val()),c=Math.floor((b.maxLen-a)/2));var d=[];a<b.config.minLen||c<0?(b.$elem.addClass("waring"),b.isError=!0):(b.$elem.removeClass("waring"),b.isError=!1),a<b.config.minLen?(d.push('\u81f3\u5c11\u8f93\u5165<b class="char-constantia">'),d.push(b.minLenVal),d.push("</b>\u5b57")):(d.push('<b class="char-constantia">'),d.push(c),d.push("</b>\u5b57")),b.$elem.html(d.join(""))},100)}});f.MAX_LEN=326,f.count=function(a){a=d.trim(a).replace(/\s+/g,"*");if(a.match(/^\s+$/))return 0;a=a.replace(/[\uFE30-\uFFA0\u2E80-\u9FFF\uac00-\ud7ff\u3000‘“”’]/g,"**");return a.length},f.countChar=function(a){a=d.trim(a);return a.length};return f});define("sendbox/SendBoxAction",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("utils/DataSource"),f=a("utils/Utils"),g=a("utils/Error"),h={bindCheckInput:function(){this.$elem.delegate("textarea","paste cut input keyup",d.proxy(this.onCheckInput,this))},checkInput:function(){this.checkTimer&&clearTimeout(this.checkTimer);var a=this;this.checkTimer=setTimeout(function(){a.checkInputVal()?a.$btn.find(".js-btn-txt").removeClass("disabled"):a.$btn.find(".js-btn-txt").addClass("disabled")},100)},checkInputVal:function(){var a=d.trim(this.$textarea.val());if(a.length===0||this.wordCounter.isError)return!1;return!0},checkPhoneVal:function(){var a=d.trim(this.$phone.val()),b=a;if(a==="")return!0;if(a.length>20)return!1;b=b.replace(/-/g,"").replace(/\s/g,"");return/^\d+$/.test(b)},bindCtrlEnter:function(a){this.$elem.delegate("textarea","keydown",d.proxy(this.onCtrlEnter,this))},ctrlEnter:function(a){var b=a.which||a.keyCode;a.ctrlKey===!0&&b===13&&this.onSubmit(a)},bindDefaultTip:function(){var a=this.$elem.find(".js-default-tip"),b=this;a.bind("click",function(){b.$textarea.focus()}),this.$textarea.bind("focus",function(){a.hide()}).bind("blur",function(){d.trim(b.$textarea.val()).length===0&&a.show()})},submit:function(a){if(!!this.checkInputVal()){var b=this.parseParams();this.onSend(a,b)}},send:function(a,b){if(!d.isPlainObject(this.request)||this.request.readyState===4){var c=this,f=this.$elem.find(".submit-trigger");this.request=e.setTrigger(f).postJSON(this.config.ajaxUrl,b,function(a){var d=parseInt(a.code)||1;g.Tips(d,null,f)||(c.onSuccess(a),c.onSendSuccessLog(b))}).error(function(a){c.$elem.trigger("ajax:error",[a])}),this.onSendLog(b)}},parseParams:function(){var a={},b=d.trim(this.$textarea.val());b!==""&&(a.content=b);return a}};return h});define("sendbox/widget/Emotion",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("utils/tmpl"),f=a("widget/box/winBox/Box"),g=a("utils/DataSource"),h=a("utils/Cookie"),i=a("utils/PagerScroll"),j=a("sendbox/widget/EmotionAction"),k=a("widget/box/winBox/TipsBox"),l=a("widget/box/floatBox/BuyConfirmBox"),m=a("model/UserData"),n=a("utils/Log"),o=a("widget/RollSlider"),p=a("utils/Utils"),q=d(window),r=f.extend({init:function(a,b){this._super(a,b),this.emotionData={all:{}},this.isMacOS=navigator.appVersion.indexOf("Mac")!==-1?!0:!1,this.initPagerScroll={},this.resetData(b)},onEmotionTrigger:function(a,b){this.$trigger.trigger("floatmessage:emotion:show"),this.show(a,this.config);if(b){var c=this;setTimeout(function(){c.$elem.find(".js-tabItem[data-target="+b+"]").trigger("click",[!0])},150)}},bindEvent:function(){this._super(),this.$elem.delegate(".js-normalEmotion","click",d.proxy(this.onFreeEmotion,this)),this.$elem.delegate(".js-paidEmotion","click",d.proxy(this.onPaidEmotion,this)),this.$elem.delegate(".buy-trigger","click",{type:"buy"},d.proxy(this.onBuyChartlet,this)),this.$elem.delegate(".buyfor-trigger","click",{type:"buyfor"},d.proxy(this.onBuyChartlet,this)),this.$elem.delegate(".get-trigger","click",{type:"get"},d.proxy(this.onBuyChartlet,this)),this.$elem.bind("chartlet:send:success",d.proxy(this.onSendChartlet,this)),this.$elem.bind("charlet:send:error",d.proxy(this.onSendError,this)),this.$elem.delegate(".js-tabItem","click",d.proxy(this.onTabSwitch,this));var a=r.CONFIG.freeEmotion;h.get("hasShowPaidEmotion_1203")||(a=r.CONFIG.defaultTab,h.set("hasShowPaidEmotion_1203",1,90)),this.$elem.find(".js-tabItem[data-target="+a+"]").trigger("click",[!0]),this.initTabsSlider()},onTabSwitch:function(a){var b=d(a.currentTarget),c=this.$elem.find(".js-tabItem"),e=b.data("target");c.removeClass("current"),b.addClass("current"),this.currentIndex=c.index(b),this.lastClassName&&this.$emotionCon.removeClass(this.lastClassName),this.$emotionCon.addClass(e),this.lastClassName=e,this.getEmotionData(a,e)},initTabsSlider:function(){var a=this;setTimeout(function(){a.tabSlider=new o(a.$elem.find(".js-sliderBox"),{autoplay:!1,duration:200,reelContainer:".js-list",slideItem:".js-sliderItem",prevBtn:".prev-trigger",nextBtn:".next-trigger"})},50)},onFreeEmotion:function(a){this.targetSendBox&&this.targetSendBox.textarea.appendText("["+d(a.currentTarget).data("code")+"]")&&this.targetSendBox.textarea.$elem.trigger("keyup"),a.ctrlKey||this.isMacOS&&a.metaKey?d.browser.opera&&a.preventDefault():this.hide()},onPaidEmotion:function(a){var b=d(a.currentTarget),c=b.data("code");if(this.checkChartlet(c))j.doChartlet.call(this,c,b),n.doLog({parameter:{method:"dmsticker"},elem:d(a.currentTarget)});else{var e=r.isVipChartlet(this.lastClassName)?"\u5f00\u901a\u4f1a\u5458\u65b9\u53ef\u4f7f\u7528":this.emotionData[this.lastClassName].price===0?"\u9886\u53d6\u540e\u53ef\u4f7f\u7528":"\u8d2d\u4e70\u540e\u53ef\u4f7f\u7528";k.getInstance().show(a,{data:{type:"warning",text:e}})}},getParams:function(a){var b={withUserId:this.data.userId,content:"["+a+"]"};this.data.trendId?b.trendId=this.data.trendId:this.data.photoId?b.photoId=this.data.photoId:this.data.questionId?b.questionId=this.data.questionId:this.data.profilePhotoId&&(b.profilePhotoId=this.data.profilePhotoId);return b},getEmotionData:function(a,b){if(!d.isPlainObject(this.getEmotionRequest)||this.getEmotionRequest.readyState===4){var c=this;b==="emoji-free"?this.emotionData[b]||(this.getEmotionRequest=g.postJSON("getEmotion",{},function(a){a&&a.emotion&&(c.renderEmotionItems(b,a.emotion),c.emotionData[b]=a)})):this.getEmotionRequest=g.postJSON("getChartlet",{serviceId:r.CONFIG.detail[b].serviceId,otherId:this.userId},function(a){if(a&&a.list){var e=c.emotionData[b]&&c.emotionData[b].myPermission!==a.myPermission?!0:!1;c.updatePanel(b,a);if(!c.emotionData[b]||e)c.renderEmotionItems(b,a,e),d.each(a.list,function(a,b){c.emotionData.all[b.code]=b});c.emotionData[b]=a}})}},renderEmotionItems:function(b,c,d){var f={type:b,emotion:c},g="";b==="emoji-free"?g=b:g="emoji-chartlet";var h=r.CONFIG.visibleHeight[g];f.fillNums=this.getFillNums(g,c);var i=this.$emotionPanels.eq(this.currentIndex);i.find("ul").html(e.formatTemplate(a("template/sendbox/widget/emotionItem"),f)),this.bindPagerScroll({name:b,elem:i.find(".js-container"),scrollbar:i.find(".js-scrollbar"),content:i.find(".js-content"),pageNumElem:i.find(".js-pageNum"),visibleHeight:h,forceUpdate:d})},updatePanel:function(b,c){var d=this.$emotionPanels.eq(this.currentIndex);c.myPermission?d.removeClass("emoji-locked"):d.find(".js-intro").removeClass("hidden");var f=m.get(this.data.userId),g=f&&f.sex||2;d.find(".js-foot").html(e.formatTemplate(a("template/sendbox/widget/chartletBtn"),{name:r.CONFIG.detail[b].name,json:c,sex:g,isVipChartlet:r.isVipChartlet(b)}))},getFillNums:function(a,b){var c=r.CONFIG.fillConfig[a],d=0,e=b.length||b.list.length,f=c.page_1_fix,g=c.page_1;b.myPermission&&(f=c.page_1_bought_fix,g=c.page_1_bought);var h=(e-f)%c.page_2;e<g?d=g-e:h!==0&&(d=c.page_2-h);return d},bindPagerScroll:function(a){if(!this.initPagerScroll[a.name]||a.forceUpdate){var b=this;b.initPagerScroll[a.name]=!0,setTimeout(function(){new i(a.elem,{scrollbar:a.scrollbar,content:a.content,pageNumElem:a.pageNumElem,visibleHeight:a.visibleHeight,scrollCallback:d.proxy(b.scrollCallback,b)})},100)}},scrollCallback:function(a){var b=this.$emotionPanels.eq(this.currentIndex);b.find(".js-page").text(a.currentPage+"/"+a.totalPage)},postRender:function(){this._super(),this.$emotionCon=this.$elem.find(".js-emotionCon"),this.$emotionPanels=this.$emotionCon.find(".js-panel")},onSendChartlet:function(a,b){this.hide(),this.$floatMessBoxElem.trigger("chartlet:send:success",[b])},onSendError:function(a,b){var c=this;b&&b.statusCode&&b.statusCode({547:function(){c.hide()},592:function(){c.hide()}})},checkChartlet:function(a){return this.emotionData.all[a].free||this.emotionData[this.lastClassName].myPermission},onBuyChartlet:function(a){var b={buy:"tobuySticker",buyfor:"togiveSticker",get:"togetSticker"};n.doLog({parameter:{method:b[a.data.type]},elem:d(a.currentTarget)});var c=this.getChartletParams(a.data);this.baughtClassName=this.lastClassName;var e=this;setTimeout(function(){e.floatMessageBox&&e.floatMessageBox.hide(),e.hide(),e.doBuyChartlet(c)},100)},getChartletParams:function(a){var b={url:"createNewDeal",data:{serviceId:r.CONFIG.detail[this.lastClassName].serviceId}};a.type==="buyfor"&&(b.url="createPresentDeal",b.tips="\u652f\u4ed8\u5e76\u8d60\u9001\u6210\u529f\uff01",b.data.receiverId=this.userId);return b},doBuyChartlet:function(a){if(!d.isPlainObject(this.dealRequest)||this.dealRequest.readyState===4){var b=this;this.dealRequest=g.postJSON(a.url,a.data,function(c){if(c&&c.status===1){var e=c.payInfo;b.buyConfirmBox=new l(null,{data:e.dealInfo,userAccount:e.userAccount,isBlankTab:!0,successText:a.tips||"\u8d2d\u4e70\u6210\u529f\uff01",logName:"Sticker",successCallBack:d.proxy(b.buySuccess,b),closeCallBack:d.proxy(b.buyRedirect,b),redirectCallBack:d.proxy(b.buyRedirect,b)}),b.buyConfirmBox.show()}})}},buySuccess:function(){this.floatMessageBox&&this.floatMessageBox.show(),this.$trigger.trigger("click",[this.baughtClassName])},buyRedirect:function(){this.buyConfirmBox.hide(null,!0),this.floatMessageBox&&this.floatMessageBox.show(),this.hide(),this.$trigger.click()},hide:function(){this.$trigger.trigger("floatmessage:emotion:hide"),this.reset(),this._super()},renderTmpl:function(){var b={isMacOS:this.isMacOS};return d(e.formatTemplate(a("template/sendbox/widget/emotion"),b))},setPosition:function(){var a=this.$trigger.offset(),b=p.isIe6?0:q.scrollTop();this.$elem.css({left:a.left+this.$trigger.width()/2+203,top:a.top-b+this.$trigger.height()+10}),this.$elem.find(".js-arrowUp").css({left:23})},reset:function(){this.$elem.find(".js-tabItem[data-target="+r.CONFIG.freeEmotion+"]").trigger("click",[!0]),this.tabSlider&&this.tabSlider.rollTo(!1,0),this._super()},resetData:function(a){this.floatMessageBox=a.floatMessageBox,this.$floatMessBoxElem=a.floatMessBoxElem,this.data=this.config.data=a.data,this.userId=a.data.userId,this.targetSendBox=a.targetSendBox,this.$trigger=a.targetSendBox.$elem.find(".emotion-trigger"),this.$trigger.bind("click",d.proxy(this.onEmotionTrigger,this))}});r.isVipChartlet=function(a){var b=r.CONFIG.detail[a]||{};return b.isVipChartlet?!0:!1},r.CONFIG={defaultTab:"emoji-nn",freeEmotion:"emoji-free",detail:{"emoji-xxy":{serviceId:"-1992227899785330385",name:"\u718a\u5c0f\u6613"},"emoji-devilfish":{serviceId:"-8386241936569083172",name:"\u7ae0\u5c0f\u5446"},"emoji-prx":{serviceId:"1994124949427451733",name:"\u76ae\u5c14\u718a"},"emoji-tmz":{serviceId:"-1197770535137152139",name:"\u5154\u7f8e\u5179"},"emoji-ajmd":{serviceId:"2135760413373753738",name:"\u963f\u9e21\u7c73\u5fb7"},"emoji-nn":{serviceId:"3078661434760529106",name:"\u599e\u599e",isVipChartlet:!0},"emoji-chuck":{serviceId:"1464586960077334041",name:"Chuck",isVipChartlet:!0}},fillConfig:{"emoji-free":{page_1:84,page_2:84,page_1_fix:0},"emoji-chartlet":{page_1:14,page_1_bought:21,page_2:21,page_1_fix:14,page_1_bought_fix:0}},visibleHeight:{"emoji-free":238.5,"emoji-chartlet":177.5}};var s=null;return{getInstance:function(a,b){if(s){s.resetData(b);return s}s=new r(a,b);return s}}});define("utils/PagerScroll",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=e.extend({init:function(a,b){this.$elem=d(a);if(this.$elem.data("initPagerScroll")!=="1"){this.$scrollbar=d(b.scrollbar),this.$content=d(b.content),this.$pageNumElem=d(b.pageNumElem),this.config=b||{},this.innerHeight=b.visibleHeight||this.$elem.innerHeight(),this.scrollHeight=this.fixHeight();var c=this.totalPage=Math.round(this.scrollHeight/this.innerHeight);if(c===1)return;this.currentPage=1,this.isAnimating=!1,this.containerTimeout=null,this.scrollbarTimeout=null,this.maxContentScrollRange=this.scrollHeight-this.innerHeight,this.contentScrollUnit=this.maxContentScrollRange/c,this.maxPageNumElemPosition=this.innerHeight-this.$pageNumElem.height()/2,this.queueAnimation=[],this.initScrollbar(),this.$elem.attr("initPagerScroll","1"),this.scrollCallback(),this.bindEvent()}},fixHeight:function(){var a=this.$content.height();if(a%this.innerHeight!==0&&Math.abs(a-this.innerHeight)>1){var b=Math.ceil(a/this.innerHeight)*this.innerHeight;this.$content.height(b);return b}return a},initScrollbar:function(){var a=this.scrollHeight;this.$scrollbar.html('<div style="height:'+a+'px;"></div>').removeClass("hidden").show(),this.$scrollbar.height(this.innerHeight)},bindEvent:function(){this.$elem.bind("DOMMouseScroll mousewheel",d.proxy(this.onContainerScroll,this));var a=this,b=this.$scrollbar;b.bind("hover",function(c){c.type==="mouseenter"?(b.bind("scroll",d.proxy(a.onScrollBar,a)),a.isOverScrollbar=!0,a.setPageElemPosition()):(a.isOverScrollbar=!1,b.unbind("scroll",d.proxy(a.onScrollBar,a)),a.setPageElemPosition())}),b.bind("mouseup",function(b){a.fixScrollbarPosition()})},onContainerScroll:function(a){this.containerTimeout&&clearTimeout(this.containerTimeout);var b=this.fixDelta(a),c=this;this.containerTimeout=setTimeout(function(){c.containerTimeout&&clearTimeout(c.containerTimeout);var a=c.$elem,d=c.$scrollbar,e=f.DEFAULT.duration,g=c.scrollHeight,h=c.innerHeight,i=c.maxContentScrollRange,j=b>0?"up":"down",k=j==="up"&&a.scrollTop()===0||j==="down"&&a.scrollTop()===i;if(!k&&!c.isAnimating&&a.scrollTop()>=0&&a.scrollTop()<=i){c.isAnimating=!0;var l=a.scrollTop()-h*b/120;if(j==="down")var l=l>i?i:l;else var l=l<0?0:l;c.playAnimate(a,{scrollTop:l+"px"},e,function(){c.currentPage=Math.round(a.scrollTop()/h)+1,c.scrollCallback(),c.setPageElemPosition()}),c.playAnimate(d,{scrollTop:l+"px"},e,function(){c.isAnimating=!1})}},80);return!1},fixDelta:function(a){var b=a.originalEvent.wheelDelta||a.originalEvent.detail,c=d.browser;c.mozilla&&(b=-b*120),c.safari&&(b=b*10);return b},onScrollBar:function(a){this.scrollbarTimeout&&clearTimeout(this.scrollbarTimeout);var b=this;this.scrollbarTimeout=setTimeout(function(){b.scrollbarTimeout&&clearTimeout(b.scrollbarTimeout);var a=b.$elem,c=b.contentScrollUnit,d=b.innerHeight,e=b.maxContentScrollRange,g=b.$scrollbar.scrollTop(),h=!(g>(b.currentPage-1)*c&&g<b.currentPage*c);if(!b.isAnimating&&h){b.isAnimating=!0;var i=(d+g)/d,j=Math.round(i-1)*d;j=j>e?e:j,b.playAnimate(a,{scrollTop:j+"px"},f.DEFAULT.duration,function(){b.isAnimating=!1,b.currentPage=Math.round(a.scrollTop()/d)+1,b.setPageElemPosition(),b.scrollCallback(),b.animationQueue()})}},30)},scrollCallback:function(){this.config.scrollCallback&&this.config.scrollCallback({currentPage:this.currentPage,totalPage:this.totalPage})},setPageElemPosition:function(){this.$pageNumElem.removeClass("hidden").show().css({top:this.maxPageNumElemPosition*this.currentPage/this.totalPage-this.innerHeight/this.totalPage/2}),this.hidePageElem()},hidePageElem:function(){this.pageElemTimeout&&clearTimeout(this.pageElemTimeout);if(!this.isOverScrollbar){var a=this;this.pageElemTimeout=setTimeout(function(){a.pageElemTimeout&&clearTimeout(a.pageElemTimeout),a.$pageNumElem.fadeOut(500,function(){})},1e3)}},playAnimate:function(a,b,c,e){d(a).animate(b,c,function(){e&&e()})},fixScrollbarPosition:function(){if(!this.isAnimating){var a=this;this.isAnimating=!0,this.playAnimate(this.$scrollbar,{scrollTop:(this.currentPage-1)*this.innerHeight+"px"},50,function(){a.isAnimating=!1})}else this.queueAnimation.push(d.proxy(arguments.callee,this))},animationQueue:function(){var a=d.Deferred(),b=this;a.done(this.queueAnimation).done(function(){b.queueAnimation=[]}),a.resolve()}});f.DEFAULT={duration:200};return f});define("sendbox/widget/EmotionAction",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/DataSource"),g=a("utils/Error"),h={doChartlet:function(a,b){if(!d.isPlainObject(this.charletRequest)||this.charletRequest.readyState===4){var c=this;this.charletRequest=f.setTrigger(b).postJSON("sendMess",this.getParams(a),function(a){g.showTips({json:a,triggerElem:b})||c.$elem.trigger("chartlet:send:success",[a])}).error(function(a){c.$elem.trigger("charlet:send:error",[a])})}}};return h});define("widget/box/floatBox/BuyConfirmBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/box/floatBox/Box"),f=a("utils/Utils"),g=a("utils/tmpl"),h=a("utils/Error"),i=a("utils/DataSource"),j=a("utils/Log"),k=a("model/UserAccount"),l=a("model/UserData"),m=a("widget/box/floatBox/TipsBox"),n=a("widget/box/floatBox/PayConfirmBox"),o=d(document.body),p=e.extend({defaults:{isBlankTab:!1,successText:"\u8d2d\u4e70\u6210\u529f\uff01",isShowCaution:!1,cautionText:"",isShowSubBtn:!1,subBtnText:"",payBtnText:"\u7acb\u5373\u652f\u4ed8",logName:""},init:function(a,b){this._super(a,b),this.config=d.extend({},this.defaults,b),this.data=this.config.data||{},this.userAccount=b.userAccount||{}},parseData:function(){var a={data:d.extend({},this.data),userAccount:this.userAccount,loginUser:l.getLoginUser()};a.isBlankTab=this.config.isBlankTab,this.config.isShowCaution&&(a.caution={text:this.config.cautionText}),this.config.isShowSubBtn&&(a.subBtn={text:this.config.subBtnText}),a.payBtnText=this.config.payBtnText,a.isGiftBox=this.config.isGiftBox,a.data.serviceDescription=f.countChars(a.data.serviceDescription,12,!1);return a},preRender:function(){return{title:"\u8d2d\u4e70\u670d\u52a1\u786e\u8ba4",bodyContent:g.formatTemplate(a("template/floatbox/buyConfirmBox"),this.parseData())}},bindEvent:function(){this._super(),this.$elem.delegate(".pay-trigger","click",d.proxy(this.onSubmit,this)),this.$elem.delegate(".charge-trigger","click",d.proxy(this.onCharge,this)),this.$elem.delegate(".chargermb-trigger","click",d.proxy(this.onChargermb,this)),this.config.isShowSubBtn&&this.$elem.delegate(".subBtn-trigger","click",d.proxy(this.onSubBtn,this))},postRender:function(){this._super(),this.$elem.addClass("poplayer-buy")},hide:function(a,b){!b&&this.config.closeCallBack?this.config.closeCallBack():this._super()},onSubmit:function(a){if(!d.isPlainObject(this.request)||this.request.readyState===4){var b=this.parseParams(),c=this;this.request=i.postJSON("payDeal",b,function(b){h.showTips({json:b,evt:a})?c.config.error&&(c.hide(null,!0),c.config.error({})):(b.userAccount&&k.update(b.userAccount),c.hide(null,!0),c.onSuccess(b))}),j.doLog({parameter:{method:"buy"+this.config.logName},elem:d(a.currentTarget)})}},parseParams:function(){var a={};a.dealId=this.data.id,this.config.params&&d.extend(a,this.config.params);return a},onSuccess:function(a){var b=this,c=new m(null,{data:{type:"correct",text:this.config.successText}});c.show(),c.delayHide(2e3),setTimeout(function(){b.config.successCallBack&&b.config.successCallBack(a)},2300)},onCharge:function(a){var b=this;setTimeout(function(){b.config.isBlankTab&&b.config.redirectCallBack&&b.config.redirectCallBack()},100),j.doLog({parameter:{method:"tocharge"+this.config.logName},elem:d(a.currentTarget)})},onChargermb:function(a){var b=this,c=this.$elem.find(".js-dealId").val(),e=d(a.target).data("target");i.ajax("saveNewOrderForDeal",{async:!1,type:"post",data:{dealId:c},success:function(d){var e=parseInt(d.code)||1;h.Tips(e,a)||(d.sess_valid?b.onChargermbSuccess(d,c):(b.hide(),o.trigger("error",["payLoginAgain",{session:d,callback:function(){b.show()}}])))}}),j.doLog({parameter:{method:"buy"+this.config.logName},elem:d(a.currentTarget)})},onChargermbSuccess:function(a,b){var c=this.$elem.find(".js-from"),d=this.$elem.find(".js-chargeId"),e=this;d.val(a.chargeId),c.submit();var f=b?"/pay/expenseBill?dealId="+b:"/pay/chargeBill?chargeId="+a.chargeId,g=b?"paycharged":"charged";target?e.config.redirectCallBack&&e.config.redirectCallBack():(e.hide(),e.showPayConfirmBox({jumpUrl:f,method:g,buytype:"rmb",dealId:b,logName:e.config.logName}))},showPayConfirmBox:function(a){var b=new n(null,a);b.show()},onSubBtn:function(){this.hide(null,!0),this.config.subBtnCallBack&&this.config.subBtnCallBack()}});return p});define("widget/box/floatBox/PayConfirmBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/box/floatBox/Box"),f=a("utils/tmpl"),g=a("utils/Error"),h=a("utils/DataSource"),i=a("utils/Log"),j=d(document.body),k=e.extend({init:function(a,b){this._super(a,b),this.data.type="warning",this.data.content="\u8bf7\u5728\u65b0\u6253\u5f00\u7684\u7f51\u6613\u5b9d\u9875\u9762\u4e2d\u5b8c\u6210\u4ed8\u6b3e",this.data.jumpUrl=b.jumpUrl||"/pay/chargeBill",this.data.from=b.from||"",this.data.dealId=b.dealId},preRender:function(){return{title:"\u786e\u8ba4\u4ed8\u6b3e",bodyContent:f.formatTemplate(a("template/floatbox/payConfirmBox"),d.extend({},this.data))}},bindEvent:function(){this._super(),this.$elem.delegate(".submit-trigger","click",d.proxy(this.onSubmit,this)),this.$elem.delegate(".repay-trigger","click",d.proxy(this.onRepay,this))},postRender:function(){this._super(),this.$elem.addClass("poplayer-payVerify")},onSubmit:function(a){i.doLog({parameter:{method:this.config.method},elem:d(a.currentTarget)});var b=this;setTimeout(function(){b.config.buytype=="rmb"?location.reload():window.location.href=d(a.currentTarget).data("href")},100)},onRepay:function(a){var b=d(a.target).data("from");b!=="chargePage"?this.onRepayrmb(a):this.$elem.trigger("payConfirm:chargeRepay",[1,this])},onRepayrmb:function(a){var b=this.$elem.find(".js-from"),c=this.$elem.find(".js-chargeId"),e=this.$elem.find(".js-dealId").val();h.ajax("saveNewOrderForDeal",{async:!1,type:"post",data:{dealId:e},success:function(d){var e=parseInt(d.code)||1;g.Tips(e,a)||(c.val(d.chargeId),b.submit())}}),i.doLog({parameter:{method:"buy"+this.config.logName},elem:d(a.currentTarget)})},onTrouble:function(a){this.delayHide(500)}});return k});define("template/floatbox/payConfirmBox",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="poplayer-bd"><div class="poplayer-messbox"><span class="poplayer-mess">'),type==="warning"&&p.push('<em class="icon-warning-b"></em>'),p.push("",content,"</span></div>"),typeof desc!="undefined"&&desc!==""&&p.push('<p class="poplayer-desc">',desc,"</p>"),p.push('<p class="poplayer-desc">\u4ed8\u6b3e\u9047\u5230\u95ee\u9898\uff0c\u67e5\u770b<a class="link-lightBlue poplayer-link" href="/help/faq?pageNav=charge" target="_blank" data-method="payitem">\u4ed8\u6b3e\u5e2e\u52a9</a></p><p class="poplayer-desc">\u5df2\u5b8c\u6210\u4ed8\u6b3e\uff0c\u53ef\u67e5\u770b<a class="link-lightBlue poplayer-link" href="',jumpUrl,'" target="_blank">\u6d88\u8d39\u8ba2\u5355</a></p></div><div class="poplayer-ft"><div class="poplayer-btn"><a class="btn btn-red submit-trigger" href="javascript:;" data-href="',jumpUrl,'">\u5df2\u5b8c\u6210\u4ed8\u6b3e</a><a class="btn btn-gray repay-trigger" href="javascript:;" data-method="payitem" '),from=="chargePage"&&p.push('data-from="chargePage"'),p.push(">\u91cd\u65b0\u4ed8\u6b3e</a></div></div>"),from||p.push('<form class="js-from" method="post" action="/pay/submitCharge" target="_blank"><input class="js-chargeId" type="hidden" name="chargeId" value=""/><input class="js-dealId" type="hidden" name="dealId" value="',dealId,'"/></form>'),p.push("");return p.join("")}});define("template/floatbox/buyConfirmBox",function(require){return function(tmplData){var p=[];with(tmplData){p.push("");var isEnough=parseFloat(userAccount.totalBalance)>=parseFloat(data.dealAmount),rmbTotalBalance=userAccount.totalBalance/10,needToPay=(data.rmb*10-userAccount.totalBalance)/10,isPayByRMB=data.service.buyType==1?!0:!1;p.push('<div class="poplayer-bd js-body"><p class="poplayer-mt">\u8d2d\u4e70\u670d\u52a1\uff1a',data.serviceName,'<span class="text-md f12">\u660e\u7ec6\uff1a',data.serviceDescription,"</span></p><p>"),loginUser&&loginUser.isVip&&isGiftBox?p.push("\u4f1a\u5458\u4ef7\u683c\uff1a"):p.push("\u670d\u52a1\u4ef7\u683c\uff1a"),p.push(""),isPayByRMB?p.push('<b class="text-red">',data.rmb,"</b>\u5143"):(p.push('<b class="text-red">',data.dealAmount,"</b>\u4e2a\u82b1\u7530\u5e01"),data&&"rmb"in data&&p.push("\uff08",data.rmb,"\u5143\uff09"),p.push("")),p.push("</p><p>\u6211\u7684\u4f59\u989d\uff1a"),isPayByRMB?(p.push('<b class="text-red">',rmbTotalBalance,"</b>\u5143"),userAccount.totalBalance!=0&&p.push("\uff08",userAccount.totalBalance,"\u4e2a\u82b1\u7530\u5e01\uff09"),p.push("")):(p.push('<b class="text-red">',userAccount.totalBalance,"</b>\u4e2a\u82b1\u7530\u5e01\uff08",rmbTotalBalance,"\u5143\uff09"),isEnough||p.push('<span class="poplayer-buy-surplus text-red">\u4f59\u989d\u4e0d\u8db3</span>'),p.push("")),p.push("</p>"),isPayByRMB&&!isEnough&&p.push('<p>\u8fd8\u9700\u652f\u4ed8\uff1a<b class="text-red">',needToPay,"</b>\u5143</p>"),p.push('</div><div class="poplayer-ft">'),typeof caution!="undefined"&&isEnough&&p.push('<p class="poplayer-buy-caution">',caution.text,"</p>"),p.push('<div class="poplayer-btn">'),typeof subBtn!="undefined"&&!isEnough&&p.push('<a class="btn btn-gray subBtn-trigger" href="javascript:;">',subBtn.text,"</a>"),p.push(""),isEnough?p.push('<a class="btn btn-red pay-trigger" href="javascript:;">',payBtnText,"</a>"):(p.push(""),isPayByRMB?(p.push('<a class="btn btn-red chargermb-trigger" '),isBlankTab&&p.push('data-target="_blank"'),p.push('href="javascript:;">',payBtnText,"</a>")):(p.push('<a class="btn btn-red charge-trigger" '),isBlankTab&&p.push('target="_blank"'),p.push('href="/pay/charge?dealId=',data.id,'">\u53bb\u5145\u503c</a>')),p.push("")),p.push("</div></div>"),isPayByRMB&&p.push('<form class="js-from" method="post" action="/pay/submitCharge" target="_blank"><input class="js-chargeId" type="hidden" name="chargeId" value=""/><input class="js-dealId" type="hidden" name="dealId" value="',data.id,'"/></form>'),p.push("")}return p.join("")}});define("widget/RollSlider",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=e.extend({current:0,lastSlider:0,timer:null,slideWidth:0,slideCount:0,reelWidth:0,DEFAULT:{autoplay:!0,interval:2e3,duration:500,reelContainer:"",slideItem:"",prevBtn:"",nextBtn:"",pageItem:"",disabled:"disabled",loopScroll:!1,rollCallback:null,rollBefore:null,transition:null,transitionDura:0,btnLockTime:0},init:function(a,b){this.$elem=d(a),this.config=d.extend({},this.DEFAULT,b),this.$pageItems=this.$elem.find(this.config.pageItem),this.resize(),this.rollSwitch(),this.bindEvent(),this.setPager()},resize:function(){this.slideWidth=this.$elem.find(this.config.slideItem).width(),this.slideCount=this.$elem.find(this.config.slideItem).size(),this.reelWidth=this.slideWidth*this.slideCount,this.$elem.find(this.config.reelContainer).css({width:this.reelWidth,position:"absolute"})},bindEvent:function(){var a=this.config;a.prevBtn&&this.$elem.delegate(a.prevBtn,"click",d.proxy(this.onPagePrev,this)),a.nextBtn&&this.$elem.delegate(a.nextBtn,"click",d.proxy(this.onPageNext,this)),a.pageItem&&this.$elem.delegate(a.pageItem,"click",d.proxy(this.onPageClick,this))},onPagePrev:function(a){var b=this.config,c=b.disabled,e=this.current;if(!!b.loopScroll||!!this.canPrev)this.prevTimer&&clearTimeout(this.prevTimer),this.prevTimer=setTimeout(d.proxy(function(){clearInterval(this.timer),this.doRollBefore(e),this.lastSlider=this.current,this.current-=1,this.current<0&&(b.loopScroll?this.current=this.slideCount-1:this.current=0),this.setPager();var a=this;this.playTransition(function(){a.roll(!0),a.rollSwitch()})},this),b.btnLockTime)},onPageNext:function(a){var b=this.config,c=b.disabled,e=this.current;if(!!b.loopScroll||!!this.canNext)this.nextTimer&&clearTimeout(this.nextTimer),this.nextTimer=setTimeout(d.proxy(function(){clearInterval(this.timer),this.doRollBefore(e),this.lastSlider=this.current,this.current+=1,this.current>this.slideCount-1&&(b.loopScroll?this.current=0:this.current=this.slideCount-1),this.setPager();var a=this;this.playTransition(function(){a.roll(!0),a.rollSwitch()})},this),b.btnLockTime)},onPageClick:function(a){var b=d(a.currentTarget),c=b.prevAll(this.config.pageItem).size(),e=this.current;if(c!==this.current){this.doRollBefore(e),this.lastSlider=b.siblings(".current").prevAll(this.config.pageItem).size(),this.current=c,clearInterval(this.timer),this.setPager();var f=this;this.playTransition(function(){f.roll(!0),f.rollSwitch()})}},roll:function(a,b){this.doRollCallback();var c=this.current,d=this.config;typeof b!="undefined"&&(c=this.current=b);var e=this,f=c*this.slideWidth;a?this.$elem.find(d.reelContainer).animate({left:-f},d.duration):this.$elem.find(d.reelContainer).css({left:-f})},rollTo:function(a,b){this.roll(a,b),this.setPager()},doRollCallback:function(){this.config.rollCallback&&this.config.rollCallback(this.current,{lastSlider:this.lastSlider})},doRollBefore:function(a){this.config.rollBefore&&this.config.rollBefore(a)},setPager:function(){var a=this.$elem.find(this.config.prevBtn),b=this.$elem.find(this.config.nextBtn),c=this.$pageItems,d=this.config.disabled;c.size()&&(c.filter(".current").removeClass("current"),c.eq(this.current).addClass("current"));if(this.slideCount===1)a.addClass(d),b.addClass(d),this.canPrev=this.canNext=!1;else{if(this.current===this.slideCount-1){a.removeClass(d),b.addClass(d),this.canPrev=!0,this.canNext=!1;return}if(this.current===0){a.addClass(d),b.removeClass(d),this.canPrev=!1,this.canNext=!0;return}this.canPrev=this.canNext=!0,a.removeClass(d),b.removeClass(d)}},playTransition:function(a){var b=this.config;if(b.transition){var c=this;b.transition(this.current),setTimeout(function(){a()},b.transitionDura)}else a()},rollSwitch:function(){var a=this;!this.config.autoplay||(a.timer=setInterval(function(){a.onPageNext()},this.config.interval))}});return f});define("template/sendbox/widget/emotionItem",function(require){return function(tmplData){var p=[];with(tmplData){p.push("");if(emotion.length||emotion.list&&emotion.list.length){p.push("");if(type==="emoji-free"){p.push("");for(var i=0;i<emotion.length;i++)p.push('<li class="js-normalEmotion emotion-item" data-code="',emotion[i].content,'"><i class="n-emoji-valign"></i><img src="',emotion[i].url,'" title="',emotion[i].title,'" alt="',emotion[i].title,'" /></li>');p.push("");if(fillNums>0){p.push("");for(var i=0;i<fillNums;i++)p.push("<li></li>");p.push("")}p.push("")}else{p.push("");for(var i=0;i<emotion.list.length;i++)p.push('<li class="js-paidEmotion emotion-item" data-code="',emotion.list[i].code,'"><i class="n-emoji-valign"></i><img src="',emotion.list[i].url,'" title="',emotion.list[i].title,'" alt="',emotion.list[i].title,'" />'),emotion.list[i].free===!0?p.push('<em class="icon-try"></em>'):p.push('<em class="icon-lock"></em>'),p.push("</li>");p.push("");if(fillNums>0){p.push("");for(var i=0;i<fillNums;i++)p.push("<li></li>");p.push("")}p.push("")}p.push("")}else p.push("\u83b7\u53d6\u6570\u636e\u5931\u8d25");p.push("")}return p.join("")}});define("template/sendbox/widget/chartletBtn",function(require){return function(tmplData){var p=[];with(tmplData){p.push("");var btnStatus=1,myPermission=json.myPermission,otherPermission=json.otherPermission,price=json.price,ta={1:"\u4ed6",2:"\u5979"}[sex];price===0?myPermission?btnStatus=6:btnStatus=5:!myPermission&&!otherPermission?btnStatus=1:myPermission&&!otherPermission?btnStatus=2:!myPermission&&otherPermission?btnStatus=3:myPermission&&otherPermission&&(btnStatus=4),isVipChartlet&&(myPermission?btnStatus=8:btnStatus=7);var buyType=0;p.push('<div class="winlayer-emoji-price text-dark-gray">'),isVipChartlet?(p.push(""),myPermission?p.push('<span class="text-red js-price"><em class="icon-v"></em>\u60a8\u662f\u82b1\u7530\u4f1a\u5458\uff0c\u53ef\u4f7f\u7528\u8be5\u8d34\u7eb8</span>'):p.push("\u5168\u5957",name,'\u8d34\u7eb8\uff1a<span class="text-red js-price">\u5f00\u901a\u4f1a\u5458\u65b9\u53ef\u4f7f\u7528</span>'),p.push("")):(p.push("\u5168\u5957",name,"\u8d34\u7eb8\uff1a"),price!==0?(p.push(""),buyType==1?p.push('<span class="text-red js-price">',json.rmb,"</span>\u5143"):p.push('<span class="text-red js-price">',price,"</span>\u4e2a\u82b1\u7530\u5e01(",json.rmb,"\u5143)"),p.push("")):p.push('<span class="text-red js-price">\u9650\u65f6\u514d\u8d39</span>'),p.push("")),p.push('</div><div class="winlayer-emoji-btnBox n-btn-box js-btnBox">'),btnStatus===1?p.push('<a class="btn btn-red buy-trigger" href="javascript:;">\u8d2d\u4e70\u4f7f\u7528</a><a class="btn btn-red buyfor-trigger" href="javascript:;">\u9001\u7ed9',ta,"</a>"):btnStatus===2?p.push('<span class="text-gray">\u53ef\u4f7f\u7528</span><a class="btn btn-red buyfor-trigger" href="javascript:;">\u9001\u7ed9',ta,"</a>"):btnStatus===3?p.push('<a class="btn btn-red buy-trigger" href="javascript:;">\u8d2d\u4e70\u4f7f\u7528</a><span class="text-gray n-ui-margin">\u5df2\u9001',ta,"</span>"):btnStatus===4?p.push('<span class="text-gray">\u53cc\u65b9\u53ef\u4f7f\u7528</span>'):btnStatus===5?p.push('<a class="btn btn-red get-trigger" href="javascript:;">\u514d\u8d39\u9886\u53d6</a>'):btnStatus===6?p.push('<span class="text-gray">\u5df2\u9886\u53d6</span>'):btnStatus===7?p.push('<a class="btn btn-red" href="/pay/services" target="_blank" data-log="stickerOpen">\u5f00\u901a\u4f1a\u5458</a>'):btnStatus===8&&p.push('<span class="text-gray">\u53ef\u4f7f\u7528</span>'),p.push("</div>")}return p.join("")}});define("template/sendbox/widget/emotion",function(require){return function(tmplData){var p=[];with(tmplData){p.push('<div class="winlayer winlayer-emoji"><a class="icon-close close-trigger" title="\u5173\u95ed" href="javascript:;"></a><em class="icon-winlayer-arrowUp js-arrowUp"></em><div class="winlayer-emoji-wrapper js-emotionCon"><div class="sliderBox winlayer-emoji-tab-sliderBox js-sliderBox"><a class="slider-prev disabled prev-trigger" href="javascript:;"><em class="icon-slider-prev-m">\u4e0a\u4e00\u9875</em></a><a class="slider-next next-trigger" href="javascript:;"><em class="icon-slider-next-m">\u4e0b\u4e00\u9875</em></a><div class="slider-content"><ul class="slider-list js-list" style="left: 0; width: 750px;"><li class="slider-item js-sliderItem"><ul class="winlayer-emoji-tab"><li class="js-tabItem" data-target="emoji-free"><a href="javascript:;" title="\u514d\u8d39\u8868\u60c5"><em class="icon-emoji-free">\u514d\u8d39\u8868\u60c5</em></a></li><li class="js-tabItem" data-target="emoji-xxy"><a href="javascript:;" title="\u718a\u5c0f\u6613"><em class="icon-emoji-xxy">\u718a\u5c0f\u6613</em></a></li><li class="js-tabItem" data-target="emoji-prx"><a href="javascript:;" title="\u76ae\u5c14\u718a"><em class="icon-emoji-prx">\u76ae\u5c14\u718a</em></a></li><li class="js-tabItem" data-target="emoji-ajmd"><a href="javascript:;" title="\u963f\u9e21\u7c73\u5fb7"><em class="icon-emoji-ajmd">\u963f\u9e21\u7c73\u5fb7</em></a></li><li class="js-tabItem" data-target="emoji-nn"><a href="javascript:;" title="\u599e\u599e"><em class="icon-emoji-nn">\u599e\u599e</em></a><em class="winlayer-emoji-tips-icon icon-v-tip"></em></li></ul></li><li class="slider-item js-sliderItem"><ul class="winlayer-emoji-tab"><li class="js-tabItem" data-target="emoji-chuck"><a href="javascript:;" title="Chuck"><em class="icon-emoji-chuck">Chuck</em></a><em class="winlayer-emoji-tips-icon icon-v-tip"></em></li><li class="js-tabItem" data-target="emoji-tmz"><a href="javascript:;" title="\u5154\u7f8e\u5179"><em class="icon-emoji-tmz">\u5154\u7f8e\u5179</em></a></li><li class="js-tabItem" data-target="emoji-devilfish"><a href="javascript:;" title="\u7ae0\u5c0f\u5446"><em class="icon-emoji-zxd">\u7ae0\u5c0f\u5446</em></a></li></ul></li></ul></div></div><div class="winlayer-emoji-free js-panel"><em class="winlayer-emoji-scrollbar-tips icon-scrollbar-tips hidden js-pageNum"><span class="js-page">1/1</span></em><div class="winlayer-emoji-scrollbar ui-scrollbar hidden js-scrollbar"></div><div class="winlayer-emoji-content js-container"><div class="winlayer-emoji-content-inner js-content"><ul class="winlayer-emoji-list clearfix"></ul></div></div><p class="winlayer-emoji-tips text-gray">\u63d0\u793a\uff1a\u6309',isMacOS?"Command":"Ctrl","\u53ef\u4ee5\u4e00\u6b21\u591a\u9009\u8868\u60c5</p></div>");var chartletConfig=[{className:"winlayer-emoji-xxy",name:"\u718a\u5c0f\u6613",desc:"\u4ed6\u662f\u7231\u5e7b\u60f3\u7231\u8868\u73b0\u7684\u5c0f\u767d\u718a\uff0c\u6709\u4e2a\u4eba\u82f1\u96c4\u4e3b\u4e49\u60c5\u7ed3\uff0c\u52aa\u529b\u60f3\u6210\u4e3a\u4f17\u4eba\u7684\u7126\u70b9\u3002\u4ed6\u4e50\u89c2\u5411\u4e0a\uff0c\u5de5\u4f5c\u52aa\u529b\uff0c\u4ed6\u538c\u5026\u5b64\u72ec\u6e34\u671b\u7231\u60c5\u964d\u4e34\u3002"},{className:"winlayer-emoji-prx",name:"\u76ae\u5c14\u718a",desc:"\u4e00\u53ea\u5355\u7eaf\u53ef\u7231\u4e14\u6d89\u4e16\u672a\u6df1\u7684\u5317\u6781\u718a\uff0c\u62e5\u6709\u5185\u5411\u3001\u7ec6\u817b\u7684\u4e2a\u6027\uff0c\u5411\u5f80\u7f8e\u597d\u7684\u751f\u6d3b\u3002"},{className:"winlayer-emoji-ajmd",name:"\u963f\u9e21\u7c73\u5fb7",desc:"\u7ecf\u5e38\u641e\u4e0d\u6e05\u72b6\u51b5\u7684\u795e\u7ecf\u8d28\u5c0f\u9e21\uff0c\u5bb9\u6613\u7126\u8651\u3001\u8df3\u8131\u7684\u601d\u8def\u4ece\u6765\u6ca1\u6709\u4eba\u80fd\u8ddf\u5f97\u4e0a\u3002"},{className:"winlayer-emoji-nn",name:"\u599e\u599e",desc:"\u963f\u9e21\u7c73\u5fb7\u7684\u7eef\u95fb\u5973\u53cb\uff0c\u4f20\u8bf4\u4e2d\u7684\u5973\u6c49\u5b50\uff0c\u98ce\u98ce\u706b\u706b\u72ec\u7acb\u575a\u5f3a\uff0c\u61c2\u5979\u7684\u4eba\u624d\u4f1a\u4e86\u89e3\u5979\u7684\u7ec6\u817b\u6e29\u67d4\u3002"},{className:"winlayer-emoji-chuck",name:"Chuck",desc:"\u6f6e\u4ebaChuck\u662f\u4e00\u4e2a\u666e\u901a\u5c0f\u767d\u9886\uff0c\u7231\u81ed\u5c41\u641e\u602a\uff0c\u4f46\u6e29\u67d4\u6d6a\u6f2b\u53c8\u8d34\u5fc3\uff0c\u4ed6\u7684\u751f\u6d3b\u603b\u662f\u5145\u6ee1\u9633\u5149\u4e0e\u4fe1\u5fc3\uff0c\u4e0e\u4ed6\u5728\u4e00\u8d77\u4f1a\u7279\u522b\u5feb\u4e50\u5e78\u798f\u3002"},{className:"winlayer-emoji-tmz",name:"\u5154\u7f8e\u5179",desc:"\u8033\u6735\u7cfb\u6210\u8774\u8776\u7ed3\u7684\u5c0f\u7f8e\u5154\uff0c\u7231\u72d7\u72d7\u3001\u7231\u8d2d\u7269\u3001\u4e5f\u7231\u7f8e\u98df\uff0c\u5927\u5bb6\u773c\u4e2d\u7684\u751c\u5fc3\u5c0f\u5b9d\u8d1d\u3002"},{className:"winlayer-emoji-devilfish",name:"\u7ae0\u5c0f\u5446",author:"\u5b59\u5c0f\u69d1",desc:"\u7ae0\u5c0f\u5446\u662f\u6761\u8def\u75f4\u5c0f\u7ae0\u9c7c\uff0c\u8155\u8db3\u592a\u591a\u7ecf\u5e38\u4f1a\u628a\u81ea\u5df1\u7eca\u5012\u3002\u5b83\u5584\u826f\u6015\u7f9e\uff0c\u53d7\u5230\u60ca\u5413\u4f1a\u6002\uff0c\u4f46\u5343\u4e07\u4e0d\u8981\u60f9\u6012\u5b83\uff0c\u5b83\u4f1a\u53d8\u6210\u7ea2\u8272\u7684\u7ae0\u9c7c\u5c0f\u4e38\u5b50\u3002"}];p.push("");for(var i=0,l=chartletConfig.length;i<l;i++)p.push('<div class="',chartletConfig[i].className+" ",'winlayer-emoji-chartlet emoji-locked js-panel"><em class="winlayer-emoji-scrollbar-tips icon-scrollbar-tips hidden js-pageNum"><span class="js-page">1/1</span></em><div class="winlayer-emoji-scrollbar ui-scrollbar hidden js-scrollbar"></div><div class="winlayer-emoji-content js-container"><div class="winlayer-emoji-content-inner js-content"><div class="winlayer-emoji-intro hidden js-intro"><span class="winlayer-emoji-title">',chartletConfig[i].name,"</span>"),chartletConfig[i].author&&p.push('<span class="text-gray">',chartletConfig[i].author,"\u521b\u4f5c</span>"),p.push('<p class="text-gray">',chartletConfig[i].desc,'</p></div><ul class="winlayer-emoji-list clearfix"></ul></div></div><div class="winlayer-emoji-ft js-foot"></div><p class="winlayer-emoji-tips text-gray">\u63d0\u793a\uff1a\u70b9\u51fb\u8d34\u7eb8\u53ef\u76f4\u63a5\u53d1\u9001</p></div>');p.push("</div></div>")}return p.join("")}});define("template/floatbox/messageBox",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="poplayer-bd"><div class="poplayer-sendMessage-addressee js-addressee">'),totalCount!==0&&p.push('<a class="fR link-blue" target="_blank" href="/messages/dm/',userId,'">\u5171',totalCount,"\u6761\u5bf9\u8bdd</a>"),p.push('<span class="text-gray">\u6536\u4ef6\u4eba\uff1a</span>',nickName,'</div><div class="publish-bd js-pub-bd"><div class="publish-textarea">'),defaultTip!==""&&p.push('<label class="js-default-tip">',defaultTip,"</label>"),p.push('<textarea></textarea><p class="message-send-tips text-middle-tips js-chartletSentTips hidden"><span class="text-dark-gray"><em class="icon-correct-m"></em>\u8d34\u7eb8\u5df2\u53d1\u9001\uff0c\u7ee7\u7eed\u804a\u5929\u5427</span></p></div><div class="publish-operate"><div class="publish-insert"><em class="icon-face emotion-trigger" title="\u8868\u60c5"></em></div><div class="publish-setTop">'),loginUser.isVip?loginUser.isNormalVip?p.push('<label class="label-tag"><input type="checkbox" disabled />\u5728',sexName,'\u6d88\u606f\u4e2d\u5fc3\u7f6e\u9876(<a class="text-red" href="/pay/services" target="_blank" data-log="dmUpOpen">\u5347\u7ea7\u9ad8\u7ea7VIP\u4f1a\u5458</a>\u514d\u8d39\u4f7f\u7528)</label>'):loginUser.isSuperVip&&p.push('<label class="label-tag"><input class="js-setTop" type="checkbox" checked="checked" />\u5728',sexName,"\u6d88\u606f\u4e2d\u5fc3\u7f6e\u9876(\u60a8\u53ef\u4ee5\u514d\u8d39\u4f7f\u7528)</label>"):p.push('<label class="label-tag"><input type="checkbox" disabled />\u5728',sexName,'\u6d88\u606f\u4e2d\u5fc3\u7f6e\u9876(<a class="text-red" href="/pay/services" target="_blank" data-log="dmUpOpen">\u5f00\u901a\u9ad8\u7ea7VIP\u4f1a\u5458</a>\u514d\u8d39\u4f7f\u7528)</label>'),p.push('</div></div></div></div><div class="poplayer-ft"><div class="publish-ft n-send-ft"><div class="publish-btn n-btn-box js-btn"><div class="js-btn-txt disabled"><a class="btn btn-red n-btn-sure submit-trigger" href="javascript:;">\u53d1\u9001</a></div></div><span class="publish-count js-wordCounter"><b class="char-constantia">400</b>\u5b57</span></div></div>');return p.join("")}});define("widget/box/floatBox/FeedbackBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/box/floatBox/Box"),f=a("sendbox/FeedbackSendBox"),g=a("widget/box/floatBox/TipsBox"),h=a("utils/tmpl"),i=e.extend({preRender:function(){var b=d.extend({},this.data);return{title:"\u82b1\u7530\u610f\u89c1\u53cd\u9988",bodyContent:h.formatTemplate(a("template/floatbox/feedbackBox"),b)}},bindEvent:function(){this._super(),this.$elem.bind("message:send:success",d.proxy(this.onSuccess,this))},postRender:function(){this.$elem.addClass("poplayer-feedback"),this._super();var a={data:{userId:this.data.userId},isAutoHeight:!0,maxLen:250},b=new f(this.$elem,a);b.render(),this.feedbackSendBox=b},onSuccess:function(a,b){this.hide();var c=new g(null,{data:{type:"correct",text:"\u53d1\u9001\u6210\u529f\uff01"}});c.show(),c.delayHide(1500)},hide:function(){var a=this.feedbackSendBox.emotion;a.isShow&&a.hide(),this._super()}});return i});define("sendbox/FeedbackSendBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("sendbox/MessageSendBox"),f=a("sendbox/SendBoxAction"),g=a("utils/Log"),h=a("utils/Utils"),i=e.extend({postRender:function(){this._super(),this.$feedbackType=this.$elem.find(".js-type"),this.$phone=this.$elem.find(".js-phone"),this.$tips=this.$elem.find(".js-phoneTips")},bindEvent:function(){this._super(),this.$phone.bind("focus",d.proxy(this.onMobileFocus,this)),this.$phone.bind("blur",d.proxy(this.onMobileBlur,this)),this.$phone.bind("paste cut input keyup",d.proxy(this.onCheckInput,this)),this.$feedbackType.bind("change",d.proxy(this.onCheckInput,this))},onMobileFocus:function(){h.textTips(this.$tips,"hide")},onMobileBlur:function(a){this.checkPhoneVal()||h.textTips(this.$tips,"error","\u8054\u7cfb\u65b9\u5f0f\u683c\u5f0f\u4e0d\u6b63\u786e")},checkPhoneVal:f.checkPhoneVal,checkInputVal:function(){var a=d.trim(this.$textarea.val());if(a.length===0||this.wordCounter.isError)return!1;if(this.$feedbackType&&this.$feedbackType.size()&&parseInt(this.$feedbackType.val())===0)return!1;if(this.$phone&&this.$phone.size()&&!this.checkPhoneVal())return!1;return!0},parseParams:function(){var a={withUserId:this.data.userId,content:this.concatContent()};return a},concatContent:function(){var a=d.trim(this.$phone.val()),b="#"+i.FEEDBACK_TEXT[this.$feedbackType.val()]+"#";a&&(b+=" \u8054\u7cfb\u65b9\u5f0f\uff1a"+a),b+=" \u53cd\u9988\u5185\u5bb9\uff1a"+d.trim(this.$textarea.val());return b}});i.FEEDBACK_TEXT={1:"\u5145\u503c\u8d2d\u4e70",2:"\u5934\u50cf\u95ee\u9898",3:"\u4e2a\u4eba\u8d44\u6599",4:"\u7528\u6237\u4e92\u52a8",5:"\u5e10\u53f7\u76f8\u5173",6:"\u4ea4\u53cb\u5b89\u5168",7:"\u5176\u4ed6\u610f\u89c1"};return i});define("template/floatbox/feedbackBox",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="poplayer-bd"><p class="text-gray">Hi,\u5c0f\u7ea2\u5a18\u7167\u987e\u4e0d\u5468\u6df1\u8868\u6b49\u610f\u3002\u5982\u679c\u60a8\u5728\u4f7f\u7528\u82b1\u7530\u8fc7\u7a0b\u4e2d\u9047\u5230\u95ee\u9898\u6025\u9700\u89e3\u51b3\uff0c\u53ef\u4ee5\u5148\u67e5\u770b<a target="_blank" class="text-problems" href="/help/faq">\u82b1\u7530\u5e38\u89c1\u53cd\u9988\u95ee\u9898</a>\u5bfb\u627e\u7b54\u6848</p><div class="form-row js-row"><label class="form-label" for=""><span class="form-need">*</span>\u53cd\u9988\u95ee\u9898\u7c7b\u522b\uff1a</label><div class="form-control"><select class="form-select js-type"><option value="0" selected="">\u8bf7\u9009\u62e9</option><option value="1">\u5145\u503c\u8d2d\u4e70</option><option value="2">\u5934\u50cf\u95ee\u9898</option><option value="3">\u4e2a\u4eba\u8d44\u6599</option><option value="4">\u7528\u6237\u4e92\u52a8</option><option value="5">\u5e10\u53f7\u76f8\u5173</option><option value="6">\u4ea4\u53cb\u5b89\u5168</option><option value="7">\u5176\u4ed6\u610f\u89c1</option></select></div></div><div class="form-row js-row"><label class="form-label" for=""><span class="form-need-hidden">*</span>\u60a8\u7684\u8054\u7cfb\u7535\u8bdd\uff1a</label><div class="form-control"><input class="form-input js-phone" type="text" placeholder="\u65b9\u4fbf\u5c0f\u7ea2\u5a18\u4e0e\u4f60\u8054\u7cfb" /></div><div class="form-tips"><span class="text-icon-tips hidden js-phoneTips"></span></div></div><div class="form-row js-row"><label class="form-label-block"><span class="form-need">*</span>\u95ee\u9898\u63cf\u8ff0<span class="text-gray">(\u4e3a\u4e86\u5c0f\u7ea2\u5a18\u66f4\u5feb\u901f\u89e3\u51b3\u60a8\u7684\u95ee\u9898\uff0c\u8bf7\u5c3d\u91cf\u63d0\u4f9b\u8be6\u5b9e\u63cf\u8ff0)</span></label><div class="form-control"><textarea></textarea></div><div class="poplayer-feedback-tips js-wordCounter"><b class="char-constantia">250</b>\u5b57</div></div></div><div class="poplayer-ft"><div class="poplayer-btn n-btn-box js-btn"><div class="js-btn-txt disabled"><a class="btn btn-red n-btn-sure submit-trigger" href="javascript:;">\u63d0\u4ea4</a></div></div></div>');return p.join("")}});define("widget/box/floatBox/ConfirmBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("utils/tmpl"),f=a("widget/box/floatBox/Box"),g=f.extend({preRender:function(){return{title:this.config.title||"\u8bf7\u786e\u8ba4\u64cd\u4f5c",bodyContent:e.formatTemplate(a("template/floatbox/confirmBox"),this.data)}},postRender:function(){this._super(),this.$elem.addClass("poplayer-confirmBox")},bindEvent:function(){this._super(),this.$elem.delegate(".submit-trigger","click",d.proxy(this.onConfirm,this))},hide:function(a){this._super(),a&&this.config.callBack&&this.config.callBack({status:"cancel"},a)},onConfirm:function(a){this.hide(),this.config.callBack&&this.config.callBack({status:"ok"},a);return!1}});return g});define("template/floatbox/confirmBox",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="poplayer-bd"><div class="poplayer-messbox"><span class="poplayer-mess">'),type=="warning"?p.push('<em class="icon-warning-b"></em>'):type=="correct"?p.push('<em class="icon-correct-b"></em>'):type=="error"&&p.push('<em class="icon-error-b"></em>'),p.push("",content,"</span></div>"),typeof desc!="undefined"&&desc!==""&&p.push('<p class="poplayer-desc">',desc,"</p>"),p.push('</div><div class="poplayer-ft"><div class="poplayer-btn"><a class="btn btn-red submit-trigger" href="javascript:;">'),typeof submitBtnText!="undefined"?p.push("",submitBtnText,""):p.push("\u786e\u8ba4"),p.push("</a>"),typeof isHideCancel!="undefined"&&!isHideCancel&&(p.push('<a class="btn btn-gray close-trigger" href="javascript:;">'),typeof cancelBtnText!="undefined"?p.push("",cancelBtnText,""):p.push("\u53d6\u6d88"),p.push("</a>")),p.push("</div></div>");return p.join("")}});define("task/widget/needLogin",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("task/basic/Task"),f=d(document.body);(new e("needLogin",function(){var b=a("model/UserData");b.getLoginUser()===null&&f.delegate(".need-login","click",function(a){a.preventDefault(),f.trigger("error",["needLogin"])})})).add()});define("task/widget/logger",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("task/basic/Task");(new e("keyFromLogger",function(){var b=a("utils/Log");d(document.body).delegate("a[href]","click",function(a){var c=d(a.currentTarget),e=c.attr("href");if(e.indexOf("javascript")===-1){var f=c.data("method");f=f||"",b.doLog({parameter:{method:f},elem:c})}}),b.send("/page.do?_page="+b.keyFrom("body"))})).add()});define("task/widget/global",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("task/basic/Task"),f=a("user/UserAction"),g=a("model/UserData"),h=a("widget/box/floatBox/PicUploadBox"),i=a("widget/box/floatBox/LetterBox"),j=a("utils/Log"),k=d(document.body);(new e("globalListen",function(){k.delegate(".g-upload-photo-trigger","click",function(a){(new h).show(a)}),k.delegate(".g-upload-letter-trigger","click",function(a){i.getInstance(null,null).show(),a&&j.doLog({parameter:{method:"loadLetter"},elem:d(a.target)})}),k.delegate(".g-upgradeVip-trigger","click",function(a){if(g.getLoginUser()!==null){f.upgradeVip(a);var b=d(a.currentTarget);j.doLog({parameter:{method:"toupgradesvip"},elem:b})}})})).add()});define("user/UserAction",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("utils/DataSource"),f=a("utils/Utils"),g=d(document.body),h=a("utils/Error"),i=a("widget/tips/FastTips"),j=a("model/UserData"),k=a("utils/Log"),l=a("widget/box/introBox/DisLikeBox").getInstance(),m=a("widget/box/floatBox/BuyServiceBox"),n=a("widget/box/introBox/CautionBox").getInstance(),o=a("utils/Cookie"),p=a("widget/box/winBox/TipsBox").getInstance(),q={doLike:function(a,b){if(!d.isPlainObject(this.doLikeRequest)||this.doLikeRequest.readyState===4){var c=this,l=d(a.currentTarget),m=l.parents(".js-like").first();this.doLikeRequest=e.setTrigger(m).postJSON("addFav",{userId:b.id},function(c){var d=parseInt(c.code)||1;if(!h.Tips(d,a)){var e=null;if(d===1){g.trigger("fav:fetch"),j.update({id:b.id,following:!0});if(j.loginUserIsSuperVip||c.isBought===1)i.show({$trigger:m,type:"success",text:"\u5df2\u559c\u6b22"+f.userSexName(b.sex)+"\uff01"});else{var k="";j.loginUserIsVip?j.loginUserIsNormalVip&&(k="\u5347\u7ea7\u4f1a\u5458"):k="\u5f00\u901a\u4f1a\u5458",e={icon:"correct",title:"\u60a8\u5df2\u559c\u6b22TA\uff01",desc:"\u5f00\u901a\u9ad8\u7ea7VIP\u4f1a\u5458\u53ef\u6536\u5230\u559c\u6b22\u4eba\u7684\u4e0a\u7ebf\u63d0\u9192\uff0c\u4e0d\u8981\u9519\u8fc7TA\u7684\u6d88\u606f\u3002",btnLog:"likeNotice",buttonText:k,buttonLink:"/pay/services"},n.show(a,{icon:"warning",data:e})}l.trigger("like:success",[c])}else d===421&&(j.loginUserIsVip?j.loginUserIsSuperVip||(e={icon:"warning",title:"\u60a8\u5df2\u8fbe\u5230\u559c\u6b22\u4eba\u6570\u4e0a\u9650\uff0c\u65e0\u6cd5\u559c\u6b22TA",desc:"\u5347\u7ea7\u4f1a\u5458\uff0c\u559c\u6b22\u4eba\u6570\u53ef\u6269\u5145\u52303000\u4eba",btnLog:"likeLimit",buttonText:"\u5347\u7ea7\u4f1a\u5458",buttonLink:"/pay/services"}):e={icon:"warning",title:"\u60a8\u5df2\u8fbe\u5230\u559c\u6b22\u4eba\u6570\u4e0a\u9650\uff0c\u65e0\u6cd5\u559c\u6b22TA",desc:"\u5f00\u901a\u9ad8\u7ea7VIP\u82b1\u7530\u4f1a\u5458\uff0c\u559c\u6b22\u4eba\u6570\u53ef\u6269\u5145\u52303000\u4eba",btnLog:"likeLimit",buttonText:"\u5f00\u901a\u4f1a\u5458",buttonLink:"/pay/services"}),d===422&&(e={icon:"warning",title:"\u60a8\u5df2\u8fbe\u5230\u559c\u6b22\u4eba\u6570\u4e0a\u9650\uff0c\u65e0\u6cd5\u559c\u6b22TA",desc:"\u6700\u591a\u53ea\u80fd\u559c\u6b223000\u4eba",btnLog:"likeLimit",buttonText:"\u67e5\u770b\u559c\u6b22\u7684\u4eba",buttonLink:"/following"}),e!==null&&n.show(a,{data:e})}}),k.doLog({parameter:{method:"fav"},elem:l});return}},doCancelLike:function(a,b){if(!d.isPlainObject(this.cancelLikeRequest)||this.cancelLikeRequest.readyState===4){var c=this,l=d(a.currentTarget),m=l.parents(".js-like").first();this.cancelLikeRequest=e.setTrigger(m).postJSON("cancelFav",{userId:b.id},function(c){var d=parseInt(c.code)||1;h.Tips(d,a)||(g.trigger("unfav:fetch"),i.show({$trigger:m,type:"success",text:"\u5df2\u4e0d\u518d\u559c\u6b22"+f.userSexName(b.sex)+"\uff01"}),j.update({id:b.id,following:!1}),l.trigger("cancellike:success"))}),k.doLog({parameter:{method:"disFav"},elem:l});return}},doDisLike:function(a,b){var c=this;l.show(a,{autoClose:!0,data:{user:b},target:this}),k.doLog({parameter:{method:"hide"},elem:d(a.currentTarget)});return},doUndislike:function(a,b){if(!d.isPlainObject(this.unDislikeRequest)||this.unDislikeRequest.readyState===4){var c=this,f=d(a.currentTarget);this.unDislikeRequest=e.setTrigger(f).postJSON("unDislike",{userId:b.id},function(a){h.showTips({json:a})||(i.show({$trigger:f,type:"success",text:"\u5df2\u79fb\u9664\u8be5\u4e0d\u559c\u6b22\u7684\u4eba"}),j.update({id:b.id,dislike:!1}),c.$elem.trigger("unDislike:success"))});return}},doSayHi:function(a,b){if(!d.isPlainObject(this.doSayHiRequest)||this.doSayHiRequest.readyState===4){var c=this,f=d(a.currentTarget);this.doFavRequest=e.setTrigger(f).postJSON("sayHi",{userId:b},function(b){var d=parseInt(b.code,10)||1;h.Tips(d,a)||c.onSayHi()}),k.doLog({parameter:{method:"sayhi"},elem:f});return}},onSayHi:function(){this.$elem.find(".sayhi-trigger").removeClass("btn-sayhi sayhi-trigger").addClass("btn-sayhi-disable").attr("title","\u5df2\u6253\u62db\u547c").html("\u5df2\u6253\u62db\u547c")},doSayHiNew:function(a,b){if(!d.isPlainObject(this.doSayHiRequest)||this.doSayHiRequest.readyState===4){var c=this,f=d(a.currentTarget);this.doFavRequest=e.setTrigger(f).postJSON("sayHi",{userId:b},function(b){var d=parseInt(b.code)||1;h.Tips(d,a)||c.onSayHiNew()}),k.doLog({parameter:{method:"sayhi"},elem:f});return}},onSayHiNew:function(){throw"Abstract Method!!!"},upgradeVip:function(a){var b=new m(null,{service:"upgradevip",successCallBack:function(){location.reload()}});b.show()}};return q});define("widget/tips/FastTips",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/Utils"),g=e.extend({init:function(a,b){this.$elem=null,this.data=a,this.config=b,this._timer=null},render:function(){this.$elem=d('<div class="fast-tips js-top-tips"></div>').appendTo("body");return this.$elem},show:function(a,b,c){this.$elem===null&&this.render();!c||c===""?this.$elem.hide():(this.$triggerElem=a,this._timer&&clearTimeout(this._timer),b=b||"success",b==="error"?c='<div class="fast-tips-inner"><p class="text-middle-tips"><span class="fS14"><em class="icon-error-m"></em>'+c+"</span></p></div>":c='<div class="fast-tips-inner"><p class="text-middle-tips"><span class="fS14"><em class="icon-correct-m"></em>'+c+"</span></p></div>",this.$elem.html(c),this.setPosition(),this.onTimerClose())},onTimerClose:function(){var a=this;this._timer=setTimeout(function(){a.onHide()},2e3)},onHide:function(){var a=this;this.$elem.stop().animate({duration:600,easing:"easeInOutExpo",height:0,marginTop:0},function(){a.$elem.hide()})},setPosition:function(){var a=this.$triggerElem.offset();this.$elem.css({display:"block",top:a.top,left:a.left-this.$elem.width()/2+this.$triggerElem.width()/2,height:0,marginTop:0});var b=this.$elem[0].scrollHeight;this.$elem.stop().animate({duration:600,easing:"easeInOutExpo",height:b,marginTop:"-"+(b+5)+"px"})}}),h=null;return{getInstance:function(){h==null&&(h=new g);return h},show:function(a,b){d.isPlainObject(arguments[0])?this.getInstance().show(arguments[0].$trigger,arguments[0].type,arguments[0].text):this.getInstance().show($trigger,a,b)}}});define("widget/box/introBox/DisLikeBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/box/introBox/Box"),f=a("utils/tmpl"),g=a("utils/Utils"),h=a("utils/DataSource"),i=a("model/UserData"),j=a("widget/box/introBox/CautionBox").getInstance(),k=a("utils/Error"),l=d(document.body),m=e.extend({preRender:function(){return{bodyContent:f.formatTemplate(a("template/introbox/disLike"),{})}},postRender:function(){this._super(),this.$elem.addClass("introlayer-dislike"),this.$inputElems=this.$elem.find("input"),this.$btnAreaElem=this.$elem.find(".n-btn-box").find(".js-btn"),this.$arrowElem=this.$elem.find(".js-arrow")},bindEvent:function(){this._super(),this.$elem.delegate("input","click",d.proxy(this.onSelectVal,this)),this.$elem.delegate(".submit-trigger","click",d.proxy(this.onSubmit,this))},reset:function(){this.$elem.find("input").attr("checked",!1),this.disableBtn()},postShow:function(){this.$elem.find(".js-sexName").html(g.userSexName(this.data.user.sex))},setPosition:function(){var a=this.$trigger.offset(),b=this.$trigger.data("direction");b==="left"?(this.$arrowElem.css({left:238}),this.$mainElem.css({top:a.top+this.$trigger.innerHeight()+10,left:a.left-this.$mainElem.innerWidth()+36+this.$trigger.innerWidth()/2})):(this.$arrowElem.css({left:20}),this.$mainElem.css({top:a.top+this.$trigger.innerHeight()+10,left:a.left-10}))},onSelectVal:function(a){this.onSetBtnStatus(),this.onCheckVal(a)},onSetBtnStatus:function(){this.$inputElems.filter(":checked").size()===0?this.disableBtn():this.enableBtn()},onCheckVal:function(a){},onSubmit:function(){if(!(!this.isValid||d.isPlainObject(this.request)&&this.request.readyState!==4)){var a=this.parseParams(),b=this;g.btnSending.call(this,this.$elem.find(".submit-trigger")),this.request=h.postJSON("addShield",a,function(a){g.btnSended.call(b,b.$elem.find(".submit-trigger"));var c=parseInt(a.code)||1;if(!k.Tips(c))if(c===1)b.onSuccess();else{var d=null;c===423&&(i.loginUserIsVip?i.loginUserIsSuperVip||(d={icon:"warning",title:"\u60a8\u5df2\u8fbe\u5230\u4e0d\u559c\u6b22\u4eba\u6570\u4e0a\u9650",desc:"\u5347\u7ea7\u4f1a\u5458\uff0c\u4e0d\u559c\u6b22\u4eba\u6570\u53ef\u6269\u5145\u52305000\u4eba",btnLog:"dislikeLimit",buttonText:"\u5347\u7ea7\u4f1a\u5458",buttonLink:"/pay/services"}):d={icon:"warning",title:"\u60a8\u5df2\u8fbe\u5230\u4e0d\u559c\u6b22\u4eba\u6570\u4e0a\u9650",desc:"\u5f00\u901a\u9ad8\u7ea7VIP\u82b1\u7530\u4f1a\u5458\uff0c\u4e0d\u559c\u6b22\u4eba\u6570\u53ef\u6269\u5145\u52305000\u4eba",btnLog:"dislikeLimit",buttonText:"\u5f00\u901a\u4f1a\u5458",buttonLink:"/pay/services"}),c===424&&(d={icon:"warning",title:"\u60a8\u5df2\u8fbe\u5230\u4e0d\u559c\u6b22\u4eba\u6570\u4e0a\u9650",desc:"\u6700\u591a\u53ea\u80fd\u4e0d\u559c\u6b225000\u4eba",btnLog:"dislikeLimit",buttonText:"\u67e5\u770b\u4e0d\u559c\u6b22\u7684\u4eba",buttonLink:"/dislike"}),b.hide(),d!==null&&j.show(null,{triggerElem:b.$trigger,data:d})}})}},parseParams:function(){var a={};a.userId=this.data.user.id,a.reason=this.$inputElems.filter(":checked").val();return a},onSuccess:function(){this.hide(),this.config.target.$elem.trigger("dislike:success",[this.config.target])},enableBtn:function(){this.$btnAreaElem.removeClass("disabled"),this.isValid=!0},disableBtn:function(){this.$btnAreaElem.addClass("disabled"),this.isValid=!1}}),n=null;return{getInstance:function(){n===null&&(n=new m);return n}}});define("widget/box/introBox/Box",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/box/Box"),f=a("utils/Utils"),g=a("utils/tmpl"),h=d(document.body),i=e.extend({init:function(a,b){this._super(a,b),this.isBindAutoClose=!1},preRender:function(){return{}},renderTmpl:function(b){return d(g.formatTemplate(a("template/introbox/basic"),b))},postRender:function(){this.$markElem=this.$elem.find(".js-mask"),this.$iframeElem=this.$elem.find(".js-iframe"),this.isIe6=this.$iframeElem.size()===0?!0:!1,this.$mainElem=this.$elem.find(".js-main")},show:function(a,b){this._super(),b&&(d.extend(this.config,b),b.data&&d.extend(this.data,b.data)),this.isBindAutoClose&&this.unBindAutoClose(),b&&b.triggerElem?this.$trigger=this.config.triggerElem:typeof a!="undefined"&&a!==null&&(this.$trigger=d(a.currentTarget)),this.hideCallBack=this.config.hideCallBack,!this.isBindAutoClose&&this.config.autoClose&&(this.autoClose=f.autoClose.call(this),this.isBindAutoClose=!0),this.postShow(),this.setPosition();return},postShow:function(){this.config.isShowMaskLayer&&this.$elem.css("zIndex",1e3)},hide:function(){this.reset(),this.hideCallBack&&this.hideCallBack(),this.config.autoClose&&this.unBindAutoClose(),this._super()},unBindAutoClose:function(){h.unbind("click",this.autoClose),this.isBindAutoClose=!1},reset:function(){}});return i});define("template/introbox/basic",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="introlayer"><table class="introlayer-table js-main"><tbody><tr><td class="introlayer-top-left"></td><td class="introlayer-top-center"></td><td class="introlayer-top-right"></td></tr><tr><td class="introlayer-middle-left"></td><td class="introlayer-middle-center"><div class="introlayer-body js-body">',bodyContent,'</div></td><td class="introlayer-middle-right"></td></tr><tr><td class="introlayer-bottom-left"></td><td class="introlayer-bottom-center"></td><td class="introlayer-bottom-right"></td></tr></tbody></table></div>');return p.join("")}});define("widget/box/introBox/CautionBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("utils/Utils"),f=a("widget/box/introBox/Box"),g=a("utils/tmpl"),h=d(document.body),i=d(window),j=f.extend({init:function(a,b){this._super(a,b),this.config.autoClose=!0},preRender:function(){return{bodyContent:'<div class="introlayer-main"><em class="introlayer-arrow-down js-arrow"></em><div class="js-content"></div></div>'}},renderModuleTmpl:function(){var b=d.extend({},this.data);b.isShowClose=typeof this.config.isShowClose!="undefined"?this.config.isShowClose:!0;return g.formatTemplate(a("template/introbox/cautionbox"),b)},postRender:function(){this._super(),this.$elem.addClass("introlayer-cautionBox")},postShow:function(){this.$elem.find(".js-content").html(d(this.renderModuleTmpl()))},setPosition:function(){var a=this.$trigger.offset(),b=this.$elem.find(".js-arrow");this.$mainElem.css({left:a.left-(b.position().left+b.width()/2)+this.$trigger.width()/2+6});var c=i.scrollTop(),e=d("#header").height();a.top-c-e>this.$mainElem.height()?(b[0].className="introlayer-arrow-down js-arrow",this.$mainElem.css({top:a.top-this.$mainElem.innerHeight()-10})):(b[0].className="introlayer-arrow-up js-arrow",this.$mainElem.css({top:a.top+this.$trigger.innerHeight()+12}))}}),k=null;return{getInstance:function(a,b){k===null&&(k=new j(a,b));return k}}});define("template/introbox/cautionbox",function(require){return function(tmplData){var p=[];with(tmplData){p.push("");var icons={correct:"icon-correct-m",warning:"icon-warning-m"},className=typeof icon!="undefined"&&icons[icon]?icons[icon]:icons.correct,dataLog=typeof btnLog!="undefined"&&btnLog?'data-log="'+btnLog+'"':"";p.push("<div ",dataLog,">"),isShowClose&&p.push('<a class="introlayer-close icon-close close-trigger" title="\u5173\u95ed" href="javascript:;"></a>'),p.push('<h3 class="introlayer-cautionBox-title"><em class="',className,'"></em><span>',title,'</span></h3><p class="introlayer-cautionBox-desc">',desc,'</p><div class="introlayer-ft n-btn-box"><div class="js-btn"><a class="btn btn-red click-trigger" target="_blank" href="',buttonLink,'">',buttonText,'</a><a class="btn btn-gray close-trigger" href="javascript:;">\u4ee5\u540e\u518d\u8bf4</a></div></div></div>')}return p.join("")}});define("template/introbox/disLike",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="introlayer-main"><em class="introlayer-arrow-up js-arrow"></em><a class="introlayer-close icon-close close-trigger" title="\u5173\u95ed" href="javascript:;"></a><h3 class="introlayer-feedGuide-title">\u4e0d\u559c\u6b22<span class="js-sexName"></span>\uff1f\u9009\u62e9\u7406\u7531\u8ba9\u63a8\u8350\u66f4\u51c6\uff01</h3><ul class="introlayer-labelList"><li><label class="label-tag"><input type="radio" name="unLikeReason" value="1" />\u5f62\u8c61</label></li><li><label class="label-tag"><input type="radio" name="unLikeReason" value="2" />\u5de5\u4f5c\u884c\u4e1a</label></li><li><label class="label-tag"><input type="radio" name="unLikeReason" value="3" />\u751f\u6d3b\u5a5a\u604b\u89c2</label></li><li><label class="label-tag"><input type="radio" name="unLikeReason" value="4" />\u8d44\u6599\u771f\u5b9e\u6027</label></li><li><label class="label-tag"><input type="radio" name="unLikeReason" value="5" />\u5176\u4ed6</label></li></ul><div class="introlayer-ft n-btn-box"><div class="js-btn disabled"><a class="btn btn-red n-btn-sure submit-trigger" data-loadingtext="\u63d0\u4ea4\u4e2d..." href="javascript:;">\u786e\u5b9a\u4e0d\u559c\u6b22</a>&nbsp;&nbsp;<a class="btn btn-gray close-trigger" href="javascript:;">\u53d6\u6d88</a></div></div></div>');return p.join("")}});define("widget/box/floatBox/BuyServiceBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/box/floatBox/BasicConfirmBox"),f=a("widget/box/floatBox/BuyConfirmBox"),g=a("utils/tmpl"),h=a("utils/Error"),i=a("utils/DataSource"),j=a("utils/Log"),k=a("model/UserData"),l=e.extend({defaults:{isBlankTab:!1},init:function(a,b){this._super(a,b),this.config=d.extend({},this.defaults,b),this.data=this.config.data||{},this.serviceData=d.extend({},l.SERVICES_INFO_DEFAULT,l.SERVICES_INFO[this.config.service])},parseData:function(){var a=this.data;this.serviceData.btnText&&(a.btnText=this.serviceData.btnText());return a},preRender:function(){return{title:this.serviceData.title,bodyContent:g.formatTemplate(a("template/floatbox/buyServiceBox"),this.parseData())}},postRender:function(){this._super(),this.$elem.addClass("poplayer-buy")},bindEvent:function(){this._super(),this.$elem.delegate(".submit-trigger","click",d.proxy(this.onSubmit,this))},checkValid:function(){this.$inputElems.filter(":checked").size()===0?this.disableBtn():this.enableBtn()},show:function(){this._super();var a=this;setTimeout(function(){a.loadData()},300)},loadData:function(){var a=this,b=this.serviceData;i.postJSON(b.url,b.seriviceParam,function(b){if(b&&b.code===1){var c=d.extend({loginUser:k.getLoginUser(),itemType:a.serviceData.itemType},b);a.renderServiceContent(c),a.data=b,a.checkValid()}})},renderServiceContent:function(b){this.$contentElem.removeClass("poplayer-buy-loading").html(g.formatTemplate(a("template/floatbox/serviceContent"),b)),this.$inputElems=this.$contentElem.find(".js-list input[type=radio]")},onSubmit:function(){if(!(!this.isValid||d.isPlainObject(this.request)&&this.request.readyState!==4)){var a=this.parseParams(),b=this;this.request=i.postJSON(this.serviceData.dealUrl,a,function(a){a&&a.status===1&&(b.hide(),b.onSuccess(a))}),j.doLog({parameter:{method:"tobuy"+b.config.service},elem:"body"})}},parseParams:function(){var a={},b=this.$inputElems.filter(":checked");a.serviceId=b.val();return a},onSuccess:function(a){var b=new f(null,{data:a.payInfo.dealInfo,userAccount:a.payInfo.userAccount,isBlankTab:this.config.isBlankTab,logName:this.config.service,successText:this.config.successText,successCallBack:d.proxy(this.buySuccess,this),redirectCallBack:d.proxy(this.buyRedirect,this)});b.show()},buySuccess:function(a){this.config.successCallBack&&this.config.successCallBack(a)},buyRedirect:function(){this.config.redirectCallBack&&this.config.redirectCallBack()}});l.SERVICES_INFO={visitor:{title:"\u5168\u90e8\u8bbf\u5ba2\u7279\u6743",url:"visitBuy"},superShow:{title:"\u8d85\u7ea7\u5c55\u793a\u7279\u6743",url:""},onlineremind:{title:"\u4e0a\u7ebf\u63d0\u9192\u7279\u6743",url:"informBuy"},singlesDay:{title:"\u82b1\u7530\u5bf9-\u63d0\u524d\u8131\u5355\u5149\u68cd\u8282\u6d3b\u52a8\u4ea4\u8d39",url:"singlesDayBuy"},vip:{title:"\u5f00\u901aVIP\u4f1a\u5458",url:"vipBuy",itemType:"vip",btnText:function(){return k.getLoginUser().isNormalVip?"\u7acb\u5373\u7eed\u8d39":"\u7acb\u5373\u5f00\u901a"},seriviceParam:{serviceType:7}},svip:{title:"\u5f00\u901a\u9ad8\u7ea7VIP\u4f1a\u5458",url:"vipBuy",itemType:"vip",btnText:function(){var a="\u7acb\u5373\u5f00\u901a";k.getLoginUser().isNormalVip?a="\u7acb\u5373\u5347\u7ea7":k.getLoginUser().isSuperVip&&(a="\u7acb\u5373\u7eed\u8d39");return a},seriviceParam:{serviceType:8}},upgradevip:{title:"\u5347\u7ea7\u9ad8\u7ea7VIP\u4f1a\u5458",url:"upgradeVip",itemType:"vip",btnText:function(){return"\u7acb\u5373\u5347\u7ea7"},dealUrl:"createUpgradeDeal"}},l.SERVICES_INFO_DEFAULT={title:"",url:"",dealUrl:"createNewDeal",seriviceParam:{}};return l});define("widget/box/floatBox/BasicConfirmBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/box/floatBox/Box"),f=a("utils/tmpl"),g=a("utils/Utils"),h=a("utils/Error"),i=a("utils/DataSource"),j=a("utils/Log"),k=e.extend({postRender:function(){this._super(),this.isValid=!1,this.$btnAreaElem=this.$elem.find(".n-btn-box").find(".js-btn"),this.$contentElem=this.$elem.find(".js-content")},checkValid:function(){},enableBtn:function(){this.$btnAreaElem.removeClass("disabled"),this.isValid=!0},disableBtn:function(){this.$btnAreaElem.addClass("disabled"),this.isValid=!1}});return k});define("template/floatbox/buyServiceBox",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="poplayer-bd js-content poplayer-buy-loading"><div class="loadingBox"><span><em class="icon-loadingB"></em>\u6570\u636e\u83b7\u53d6\u4e2d...</span></div></div><div class="poplayer-ft n-btn-box">'),typeof cautionText!="undefined"&&cautionText&&p.push('<p class="poplayer-buy-caution">',cautionText,"</p>"),p.push('<div class="poplayer-btn js-btn disabled"><a class="btn btn-red n-btn-sure submit-trigger" href="javascript:;">',btnText,"</a></div></div>");return p.join("")}});define("template/floatbox/serviceContent",function(require){return function(tmplData){var p=[];with(tmplData){p.push(""),typeof description!="undefined"&&description!==""&&p.push('<p class="poplayer-mt">',description,"</p>"),p.push('<ul class="js-list">');if(typeof list!="undefined"&&list.length){p.push("");for(var i=0,l=list.length;i<l;i++){var item=list[i];p.push('<li><input id="service',item.id,'" class="form-radio" name="serviceId" value="',item.id,'" type="radio"'),item.isDef&&p.push('checked="checked"'),p.push('><label class="form-radio-label" for="service',item.id,'">'),item.introduction!=="undefined"&&p.push("",item.introduction,""),p.push("</label>"),list[0].buyType==1?(p.push(""),typeof item.rmb!="undefined"&&"rmb"in item&&p.push('<span class="poplayer-buy-rmb"><em></em><b class="text-red">',item.rmb,"</b>\u5143</span>"),p.push("")):(p.push('<span class="poplayer-buy-price"><b class="text-red">',item.amount,"</b>\u4e2a\u82b1\u7530\u5e01</span>"),item.amount!=item.originalPrice&&p.push('&nbsp;<del class="poplayer-buy-originalPrice">\u539f\u4ef7',item.originalPrice,"</del>"),p.push(""),typeof item.discountTips!="undefined"&&item.discountTips!==""&&p.push('<span class="poplayer-visitorLimit-gift"><em></em>',item.discountTips,"</span>"),p.push(""),typeof item.rmb!="undefined"&&"rmb"in item&&p.push('<span class="poplayer-buy-rmb"><em></em>(',item.rmb,"\u5143)</span>"),p.push("")),p.push("</li>")}p.push("")}else p.push('<li>\u83b7\u53d6\u670d\u52a1\u6570\u636e\u5931\u8d25\uff0c\u8bf7<a href="javascript:;" class="link-lightBlue retry-trigger">\u91cd\u8bd5</a></li>');p.push("</ul>")}return p.join("")}});define("widget/box/floatBox/PicUploadBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/box/floatBox/Box"),f=a("utils/tmpl"),g=a("utils/Utils"),h=a("utils/Error"),i=a("model/UserData"),j=a("utils/DataSource"),k=a("sendbox/PhotoSendBox"),l=a("widget/box/floatBox/TipsBox"),m=a("utils/Log"),n=e.extend({init:function(a,b){this._super(a,b),this.callBack=b&&b.callBack||null,this.hasUploadImage=!1},preRender:function(){return{title:"\u4e0a\u4f20\u7167\u7247",subtitle:"\u751f\u6d3b\u7167\u6216\u8005\u6652\u7279\u957f\u4f1a\u66f4\u53d7\u6b22\u8fce\u54e6~",bodyContent:f.formatTemplate(a("template/floatbox/uploadPic"),{})}},postRender:function(){this._super(),this.$elem.addClass("poplayer-uploadPhoto"),this.$uploadElem=this.$elem.find(".js-upload"),this.$tipsElem=this.$elem.find(".js-tips"),this.initSendBox()},initSendBox:function(){this.photoSendBox=new k(this.$elem,{wrapper:this}),this.photoSendBox.render()},resetTextArea:function(){this.photoSendBox.$textarea.val("").keyup(),this.photoSendBox.$elem.find(".js-default-tip").show()},bindEvent:function(){this._super(),this.$elem.bind("trend:send:success",d.proxy(this.onSendSuccess,this)),this.$uploadElem.bind("image:upload:select",d.proxy(this.imgSelect,this)),this.$uploadElem.bind("image:upload:success",d.proxy(this.imgSuccess,this)),this.$uploadElem.bind("image:upload:error",d.proxy(this.imgError,this)),this.$uploadElem.bind("image:delete:success",d.proxy(this.imgDelete,this)),this.$uploadElem.bind("image:empty",d.proxy(this.imgEmpty,this)),this.$uploadElem.bind("image:check:addBtn",d.proxy(this.checkAddBtn,this))},show:function(b){this._super();var c=null;window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData?c=a("sendbox/widget/UploadPicHtml5"):c=a("sendbox/widget/UploadPic");var e=this;setTimeout(function(){e.uploadPic=new c(e.$uploadElem,{width:127,height:127,btnType:1}),e.uploadPic.render()},50),m.doLog({parameter:{method:"loadpic"},elem:d(b.currentTarget)})},imgSelect:function(){this.onTextTips(this.$tipsElem,"hide")},imgSuccess:function(){this.hasUploadImage||(this.hasUploadImage=!0,this.photoSendBox.$textarea.trigger("keyup")),this.photoSendBox.isBindDefaultTip||(this.photoSendBox.isBindDefaultTip=!0,this.photoSendBox.bindDefaultTip(),this.$elem.find(".js-publish-textarea").removeClass("publish-textarea-disabled").find("textarea").attr("disabled",!1))},imgDelete:function(){this.onTextTips(this.$tipsElem,"hide"),this.photoSendBox.$textarea.trigger("keyup")},imgEmpty:function(){this.hasUploadImage=!1},imgError:function(a,b){this.onTextTips(this.$tipsElem,"error",b)},checkAddBtn:function(a,b){b===0?this.uploadPic.$elem[0].className=this.uploadPic.initClassName:this.uploadPic.$elem[0].className=this.uploadPic.initClassName+" upload-item-success-"+b},onSendSuccess:function(a,b){this.$elem.trigger("trend:new",[b]),this.callBack?(this.hide(),this.callBack(b)):this.successCallBack()},successCallBack:function(){var a=this;if(d("body").hasClass("profile")&&i.isLoginUserPage()){this.hide();var b=new l(null,{data:{type:"correct",text:"\u4e0a\u4f20\u6210\u529f\uff01",desc:"\u60a8\u7684\u52a8\u6001\u5c06\u88ab\u63a8\u9001\u7ed9\u5408\u9002\u7684TA\uff0c\u5e76\u540c\u6b65\u5230\u60a8\u7684\u76f8\u518c"}});b.show(),b.delayHide(1500)}else this.$elem.find(".js-send-btn").addClass("n-display-show"),setTimeout(function(){a.animateHide()},1e3)},animateHide:function(){var a=d(".header-navi > li").last(),b=a.offset(),c={top:b.top,left:b.left,width:a.width(),height:a.height(),opacity:0},e=this;this.$elem.find(".js-mask").hide(),a.addClass("hover"),this.$mainElem.css("oveflow","hidden").animate(c,1500,"easeInOutExpo",function(){a.removeClass("hover"),e.$elem.fadeOut("slow",function(){e.hide()})})}});return n});define("sendbox/PhotoSendBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("sendbox/BasicSendBox"),f=a("utils/Log"),g=e.extend({_defaults:{ajaxUrl:"sendStatus",maxHeight:105,isAutoHeight:!0},init:function(a,b){b=d.extend({},this._defaults,b),this._super(a,b),this.isBindDefaultTip=!1},checkInputVal:function(){if(!this.config.wrapper.hasUploadImage||this.wordCounter.isError)return!1;return!0},parseParams:function(){var a={},b=d.trim(this.$textarea.val());this.config.wrapper.uploadPic&&(a.photos=this.config.wrapper.uploadPic.getImages()),b!==""&&(a.content=b);return a},onSuccess:function(a){this.$elem.trigger("trend:send:success",[a])},onSendSuccessLog:function(){f.doLog({parameter:{method:"updatapic"},elem:"body"})}});return g});define("template/floatbox/uploadPic",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="poplayer-bd"><p class="poplayer-desc">\u6bcf\u6b21\u6700\u591a\u4e0a\u4f204\u5f20\u7167\u7247\uff0c\u5355\u5f20\u7167\u7247\u572810k-8M\u4e4b\u95f4\uff0c\u652f\u6301ctrl\u952e\u591a\u9009\uff0c\u4e0a\u4f20\u540e\u624d\u53ef\u4ee5\u6dfb\u52a0\u8bf4\u660e\u3002</p><span class="text-icon-tips text-icon-tips-error js-tips hidden">\u7167\u7247\u683c\u5f0f\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u65b0\u6dfb\u52a0\u4e0a\u4f20\uff01</span><div class="poplayer-uploadPhoto-list clearfix js-upload"><div class="upload-item upload-item-default js-click js-drag"><div><em class="upload-item-icon-add-b"></em><p class="upload-item-tips js-drag-tips">\u70b9\u51fb\u4e0a\u4f20</p><form class="upload-item-form" enctype="multipart/form-data"><input class="upload-item-inputfile" type="file" multiple="multiple" accept="image/jpg,image/jpeg,image/png,image/gif,image/bmp" /></form></div></div></div><div class="poplayer-uploadPhoto-publish"><div class="publish-textarea js-publish-textarea publish-textarea-disabled"><label class="js-default-tip">\u4e3a\u4f60\u7684\u7167\u7247\u8865\u5145\u70b9\u8bf4\u660e\u5427\uff5e</label><textarea disabled="disabled"></textarea></div><div class="poplayer-foot clearfix">'),typeof isShowLabel!="undefined"&&isShowLabel&&p.push('<div class="poplayer-label"><label class="label-tag"><input type="checkbox" class="js-checkbox" autocomplete="off" checked="checked">',labelText,"</label></div>"),p.push('<div class="poplayer-btn n-send-ft js-send-btn"><div class="n-display-block"><div class="publish-btn n-btn-box js-btn"><div class="js-btn-txt disabled"><a class="btn btn-red n-btn-sure submit-trigger" href="javascript:;">\u53d1\u5e03</a></div></div><span class="publish-count js-wordCounter"><b class="char-constantia">163</b>\u5b57</span></div><div class="n-display-none"><span class="text-small-tips cGray"><em class="icon-correct-s" style="vertical-align: text-top; margin-right: 3px;"></em>\u53d1\u5e03\u6210\u529f\uff01</span></div></div></div></div></div>');return p.join("")}});define("sendbox/widget/UploadPicHtml5",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/Utils"),g=a("utils/OimageUrl"),h=a("utils/tmpl"),i=e.extend({init:function(a,b){this.$elem=a,this.config=b||{},this.$triggerElem=this.$elem.find(".js-click"),this.$inputFileElem=this.$triggerElem.find("input"),this.filesFilter=[],this.list=[],this.listElems={},this.cacheFileId=[],this.cacheFiles={},this.initClassName=this.$elem[0].className,this.MAX_LEN=4,this.uploadClassName="upload-item-loading upload-item-loaded upload-item-failed"},render:function(){this.bindEvent()},bindEvent:function(){this.$elem.find(".js-drag-tips").html("\u70b9\u51fb\u6216\u8005\u62d6\u5165\u4e0a\u4f20"),this.$inputFileElem.bind("change",d.proxy(this.onSelectFile,this)),this.$elem.delegate(".close-upload-trigger","click",d.proxy(this.onRemove,this)),this.$elem.delegate(".resend-trigger","click",d.proxy(this.onResend,this)),this.$elem.delegate(".js-drag","dragover",d.proxy(this.onDragOver,this)).delegate(".js-drag","dragleave",d.proxy(this.onDragLeave,this)).delegate(".js-drag","drop",d.proxy(this.onDrop,this))},filterFile:function(a){var b=[],c=[],e=[],g=this.currentCount();for(var h=0,j;j=a[h];h++){var k="",l=j.name.lastIndexOf(".");k=j.name.substring(l+1,j.name.length).toLocaleLowerCase(),j.type.indexOf("image")===0&&d.inArray(k,i.IMAGE_FORMAT)!==-1?j.size<f.MIN_PICSIZE||j.size>f.MAX_PICSIZE?e.push(j):b.push(j):c.push(j)}c.length>0?this.$elem.trigger("image:upload:error",[c.length+"\u5f20\u7167\u7247\u683c\u5f0f\u4e0d\u7b26\u5408\u89c4\u8303"]):e.length>0?this.$elem.trigger("image:upload:error",[e.length+"\u5f20\u7167\u7247\u5927\u5c0f\u4e0d\u7b26\u5408\u89c4\u8303"]):g+b.length>this.MAX_LEN?this.$elem.trigger("image:upload:error",["\u4f60\u5df2\u4e0a\u4f20"+this.MAX_LEN+"\u5f20\u7167\u7247\u4e0d\u80fd\u518d\u7ee7\u7eed\u4e0a\u4f20"]):this.$elem.trigger("image:upload:select",[]);if(g+b.length>this.MAX_LEN){var m=g+b.length-this.MAX_LEN;b.splice(b.length-m,m)}return b},onSelectFile:function(a){var b=a.originalEvent.target.files||a.originalEvent.dataTransfer.files;this.newFilesFilter=this.filterFile(b),this.newFilesFilter.length>0&&(this.filesFilter=this.filesFilter.concat(this.newFilesFilter),this.onDealFile()),this.$inputFileElem.val(null)},createFileId:function(){var a=f.S4();if(d.inArray(a,this.cacheFileId)!==-1)return this.createFileId();this.cacheFileId.push(a);return a},onDealFile:function(){for(var a=0,b;b=this.newFilesFilter[a];a++)b.fileId=this.createFileId(),this.cacheFiles[b.fileId]=b,this.onSelect(b)},renderItem:function(b){return d(h.formatTemplate(a("template/sendbox/widget/uploadItem"),{id:b}))},onSelect:function(a){var b=a.fileId;this.listElems[b]=this.renderItem(b),this.list.push(this.listElems[b]),this.$triggerElem.before(this.listElems[b]),this.checkAddBtn(),this.onShowThumbs(a),this.onUpload(a)},onShowThumbs:function(a){var b=this,c=a.fileId,d=new FileReader;d.onload=function(a){if(!!b.listElems[c]){var d=b.listElems[c].find(".js-thumb");d.show(),d[0].src=a.target.result,b.listElems[c].css({display:"inline"})}},d.readAsDataURL(a)},onUpload:function(a){var b=a.fileId,c=this;this.listElems[b].removeClass(this.uploadClassName).addClass("upload-item-loading");var d=new XMLHttpRequest;if(d.upload){d.upload.addEventListener("progress",function(b){c.uploading(a,b.loaded,b.total)}),d.onreadystatechange=function(b){d.readyState===4&&(d.status===200?c.onSingleSuccess(a,d.responseText):c.onError(a))},d.open("POST","/upload",!0);var e=encodeURIComponent(a.name);d.setRequestHeader("X_FILENAME",e);var f=new FormData;f.append("fileToUpload",a),d.send(f)}},uploading:function(a,b,c){var d=(b/c*100).toFixed(1);d=d>99?100:parseInt(d),this.listElems[a.fileId]&&this.listElems[a.fileId].find(".js-percent").css("width",d+"%").find(".js-percent-text").text(d+"%")},onSingleSuccess:function(a,b){var c=a.fileId;if(!!this.listElems[a.fileId]){b=d.parseJSON(b);var e=parseInt(b.code)||1;if(e!==1){this.onError(a);return}this.listElems[c].removeClass(this.uploadClassName).addClass("upload-item-loaded"),this.listElems[c].find(".js-thumb")[0].src=g(b.originalURL,this.config.width,this.config.height,1),this.listElems[c].originalURL=b.originalURL,this.$elem.trigger("image:upload:success"),this.removeFile(c),this.filesFilter.length===0&&this.onAllUploaded()}},removeFile:function(a){var b=-1;for(var c=0,d;d=this.filesFilter[c];c++)if(d.fileId===a){b=c;break}b!==-1&&this.filesFilter.splice(b,1)},onAllUploaded:function(){this.$elem.trigger("image:upload:allUpload")},currentCount:function(){return this.list.length},checkAddBtn:function(){var a=this.currentCount();this.$elem.trigger("image:check:addBtn",[a]),a>=this.MAX_LEN?this.hideAddBtn():this.showAddBtn()},hideAddBtn:function(){this.$triggerElem.addClass("upload-item-flash-hidden")},showAddBtn:function(){this.$triggerElem.removeClass("upload-item-flash-hidden")},getUploadCount:function(){return this.MAX_LEN-this.currentCount()},onRemove:function(a){var b=d(a.currentTarget).attr("data-fileId"),c=d.inArray(this.listElems[b],this.list);this.list.splice(c,1),this.listElems[b].hide(),this.removeFile(b),this.checkAddBtn(),this.$elem.trigger("image:delete:success"),this.list.length===0&&this.$elem.trigger("image:empty");var e=this;setTimeout(function(){e.listElems[b].remove(),e.listElems[b]=null},50)},onResend:function(a){var b=d(a.currentTarget).attr("data-fileId");this.onUpload(this.cacheFiles[b])},onClear:function(){for(var a in this.listElems)this.listElems[a]=null;this.list=[],this.filesFilter=[],this.cacheFiles={},this.$elem.find(".js-item").remove(),this.checkAddBtn()},onError:function(a,b){var c=a.fileId;this.listElems[c].removeClass(this.uploadClassName).addClass("upload-item-failed")},onDragOver:function(a){this.dragTimer&&clearTimeout(this.dragTimer),a.stopPropagation(),a.preventDefault();var b=d(a.currentTarget);b.addClass("upload-drag-over")},onDragLeave:function(a){a.stopPropagation(),a.preventDefault(),this.dragTimer=setTimeout(function(){var b=d(a.currentTarget);b.removeClass("upload-drag-over")},100)},onDrop:function(a){this.onDragLeave(a),this.onSelectFile(a)},getImages:function(){var a=[];if(this.list.length>0)for(var b=this.list.length-1;b>=0;b--)this.list[b].originalURL&&a.push(this.list[b].originalURL);return encodeURI(a.join(","))}});i.IMAGE_FORMAT=["jpg","jpeg","gif","png","bmp"];return i});define("template/sendbox/widget/uploadItem",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="upload-item js-item" data-fileId="',id,'"><div class="upload-image"><img class="js-thumb" /></div><i class="upload-item-mask"></i><a class="upload-item-close icon-close-m close-upload-trigger" title="\u5220\u9664\u7167\u7247" data-fileId="',id,'" href="javascript:;"></a><div class="upload-item-success"><i></i><span>\u4e0a\u4f20\u6210\u529f</span></div><div class="upload-item-progress"><span class="js-percent" style="width:0%;"><b class="js-percent-text">0%</b></span></div><div class="upload-item-fail"><p class="text-gray">\u4e0a\u4f20\u5931\u8d25</p><a class="link-nu resend-trigger" data-fileId="',id,'" href="javascript:;">\u91cd\u8bd5</a></div></div>');return p.join("")}});define("sendbox/widget/UploadPic",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/Utils"),g=a("utils/OimageUrl"),h=a("utils/tmpl"),i=a("sendbox/widget/UploadPicHtml5"),j=a("utils/FlashProxy"),k=a("utils/ie/HashTitle"),l=i.extend({init:function(a,b){this._super(a,b),this.config.btnType=b.btnType||1,this.uId=f.S4(),this.flashId="fn_"+this.uId,this.$flashElem=this.$triggerElem.find("> div"),this.$flashElem[0].id=this.flashId,this.initFlash()},bindEvent:function(){var a={};a[this.flashId]=d.proxy(this.uploadHandler,this),a["getUploadCount"+this.uId]=d.proxy(this.getUploadCount,this),j.add(a),this.$elem.delegate(".close-upload-trigger","click",d.proxy(this.onRemove,this))},initFlash:function(){var b={url:"http://static.t.126.net/frontend/flash/upload/picsUpload_121126.swf",id:this.flashId,width:this.config.width,height:this.config.height,params:{flashvars:"btnType="+this.config.btnType+"&maxSize="+f.MAX_PICSIZE+"&minSize="+f.MIN_PICSIZE+"&picW="+this.config.width+"&picH="+this.config.height+"&picsUploadCallBack=flashProxy.callback."+this.flashId+"&showThumb=1&getUploadCount=flashProxy.callback.getUploadCount"+this.uId+"&uploadUrl=http://"+location.host+"/upload",allowScriptAccess:"always",wmode:"opaque"}},c=this;a("lib/swfobject").embedSWF(b.url,b.id,b.width,b.height,"10.3.0","","",b.params,"",function(a){a.success||c.$flashElem.html('<p><a title="\u8bf7\u5b89\u88c5flash" href="http://www.adobe.com/go/getflashplayer" target="_blank"><img src="http://img2.cache.netease.com/love/image/project/tips/get_flash_player.gif" alt="\u83b7\u53d6 flash \u64ad\u653e\u5668"></a></p>')}),k.bindEvent()},uploadHandler:function(a){a=d.parseJSON(a);var b=a.data||{},c=b.length||0;switch(a.status){case"swf.ready":break;case"upload.select":var e=a.selectCount||0,f=a.invalidCount||0;f!==0?this.$elem.trigger("image:upload:error",[f+"\u5f20\u7167\u7247\u5c3a\u5bf8\u4e0d\u7b26\u5408\u89c4\u8303"]):this.currentCount()+e>this.MAX_LEN?this.$elem.trigger("image:upload:error",["\u4f60\u5df2\u4e0a\u4f20"+this.MAX_LEN+"\u5f20\u7167\u7247\u4e0d\u80fd\u518d\u7ee7\u7eed\u4e0a\u4f20"]):this.$elem.trigger("image:upload:select",[]);for(var g=0;g<c;g++)this.onSelect(b[g].fileId);break;case"upload.showThumbs":for(var h=0;h<c;h++)this.onShowThumbs(b[h].fileId,b[h].img);break;case"upload.uploading":this.onUploading(b.fileId,b.percent);break;case"upload.success":this.onSingleSuccess(b.fileId,b.result.originalURL);break;case"upload.allUploaded":this.onAllUploaded();break;case"upload.error":this.onError(b.fileId,b);break;default:}},onSelect:function(a){this.listElems[a]=this.renderItem(a),this.list.push(this.listElems[a]),this.$triggerElem.before(this.listElems[a]),this.checkAddBtn()},onShowThumbs:function(a,b){if(!!this.listElems[a]){var c=this.listElems[a].find(".js-thumb");d.browser.msie&&d.browser.version<9||(c[0].src="data:image/png;base64,"+b,c.show()),this.listElems[a].css({display:"inline"})}},onUploading:function(a,b){!this.listElems[a]||(this.listElems[a].removeClass(this.uploadClassName).addClass("upload-item-loading"),this.listElems[a].find(".js-percent").css("width",b+"%").find(".js-percent-text").text(b+"%"))},onSingleSuccess:function(a,b){if(!!this.listElems[a]){var c=this.listElems[a].find(".js-thumb");this.listElems[a].removeClass(this.uploadClassName).addClass("upload-item-loaded"),c[0].src=g(b,this.config.width,this.config.height,1),d.browser.msie&&d.browser.version<9&&c.show(),this.listElems[a].originalURL=b,this.$elem.trigger("image:upload:success")}}});return l});define("utils/FlashProxy",function(a,b,c){var d={callback:{},add:function(a){for(var b in a)if(typeof this.callback[b]=="undefined")this.callback[b]=a[b];else throw new Error("flashProxy.callback\u91cc\u91cd\u590d\u5b9a\u4e49\u65b9\u6cd5: "+b)}};window.flashProxy=d;return d});define("utils/ie/HashTitle",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/Utils"),g=e.extend({init:function(){this.isBindEvent=!1},bindEvent:function(){if(!this.isBindEvent&&d.browser.msie){var a=document.title.split("#")[0];document.attachEvent("onpropertychange",function(b){b.propertyName==="title"&&document.title!==a&&setTimeout(function(){document.title=a},1)}),this.isBindEvent=!0}}}),h=null;return{bindEvent:function(){h===null&&(h=new g),h.bindEvent()}}});define("widget/box/floatBox/LetterBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("widget/box/floatBox/Box"),f=a("utils/tmpl"),g=a("utils/Utils"),h=a("utils/Error"),i=a("utils/DataSource"),j=a("sendbox/LetterSendBox"),k=a("widget/box/floatBox/TipsBox"),l=a("utils/Log"),m=a("utils/Cookie"),n=a("model/UserData"),o=e.extend({UI_CONFIG:[{id:"1",className:"letter-template-default",name:"\u65e0\u4e3b\u60c5\u8bdd"},{id:"2",name:"\u65f6\u5149\u96a7\u9053",className:"letter-template-past"},{id:"3",name:"\u72ec\u5c45\u751f\u6d3b",className:"letter-template-xiaoshipian"},{id:"4",name:"\u60f3\u5bf9\u4f60\u8bf4",className:"letter-template-unbosom"}],init:function(a,b){this._super(a,b),this.callBack=b&&b.callBack||null},preRender:function(){return{title:"\u6587\u5b57\u4f20\u60c5",subtitle:"\u8868\u8fbe\u7231\u7684\u5fc3\u8bed,\u9065\u5bc4\u672a\u6765\u7684TA",bodyContent:f.formatTemplate(a("template/floatbox/letterBox"),{uiConfig:this.UI_CONFIG,nickName:n.getLoginUser().nickName})}},postRender:function(){this._super(),this.$elem.addClass("poplayer-letter"),this.$tabElem=this.$elem.find(".js-tab"),this.$contentElem=this.$elem.find(".js-content"),this.contentClassName=this.$contentElem[0].className,this.$textareaElem=this.$elem.find("textarea"),this.publishBox=new j(this.$elem,{wrapper:this}),this.publishBox.render(),this.changeStyle(0)},bindEvent:function(){this._super(),this.$elem.bind("letter:send:success",d.proxy(this.onSendSuccess,this)),this.$tabElem.delegate("a","click",d.proxy(this.onTabSwitch,this)),this.$textareaElem.bind("keyup",d.proxy(this.onKeyup,this))},reset:function(){this.$tabElem.find("a:first").click(),this.$textareaElem.val(""),this.onKeyup(),this.$elem.find(".js-mask").show(),this.$elem.find(".js-send-btn").removeClass("n-display-show")},setTextArea:function(){var a=this.$textareaElem,b=m.get("letterInput");b?a.val(decodeURIComponent(b)):a.val(""),a.keyup()},onTabSwitch:function(a){var b=d(a.currentTarget).addClass("current"),c=b.prevAll().size();b.siblings(".current").removeClass("current"),this.$textareaElem.focus(),this.changeStyle(c)},changeStyle:function(a){this.style=this.UI_CONFIG[a],this.$contentElem[0].className=this.contentClassName,this.$contentElem.addClass(this.style.className)},onKeyup:function(a){this.keyupTimer&&clearTimeout(this.keyupTimer);var b=this;this.keyupTimer=setTimeout(function(){m.set("letterInput",encodeURIComponent(b.$textareaElem.val()),1)},50)},show:function(){this._super(),this.publishBox&&this.publishBox.lineCounter.createTempTextArea();var a=this;setTimeout(function(){a.setTextArea(),a.$textareaElem.focusToEnd()},30)},hide:function(){this._super(),this.publishBox.lineCounter.hide(),this.reset()},onSendSuccess:function(a,b){this.$elem.trigger("trend:new",[b]),m.del("letterInput"),this.callBack?(this.hide(),this.callBack(b)):this.successCallBack()},successCallBack:function(){var a=this;if(d("body").hasClass("profile")&&n.isLoginUserPage()){this.hide();var b=new k(null,{data:{type:"correct",text:"\u53d1\u5e03\u6210\u529f\uff01",desc:"\u60a8\u7684\u52a8\u6001\u5c06\u88ab\u63a8\u9001\u7ed9\u5408\u9002\u7684TA"}});b.show(),b.delayHide(1500)}else this.$elem.find(".js-send-btn").addClass("n-display-show"),setTimeout(function(){a.animateHide()},1e3)},animateHide:function(){var a=d(".header-navi > li").last(),b=a.offset(),c={top:b.top,left:b.left,width:a.width(),height:a.height(),opacity:0},e=this;this.$elem.find(".js-mask").hide(),a.addClass("hover"),this.$mainElem.animate(c,1e3,"easeInOutExpo",function(){a.removeClass("hover"),e.$elem.fadeOut("slow",function(){e.$elem.find(".js-main").attr("style",""),e.hide()})})}}),p=null;return{getInstance:function(a,b){p===null&&(p=new o(a,b));return p}}});define("sendbox/LetterSendBox",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("sendbox/BasicSendBox"),f=a("sendbox/widget/TextArea"),g=a("sendbox/widget/LineCounter"),h=a("utils/Log"),i=e.extend({_defaults:{ajaxUrl:"sendLetter",isAutoHeight:!0,maxHeight:280},init:function(a,b){b=d.extend({},this._defaults,b),this._super(a,b)},bindEvent:function(){this.lineCounter=new g(this.$elem.find(".js-lineCounter"),{textarea:this.$textarea}),this.textarea=new f(this.$textarea,{maxHeight:this.config.maxHeight}),this.$elem.delegate(".submit-trigger","click",d.proxy(this.onSubmit,this)),this.bindAutoHeight(),this.bindCtrlEnter(),this.bindCheckInput()},checkInputVal:function(){if(this.lineCounter.isLineError)return!1;return!0},parseParams:function(){var a={templateId:this.config.wrapper.style.id||1,content:this.$textarea.val()};return a},onSendLog:function(a){h.doLog({parameter:{method:"addLetter"},elem:this.$elem})},onSuccess:function(a){this.$elem.trigger("letter:send:success",[a])}});return i});define("sendbox/widget/LineCounter",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("sendbox/widget/WordCounter"),f=a("utils/Utils"),g=e.extend({init:function(a,b){this._super(a,b),this.isLineError=!0,this.maxLine=b.maxLine||10,this.minLine=b.minLine||3,this.$tempTextareaElem=null},createTempTextArea:function(){this.$tempTextareaElem===null?this.$tempTextareaElem=f.createTextarea({textarea:this.$textareaElem}):this.$tempTextareaElem.appendTo("body")},onInput:function(a){var b=this;this.$tempTextareaElem.val(b.$textareaElem.val()),this.lineTimer&&clearTimeout(this.lineTimer),this.lineTimer=setTimeout(function(){b.lineHeight=b.lineHeight||parseInt(b.$textareaElem.css("lineHeight"));var a=parseInt(b.$tempTextareaElem.prop("scrollHeight")/b.lineHeight),c=b.maxLine-a,e=d.trim(b.$textareaElem.val());e.length<10?b.$elem.html('\u81f3\u5c11\u8f93\u5165<b class="char-constantia">10</b>\u4e2a\u5b57'):c>-1?b.$elem.html('\u8fd8\u53ef\u4ee5\u8f93\u5165<b class="char-constantia">'+c+"</b>\u884c"):b.$elem.html('\u8d85\u8fc7<b class="char-constantia">'+Math.abs(c)+"</b>\u884c"),e.length<10||a>b.maxLine?(b.$elem.addClass("warn"),b.isLineError=!0):(b.isLineError=!1,b.$elem.removeClass("warn"))},30)},hide:function(){this.$tempTextareaElem.detach()}});return g});define("template/floatbox/letterBox",function(require){return function(tmplData){var p=[];with(tmplData){p.push('<div class="poplayer-bd"><div class="poplayer-letter-template js-tab">');if(uiConfig&&uiConfig.length){p.push("");for(var i=0,k;i<uiConfig.length,k=uiConfig[i];i++)p.push('<a class="'),i===0&&p.push("current"),p.push('" href="javascript:;">',k.name,"</a>");p.push("")}p.push('</div><div class="poplayer-letter-content js-content"><div class="letter-body"><div class="letter-hd"><h2 class="letter-hd-title"><span class="n-letter-title-default">\u968f\u4fbf\u8bf4\u70b9\u60c5\u8bdd\uff1a</span><span class="n-letter-title-past">\u5206\u4eab\u6211\u7684\u8fc7\u53bb\uff1a</span><span class="n-letter-title-xiaoshipian">\u8bb0\u5f55\u73b0\u5728\u7684\u751f\u6d3b\uff1a</span><span class="n-letter-title-unbosom">\u5199\u7ed9\u559c\u6b22\u7684\u4eba\uff1a</span></h2></div><div class="letter-bd"><div class="poplayer-letter-textarea js-textareaCon"><textarea class="ui-scrollbar"></textarea></div><p class="poplayer-letter-sign">\u2014\u2014by&nbsp;',nickName,'</p></div><div class="letter-ft"></div></div></div><div class="poplayer-letter-ft js-send-btn"><div class="n-display-block"><div class="poplayer-letter-btn n-btn-box js-btn"><div class="disabled js-btn-txt"><a class="btn btn-red n-btn-sure submit-trigger" href="javascript:;">\u53d1\u5e03</a></div></div><span class="poplayer-letter-tips js-lineCounter"></span></div><div class="n-display-none"><span class="text-small-tips cGray"><em class="icon-correct-s" style="vertical-align: text-top; margin-right: 3px;"></em>\u53d1\u5e03\u6210\u529f\uff01</span></div></div></div>')}return p.join("")}});define("task/widget/header",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("task/basic/Task"),f=a("utils/Cookie"),g=a("utils/Log");(new e("header",function(){var b=d("#header"),c=d("#publishArea"),e=d(document.body),g=d(".js-header-info");g.size()!==0&&d.browser.msie&&d.browser.version<7&&(g.find(".js-info-mess").hover(function(){d(this).addClass("hover-mess")},function(){d(this).removeClass("hover-mess")}),g.find(".js-info-user").hover(function(){d(this).addClass("hover-user")},function(){d(this).removeClass("hover-user")}));if(d.browser.msie&&d.browser.version<7&&parseInt(f.get("updateie6"))!==1){var h=d('<div id="updateBrowser" class="update-browser" data-log="updateie6">\n            <div class="update-browser-inner">\n               <p>Hey\uff0c\u60a8\u5728\u82b1\u7530\u5bfb\u627e\u7684\u5f02\u6027\u90fd\u4e0d\u4f7f\u7528IE6\u6d4f\u89c8\u5668\u4e86\uff0c\u4f60\u4e5f\u8d76\u5feb\u5347\u7ea7\u5427\u3002\u5f3a\u70c8\u5efa\u8bae\u4f60\u5b89\u88c5<a class="link-red" target="_blank" href="http://chrome.163.com/">\u7f51\u6613\u5b9a\u5236\u7248\u8c37\u6b4c\u6d4f\u89c8\u5668</a>\u6216<a class="link-red" target="_blank" href="http://windows.microsoft.com/zh-CN/windows/upgrade-your-browser">\u5347\u7ea7IE</a>\uff01</p>\n            </div>\n         </div>');h.insertBefore(d("#header")),h.delegate(".close-browserTip-trigger","click",function(){f.set("updateie6",1,30),h.remove()})}if(b.find(".js-info-user").size()!==0){var i=a("widget/box/floatBox/CloseInfoBox");b.find(".js-info-user").delegate(".closeinfo-trigger","click",function(){(new i).show()})}d("#logOut").attr("href","/logout?url="+location.href)})).add()});define("widget/box/floatBox/CloseInfoBox",function(a,b,c){var d=a("lib/jquery"),e=a("widget/box/floatBox/Box"),f=a("utils/tmpl"),g=a("utils/Utils"),h=a("utils/Error"),i=a("utils/DataSource"),j=a("utils/Log"),k=a("widget/box/floatBox/TipsBox"),l=e.extend({preRender:function(){return{title:"\u5173\u95ed\u8d44\u6599",bodyContent:f.formatTemplate(a("template/floatbox/closeInfoBox"),this.parseData())}},parseData:function(){var a=d.extend({},this.data);return a},postRender:function(){this._super(),this.$elem.addClass("poplayer-closeInfoBox"),this.isValid=!1,this.$inputElems=this.$elem.find(".js-list input[type=checkbox]"),this.$btnAreaElem=this.$elem.find(".n-btn-box").find(".js-btn")},bindEvent:function(){this._super(),this.$elem.delegate(".submit-trigger","click",d.proxy(this.onSubmit,this)),this.$elem.delegate("input","click",d.proxy(this.onSelectVal,this))},onSelectVal:function(a){this.onSetBtnStatus(),this.onCheckVal(a)},onSetBtnStatus:function(){this.$inputElems.filter(":checked").size()===0?this.disableBtn():this.enableBtn()},onCheckVal:function(a){var b=d(a.currentTarget),c=this.$inputElems.first();b[0]===c[0]&&(c.is(":checked")?this.$inputElems.slice(1).attr({checked:!1,disabled:!0}):this.$inputElems.slice(1).attr({disabled:!1}))},parseParams:function(){var a={},b=this.$inputElems.filter(":checked"),c=[];d.each(b,function(a,b){c.push(d(b).val())}),a.type=c.join(";");return a},onSubmit:function(){if(!(!this.isValid||d.isPlainObject(this.request)&&this.request.readyState!==4)){var a=this.parseParams(),b=this;g.btnSending.call(this,this.$elem.find(".submit-trigger")),this.request=i.postJSON("closeUser",a,function(a){var c=parseInt(a.code)||1;h.Tips(c)||(b.hide(),b.onSuccess()),g.btnSended.call(b,b.$elem.find(".submit-trigger"))}),j.doLog({parameter:{method:"closeinfor"},elem:"body"})}},onSuccess:function(){var a=new k(null,{data:{type:"correct",text:"\u8d44\u6599\u5df2\u5173\u95ed\uff01"}});a.show(),a.delayHide(g.tipsHideInterval),setTimeout(function(){location.reload()},2500)},enableBtn:function(){this.$btnAreaElem.removeClass("disabled"),this.isValid=!0},disableBtn:function(){this.$btnAreaElem.addClass("disabled"),this.isValid=!1}});return l});define("template/floatbox/closeInfoBox",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="poplayer-bd"><div class="poplayer-closeInfo-tips"><p class="text-border-tips"><span><em class="icon-warning-s"></em>\u5173\u95ed\u8d44\u6599\u540e\uff0c\u60a8\u5c06\u4e0d\u518d\u4f7f\u7528\u82b1\u7530\u3002\u5176\u4ed6\u7528\u6237\u5c06\u65e0\u6cd5\u770b\u5230\u60a8\u7684\u8d44\u6599\uff0c\u60a8\u4e5f\u4e0d\u518d\u4f1a\u5728\u641c\u7d22\u7ed3\u679c\u4e2d\u51fa\u73b0\u6216\u88ab\u63a8\u8350\u81f3\u9996\u9875\uff0c\u60a8\u4e4b\u524d\u7684\u4e92\u52a8\u4fe1\u606f\u53ef\u80fd\u4f1a\u88ab\u5220\u9664\u65e0\u6cd5\u627e\u56de\uff01</span></p></div><div class="poplayer-closeInfo-content"><div class="poplayer-closeInfo-title clearfix"><h3 class="fS14 fL">\u60a8\u9009\u62e9\u5173\u95ed\u8d44\u6599\u7684\u539f\u56e0\u662f\uff1f</h3><span class="poplayer-desc">(\u8bf7\u5e2e\u52a9\u6211\u4eec\u6539\u8fdb\uff0c\u8c22\u8c22\uff01)</span></div><ul class="poplayer-closeInfo-list poplayer-desc js-list"><li><label class="label-tag"><input type="checkbox" name="type" value="1" />\u5df2\u5728\u82b1\u7530\u627e\u5230\u5bf9\u8c61</label></li><li><label class="label-tag"><input type="checkbox" name="type" value="2" />\u5df2\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u627e\u5230\u5bf9\u8c61</label></li><li><label class="label-tag"><input type="checkbox" name="type" value="3" />\u63a8\u8350\u7ed9\u6211\u7684\u4eba\u90fd\u4e0d\u559c\u6b22</label></li><li><label class="label-tag"><input type="checkbox" name="type" value="4" />\u529f\u80fd\u5355\u8c03\uff0c\u611f\u89c9\u6ca1\u6cd5\u513f\u4e92\u52a8\u8d77\u6765</label></li><li><label class="label-tag"><input type="checkbox" name="type" value="5" />\u4eba\u5c11\uff0c\u770b\u6765\u770b\u53bb\u5c31\u90a3\u51e0\u4e2a</label></li><li><label class="label-tag"><input type="checkbox" name="type" value="6" />\u6ca1\u529e\u6cd5\u8fc5\u901f\u7684\u627e\u5230\u6211\u5fc3\u4eea\u7684\u5bf9\u8c61</label></li><li><label class="label-tag"><input type="checkbox" name="type" value="7" />\u88ab\u5a5a\u6258\u3001\u9152\u6258\u7684\u9a9a\u6270</label></li><li><label class="label-tag"><input type="checkbox" name="type" value="8" />\u5176\u4ed6</label></li></ul></div></div><div class="poplayer-ft"><div class="poplayer-btn n-btn-box"><div class="js-btn disabled"><a class="btn btn-red n-btn-sure submit-trigger" data-loading-text="\u63d0\u4ea4\u4e2d..." href="javascript:;">\u63d0\u4ea4\u5e76\u5173\u95ed</a>&nbsp;&nbsp;&nbsp;&nbsp;<a class="btn btn-gray close-trigger" href="javascript:;">\u53d6\u6d88</a></div></div></div>');return p.join("")}});define("task/widget/newCount",function(a,b,c){"use strict";var d=a("task/basic/Task"),e=a("lib/jquery"),f=a("utils/Polling"),g=a("utils/TitleNotice").getInstance(),h=a("utils/Utils"),i=e(window),j=e(document.body);(new d("newCount",function(){function p(a){return a.newDigg+a.newFollow+a.newMessage+a.newNotice+a.newVisitors+a.newGift}var a=e("#newMessage"),b=e("#header"),c=a.find(".js-title"),d=a.find(".js-list"),i=d.find(".js-digg"),k=d.find(".js-heed"),l=d.find(".js-message"),m=d.find(".js-admin"),n=d.find(".js-visitors"),o=d.find(".js-gift");if(a.size()!==0){var q=e("#newCountTimer"),r=q.size()>0&&q.val()!==""?q.val():12e4,s=new f({requestUrl:"newCount",interval:r});s.register("newCount",{},function(a){h.updateNewCount(i,a.newDigg),h.updateNewCount(k,a.newFollow),h.updateNewCount(l,a.newMessage),h.updateNewCount(m,a.newNotice),h.updateNewCount(n,a.newVisitors),h.updateNewCount(o,a.newGift);var b=parseInt(a.newMessage,10);b<1?g.register("message",null):g.register("message","\u60a8\u6709"+b+"\u6761\u65b0\u79c1\u4fe1")}),s.register("newOnlineUsers",{},function(a){j.trigger("inform:store",[a])});var t=e("#newMessagePreview"),u=t.find(".js-digg"),v=t.find(".js-heed"),w=t.find(".js-message"),x=t.find(".js-admin"),y=t.find(".js-visitors"),z=t.find(".js-gift"),A=parseInt(t.data("show"),10)===1?!0:!1;s.register("newCount",{},function(a){h.updateNewCount(u,a.newDigg),h.updateNewCount(v,a.newFollow),h.updateNewCount(w,a.newMessage),h.updateNewCount(x,a.newNotice),h.updateNewCount(y,a.newVisitors),h.updateNewCount(z,a.newGift);var b=p(a);b===0?(t.hide(),A=!1):(t.show(),A=!0)}),function(){A&&t.show()}();var B=function(){A&&t.show()},C=function(){A&&t.hide()},D=null;c.hover(function(){D&&clearTimeout(D),a.addClass("header-info-mess-hover"),C()},function(){D=setTimeout(function(){a.removeClass("header-info-mess-hover"),B()},50)}),d.hover(function(){D&&clearTimeout(D),a.addClass("header-info-mess-hover"),C()},function(){D=setTimeout(function(){a.removeClass("header-info-mess-hover"),B()},50)})}})).add()});define("utils/Polling",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/DataSource"),g=a("model/UserData"),h=e.extend({init:function(a){this.config=a||{},this.params={},this.callbacks={},this.registers=[],this.timer=null,this.INTERVAL=this.config.interval||5e3},register:function(a,b,c){d.isFunction(b)&&(c=b,b={}),d.inArray(a,this.registers)===-1&&(this.registers.push(a),this.callbacks[a]=[]),this.callbacks[a].push(c),d.extend(this.params,b),this.timer===null&&this.startInterval()},remove:function(a){if(d.inArray(a,this.registers)!==-1){var b=d.inArray(a,this.registers);b!==-1&&(this.registers.splice(b,1),this.callbacks[a]=null)}},startInterval:function(){if(this.registers.length!==0&&!!this.INTERVAL){var a=this;this.stopInterval(),this.timer=setInterval(d.proxy(this.doPolling,this),this.INTERVAL)}},stopInterval:function(){this.timer&&clearInterval(this.timer)},resetInterval:function(){this.stopInterval(),this.startInterval()},doPolling:function(){f.postJSON(this.config.requestUrl,this.params,d.proxy(this.onDataBack,this))},onDataBack:function(a){for(var b=0,c=this.registers.length;b<c;b++){var d=this.registers[b],e=this.callbacks[d]||[],f=a[d];for(var g=0,c=e.length;g<c;g++)e[g]&&e[g].call(null,f)}},reset:function(){},updateParams:function(a){d.extend(this.params,a)}});return h});define("utils/TitleNotice",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("basic/Class"),f=document.title,g=e.extend({init:function(){this.timer=null,this.timerCounter=0,this.notice={},this.INTERVAL=1e3,this.sequence=["message","feed"]},register:function(a,b){this.notice[a]=b,this.resetInterval()},startInterval:function(){this.setTitle();if(this.title==="")document.title=f;else{var a=this;this.stopInterval(),this.timer=setInterval(d.proxy(this.showTitle,this),this.INTERVAL)}},stopInterval:function(){this.timer&&clearInterval(this.timer)},resetInterval:function(){this.stopInterval(),this.startInterval()},setTitle:function(){var a="";for(var b=0,c=this.sequence.length;b<c;b++)if(this.notice[this.sequence[b]]){a=this.notice[this.sequence[b]];break}this.title=a},showTitle:function(){this.timerCounter%2===1?document.title=this.title:document.title=f,this.timerCounter+=1}}),h=null;return{getInstance:function(){h===null&&(h=new g);return h}}});define("task/widget/loginInform",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("task/basic/Task"),f=a("utils/Storage"),g=a("model/UserData"),h=a("widget/box/introBox/LoginInform"),i=a("utils/StorageEvent").getInstance(),j=d(document.body);(new e("loginInform",function(){var a=!(d.browser.msie&&d.browser.version<=9),b=4e3,c=6e3,e=function(a){typeof a=="string"&&(a=d.parseJSON(a));var e=a.userList,i=a.buyTip,j=e.length,k=function(){j--,j>=0?(new h(null,{data:{url:e[j].url,name:e[j].name,avatar:e[j].avatar,isSuperVip:i!="y",isNormalVip:g.loginUserIsNormalVip}})).show(undefined,{autoClose:!1,holdonTime:c,hideCallBack:function(){this.clearUnfinishedTimers(),setTimeout(function(){k()},b)}}):f.remove("loginUsers")};k()},k=function(b,c){c.userList.length&&(f.set("loginUsers",d.JSON.stringify(c)),a&&e(c))};i.watch("loginUsers",e),j.bind("inform:store",k)})).add()});define("utils/Storage",function(a,b,c){var d,e=function(){},f=window.document,g={set:e,get:e,remove:e,clear:e,each:e,obj:e,length:0};(function(){if("localStorage"in window)try{d=window.localStorage;return}catch(a){}var b=f.getElementsByTagName("head")[0],c=window.location.hostname||"localStorage",e=new Date,g,h;if(!b.addBehavior)try{d=window.localStorage}catch(a){d=null}else{try{h=new ActiveXObject("htmlfile"),h.open(),h.write('<script>document.w=window;</script><iframe src="/favicon.ico"></iframe>'),h.close(),g=h.w.frames[0].document,b=g.createElement("head"),g.appendChild(b)}catch(a){b=f.getElementsByTagName("head")[0]}try{e.setDate(e.getDate()+36500),b.addBehavior("#default#userData"),b.expires=e.toUTCString(),b.load(c),b.save(c)}catch(a){return}var i,j;try{i=b.XMLDocument.documentElement,j=i.attributes}catch(a){return}var k="p__hack_",l="m-_-c",m=new RegExp("^"+k),n=new RegExp(l,"g"),o=function(a){return encodeURIComponent(k+a).replace(/%/g,l)},p=function(a){return decodeURIComponent(a.replace(n,"%")).replace(m,"")};d={length:j.length,isVirtualObject:!0,getItem:function(a){return(j.getNamedItem(o(a))||{nodeValue:null}).nodeValue||i.getAttribute(o(a))},setItem:function(a,d){try{i.setAttribute(o(a),d),b.save(c),this.length=j.length}catch(e){}},removeItem:function(a){try{i.removeAttribute(o(a)),b.save(c),this.length=j.length}catch(d){}},clear:function(){while(j.length)this.removeItem(j[0].nodeName);this.length=0},key:function(a){return j[a]?p(j[a].nodeName):undefined}},"localStorage"in window||(window.localStorage=d)}})();var h=d?{set:function(a,b){this.get(a)!==undefined&&this.remove(a),d.setItem(a,b),this.length=d.length},get:function(a){var b=d.getItem(a);return b===null?undefined:b},remove:function(a){d.removeItem(a),this.length=d.length},clear:function(){d.clear(),this.length=0},each:function(a){var b=this.obj(),c=a||function(){},d;for(d in b)if(c.call(this,d,this.get(d))===!1)break},obj:function(){var a={},b=0,c,e;if(d.isVirtualObject)a=d.key(-1);else{c=d.length;for(;b<c;b++)e=d.key(b),a[e]=this.get(e)}return a},length:d.length}:g;return h});define("widget/box/introBox/LoginInform",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("utils/tmpl"),f=a("widget/box/introBox/Box"),g=d(window),h=f.extend({init:function(a,b){this._super(a,b),this.isModernBrowser=!(d.browser.msie&&d.browser.version<9)},show:function(a,b){this._super(a,b);var c=this;this.data.isSuperVip&&(this.timer=setTimeout(function(){c.isModernBrowser?c.modernBrowserHide():c.lowBrowserHide()},this.config.holdonTime))},clearUnfinishedTimers:function(){this.timer&&clearTimeout(this.timer)},preRender:function(){return{bodyContent:e.formatTemplate(a("template/introbox/loginInform"),this.data)}},postRender:function(){this._super(),this.$elem.addClass("introlayer-inform")},setPosition:function(){var a=g.height(),b=g.width(),c=(b-935)/2,e;c>318?e=c-320:e=12,this.$mainElem.css({right:e,top:a-12-this.$mainElem.height()});if(d.browser.msie&&d.browser.version==6){var f=g.scrollTop();this.$mainElem.css({left:c+935+11,top:"+="+f})}this.isModernBrowser?this.modernBrowserShow():(this.$mainElem.css({opacity:"0",top:"+=20px"}),this.lowBrowserShow())},modernBrowserShow:function(){var a=this;setTimeout(function(){a.$elem.addClass("introlayer-informOver")},0)},hide:function(){var a=this;a.__super=this._super,this.$elem.fadeOut("slow",function(){a.__super()})},modernBrowserHide:function(){var a=this;this.$elem.removeClass("introlayer-informOver"),setTimeout(function(){a.hide()},500)},lowBrowserShow:function(){this.$mainElem.animate({opacity:"1",top:"-=20px"})},lowBrowserHide:function(){var a=this;this.$mainElem.animate({opacity:"0",top:"+=20px"},function(){a.hide()})}});return h});define("template/introbox/loginInform",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div class="introlayer-main"><a class="introlayer-close icon-close close-trigger" title="\u5173\u95ed" href="javascript:;"></a>'),isSuperVip||p.push('<div class="introlayer-inform-title"><span class="icon-v"></span>\u559c\u6b22\u7684\u4eba\u4e0a\u7ebf\u63d0\u9192</div>'),p.push('<div class="clearfix"><div class="avatar fL"><a target="_blank" href="/',url,'"><img src="',avatar,'" alt="',name,'"></a></div><div class="introlayer-inform-tips">\u60a8\u559c\u6b22\u7684&nbsp;&nbsp;<a target="_blank" href="/',url,'" class="link-lightBlue">',name,"</a>&nbsp;&nbsp;\u521a\u521a\u4e0a\u7ebf\u4e86\uff0c\u8d76\u7d27\u6253\u4e2a\u62db\u547c\u5427\u3002</div></div>"),isSuperVip||(p.push('<div class="introlayer-inform-ft"><span>\u63a5\u6536\u6240\u6709\u559c\u6b22\u7684\u4eba\u4e0a\u7ebf\u63d0\u9192\uff0c\u7acb\u5373</span><a class="btn btn-red fR" href="/pay/services" target="_blank" data-method="openvip">'),isNormalVip?p.push("\u5347\u7ea7\u9ad8\u7ea7\u4f1a\u5458"):p.push("\u5f00\u901a\u9ad8\u7ea7\u4f1a\u5458"),p.push("</a></div>")),p.push("</div>");return p.join("")}});define("utils/StorageEvent",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/Storage"),g=d(window),h={},i={},j=e.extend({init:function(){var a=!(d.browser.msie&&d.browser.version<=9);if(a)window.addEventListener?window.addEventListener("storage",this.storageChangeHandler,!1):window.attachEvent("onstorage",this.storageChangeHandler);else{f.clear();var b=this;window.setInterval(function(){var a={};for(var c in h){var d=f.get(c);if(i[c]==d)return;b.storageChangeHandler(null,c,d)}},1e3)}},storageChangeHandler:function(a,b,c){var d=function(a,b){var c=h[a];for(var d=0;d<c.length;d++)c[d](b)};b?c&&c!==""&&d(b,c):(a||(a=window.event),a.newValue&&a.newValue!==""&&d(a.key,a.newValue));for(var e in h)typeof f.get(e)=="undefined"?delete i[e]:i[e]=f.get(e)},watch:function(a,b){if(typeof a!="string"||!d.isFunction(b))return!1;h[a]?h[a].push(b):h[a]=[b];return!0},unWatch:function(){return}}),k=null;return{getInstance:function(){k===null&&(k=new j);return k}}});define("task/widget/scrollBar",function(a,b,c){var d=a("task/basic/Task"),e=a("lib/jquery"),f=a("utils/Utils");(new d("scrollBar",function(){var a=e("#scrollBar");if(a.size()!==0){var b=a.find("a"),c=a.find(".js-top"),d=e(window),f,g=function(){var a=d.scrollTop();b.removeClass("disabled"),a===0&&c.addClass("disabled")};g(),d.bind("scroll resize",function(){clearTimeout(f),f=setTimeout(g,50)}),c.bind("click",function(){d.scrollTop(0)})}})).add()});define("task/widget/feedback",function(a,b,c){var d=a("lib/jquery"),e=a("task/basic/Task"),f=a("module/message/MessageAction");(new e("feedback",function(){var a=d(".js-feedback");a.size()!==0&&a.bind("click",function(a){f.doFeedBackMessage()})})).add()});define("task/widget/linkTarget",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("task/basic/Task");!CONFIG.isMail||(new e("linkTarget",function(){var a=/.?\/pay\/?.?|.?\/park\/?.?|.?\/app\/?.?/;d(document.body).delegate("a","click",function(b){var c=d(b.currentTarget),e=c.attr("href");c.attr("target")==="_blank"&&e.indexOf("javascript")===-1&&a.test(e)&&(b.preventDefault(),window.location.target="_self",window.location.href=e)})})).add()});define("task/page/setting/setting",function(a,b,c){var d=a("lib/jquery"),e=a("task/basic/Task");(new e("Setting",function(){var b=d("#settingBox"),c=b.data("page"),e=null;switch(c){case"mobile":e=d(".js-setting");var f=a("module/setting/Mobile");new f(e);break;case"idCard":e=d(".js-setting"),$loginUserElem=d("#data_loginUser"),config={},$loginUserElem.size()>0&&(config.user=d.parseJSON($loginUserElem.html()));var g=a("module/setting/IdCard");new g(e,config);break;case"face":e=d(".js-setting");var h=a("module/setting/Face");new h(e);break;case"corp":e=d(".js-setting");var i=a("module/setting/Corp");new i(e);break;case"account":e=d(".js-setting");var j=a("module/setting/Account");new j(e);break;default:}})).add()});define("module/setting/Mobile",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/Utils"),g=a("utils/DataSource"),h=a("utils/verify/ProfileVerify"),i=a("utils/Error"),j=a("widget/tips/FastTips"),k=a("utils/Log"),l=e.extend({init:function(a,b){this.$elem=a||d(document),this.config=b||{},this.config.hasNoSubmitBtn=typeof this.config.hasNoSubmitBtn!="undefined"?this.config.hasNoSubmitBtn:!1,this.callBack=this.config.callBack||!1,this.$verifyBtn=a.find(".verify-trigger"),this.$mobileNo=a.find(".js-mobileNo"),this.$mobileCode=a.find(".js-mobileCode"),this.$genderBtn=a.find(".gender-trigger"),this.$bottomTip=a.find(".js-bottomTip"),this.$bottomBoxElem=a.find(".js-bottomBox"),this.$btnControlElem=this.$mobileNo.parents(".js-row").find(".js-btn"),this.config.hasNoSubmitBtn||(this.$submitBtn=a.find(".submit-trigger")),this.getCodeReady=!0,this.timer=null,this.verify=new h({mobile:this.$mobileNo.parents(".js-row"),mobileCode:this.$mobileCode.parents(".js-row")}),this.bindEvent()},bindEvent:function(){this.$verifyBtn.bind("click",d.proxy(this.showForm,this)),this.$genderBtn.bind("click",d.proxy(this.getCode,this)),this.config.hasNoSubmitBtn||this.$submitBtn.bind("click",d.proxy(this.submit,this)),this.$elem.bind("getCode:getting",d.proxy(this.onGetCoding,this)),this.$elem.bind("getCode:wait",d.proxy(this.onGetCodeSucceed,this)),this.$elem.bind("getCode:ready",d.proxy(this.onGetCodeError,this)),this.$elem.delegate("input","blur",d.proxy(this.checkSubmitEnable,this)),this.$elem.delegate("input","focus",d.proxy(this.resetErrorTips,this)),this.$mobileCode.bind("keyup",d.proxy(this.checkSubmitEnable,this)),this.$mobileNo.bind("change",d.proxy(this.onMobileChange,this))},preCheck:function(){return this.verify.checkAll(!0)},onMobileChange:function(){(new RegExp(f.MOBILE_REG)).test(this.$mobileNo.val())&&this.$btnControlElem.size()>0?this.$btnControlElem.removeClass("disabled"):this.$btnControlElem.addClass("disabled")},checkSubmitEnable:function(){this.config.hasNoSubmitBtn||(this.verify.checkAll(!0)?this.$submitBtn.parent().removeClass("disabled"):this.$submitBtn.parent().addClass("disabled"))},resetErrorTips:function(){f.textTips(this.$bottomTip,"hide"),this.$bottomBoxElem.hide()},onGetCoding:function(){this.getCodeReady=!1;var a=this,b=0,c=["...","",".",".."];clearInterval(this.timer),this.timer=setInterval(function(){b===4&&(b=0),a.$genderBtn.text("\u53d1\u9001\u4e2d"+c[b]),b+=1},500)},onGetCodeSucceed:function(){this.getCodeReady=!1;var a=this,b=60;clearInterval(this.timer),this.timer=setInterval(function(){b<=0?(a.getCodeReady=!0,a.$genderBtn.text("\u83b7\u53d6\u9a8c\u8bc1\u7801"),clearInterval(a.timer)):a.$genderBtn.text(b+"\u79d2\u540e\u53ef\u91cd\u65b0\u83b7\u53d6"),b-=1},1e3)},onGetCodeError:function(){this.getCodeReady=!0,clearInterval(this.timer),this.$genderBtn.text("\u83b7\u53d6\u9a8c\u8bc1\u7801")},getCode:function(a){this.$mobileNo.blur();var b=d.trim(this.$mobileNo.val());if(!(this.$btnControlElem.hasClass("disabled")||this.getCoding||this.getCodeReady===!1||b===""||!b.match(f.MOBILE_REG))){this.getCoding=!0;var c=this;this.$elem.trigger("getCode:getting"),g.postJSON("mobileCodeGender",{mobileNo:b},function(a){c.getCoding=!1;var b=parseInt(a.code);b===1?c.$elem.trigger("getCode:wait"):b===534?c.$elem.trigger("getCode:wait"):(f.textTips(c.$bottomTip,"error",i.Code(b)),c.$bottomBoxElem.show(),c.$elem.trigger("getCode:ready"))})}},getValue:function(){var a={mobileNo:this.$mobileNo.val(),mobileCode:this.$mobileCode.val()};return a},submit:function(a){var b=this;if(!!this.preCheck()&&!this.requesting){var c=this.getValue();this.requesting=!0,f.btnSending(this.$submitBtn),g.postJSON("verifyMobile",c,function(c){b.requesting=!1;var e=parseInt(c.code)||1;e!==1?(f.textTips(b.$bottomTip,"error",i.Code(e)),b.$bottomBoxElem.show()):(f.textTips(b.$bottomTip,"hide"),b.$bottomBoxElem.hide(),b.callBack?b.callBack(a):(j.show({$trigger:d(a.target),type:"success",text:"\u9a8c\u8bc1\u6210\u529f\uff01"}),setTimeout(d.proxy(b.onSuccess,b),f.tipsHideInterval))),f.btnSended(b.$submitBtn),a&&k.doLog({parameter:{method:"verifyMobile"},elem:d(a.target)})})}},showForm:function(){this.$mobileNo.val(""),this.$mobileCode.val(""),this.$elem.removeClass("verify-succeed").addClass("verify-default")},onSuccess:function(){window.location.reload()}});return l});define("module/setting/IdCard",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/Utils"),g=a("utils/verify/ProfileVerify"),h=a("utils/DataSource"),i=a("utils/Error"),j=a("widget/tips/FastTips"),k=a("widget/box/floatBox/IdCardConfirmBox"),l=a("utils/Log"),m=e.extend({init:function(a,b){this.$elem=a||d(document),this.config=b||{},this.config.hasNoSubmitBtn=typeof this.config.hasNoSubmitBtn!="undefined"?this.config.hasNoSubmitBtn:!1,this.callBack=this.config.callBack||!1,this.$name=a.find(".js-name"),this.$realName=a.find(".js-realName"),this.$idCard=a.find(".js-idCard"),this.$verifyCode=a.find(".js-verifyCode"),this.$verifyCodeTips=this.$verifyCode.parents(".js-row").find(".js-tips"),this.$codeImg=a.find(".js-codeImg"),this.$codeRefreshBtn=a.find(".codeRefresh-trigger"),this.$bottomTip=a.find(".js-bottomTip"),this.$bottomBoxElem=a.find(".js-bottomBox"),this.config.hasNoSubmitBtn||(this.$submitBtn=a.find(".submit-trigger")),this.verify=new g({realname:this.$realName.parents(".js-row"),idCard:this.$idCard.parents(".js-row"),verifyCode:this.$verifyCode.parents(".js-row")}),this.config.user&&(this.idCardConfirmBox=new k(null,{$inputElem:this.$idCard,user:this.config.user,callback:d.proxy(this.submit,this)})),this.$realName.focus(),this.refreshCode(),this.bindEvent()},bindEvent:function(){var a=this;this.$elem.find("input").bind("focus",function(){f.textTips(a.$bottomTip,"hide"),a.$bottomBoxElem.hide()}),this.$elem.delegate("input","blur",d.proxy(this.checkSubmitEnable,this)),this.$verifyCode.bind("keyup",d.proxy(this.checkSubmitEnable,this)),this.$codeRefreshBtn.bind("click",d.proxy(this.refreshCode,this)),this.config.hasNoSubmitBtn||this.$submitBtn.bind("click",d.proxy(this.onSubmit,this))},checkSubmitEnable:function(){this.config.hasNoSubmitBtn||(this.verify.checkAll(!0)?this.$submitBtn.parent().removeClass("disabled"):this.$submitBtn.parent().addClass("disabled"))},refreshCode:function(){f.textTips(this.$verifyCodeTips,"hide"),this.$codeImg.attr("src","/photo/verifyNew?rnd="+Math.random()*1e3)},onSubmit:function(a){!this.preCheck()||(this.config.user?this.idCardConfirmBox.show(a):this.submit(a),a&&l.doLog({parameter:{method:"verifyNameid"},elem:d(a.target)}))},preCheck:function(){return this.verify.checkAll(!0)},getValue:function(){var a={realName:d.trim(this.$realName.val()),idCard:d.trim(this.$idCard.val()),verifyCode:d.trim(this.$verifyCode.val())};return a},submit:function(a){var b=this;if(!this.requesting){var c=this.getValue();this.requesting=!0,f.btnSending(this.$submitBtn),h.postJSON("verifyIdCard",c,function(c){b.requesting=!1;var e=parseInt(c.code)||1;e!==1?(b.refreshCode(),f.textTips(b.$bottomTip,"error",i.Code(e)),b.$bottomBoxElem.show()):(f.textTips(b.$bottomTip,"hide"),b.$bottomBoxElem.hide(),b.callBack?b.callBack(a):(j.show({$trigger:d(a.target),type:"success",text:"\u9a8c\u8bc1\u6210\u529f\uff01"}),setTimeout(d.proxy(b.onSuccess,b),f.tipsHideInterval))),f.btnSended(b.$submitBtn)})}},onSuccess:function(){this.$elem.removeClass("verify-default").addClass("verify-succeed"),this.$name.html(this.$realName.val())}});return m});define("widget/box/floatBox/IdCardConfirmBox",function(a,b,c){var d=a("lib/jquery"),e=a("widget/box/floatBox/Box"),f=a("utils/tmpl"),g=a("utils/DataSource"),h=a("utils/Log"),i=e.extend({init:function(a,b){this._super(a,b),this.$inputElem=b.$inputElem,this.user=b.user||{},this.callback=b.callback||!1,this.data.type="warning",this.data.cancelBtnText="\u5173\u95ed",this.data.content=""},preRender:function(){return{title:"\u4fe1\u606f\u786e\u8ba4",bodyContent:f.formatTemplate(a("template/floatbox/confirmBox"),this.data)}},bindEvent:function(){this._super(),this.$elem.delegate(".submit-trigger","click",d.proxy(this.onSubmit,this))},formatBirthday:function(a){if(!a)return!1;var b=parseInt(a[1])<10?"0"+a[1]:a[1],c=parseInt(a[2])<10?"0"+a[2]:a[2];return String(a[0])+b+c},splitBirthday:function(a){return typeof a=="string"&&a.length===8?[a.substr(0,4),a.substr(4,2),a.substr(6,2)]:[]},show:function(b){var c=d.trim(this.$inputElem.val()),e=this.user.sex||0,g=this.formatBirthday(this.user.birthday)||0,i=c.length===15?"19"+c.substr(6,6):c.substr(6,8),j=c.substr(c.length-2,1);j%2===e%2&&i===g?this.onSubmit(b):(this._super(),j%2!==e%2&&i!==g?this.data.content="\u7531\u4e8e\u4f60\u586b\u5199\u7684\u8eab\u4efd\u8bc1\u53f7\u548c\u4e4b\u524d\u586b\u5199\u7684\u751f\u65e5\u3001\u6027\u522b\u4e0d\u7b26\uff0c\u7cfb\u7edf\u5c06\u81ea\u52a8\u6839\u636e\u60a8\u7684\u8eab\u4efd\u8bc1\u53f7\u7801\u63d0\u53d6\u60a8\u7684\u751f\u65e5\u548c\u6027\u522b":i!==g?this.data.content='\u7531\u4e8e\u4f60\u586b\u5199\u7684\u8eab\u4efd\u8bc1\u53f7\u548c\u4e4b\u524d\u586b\u5199\u7684\u751f\u65e5\u4e0d\u7b26\uff0c\u7cfb\u7edf\u5c06\u81ea\u52a8\u6839\u636e\u60a8\u7684\u8eab\u4efd\u8bc1\u53f7\u7801\u63d0\u53d6\u60a8\u7684\u751f\u65e5<span class="text-red">'+this.splitBirthday(i).join("-")+"</span>":j%2!==e%2&&(this.data.content="\u7531\u4e8e\u4f60\u586b\u5199\u7684\u8eab\u4efd\u8bc1\u53f7\u548c\u4e4b\u524d\u586b\u5199\u7684\u6027\u522b\u4e0d\u7b26\uff0c\u7cfb\u7edf\u5c06\u81ea\u52a8\u6839\u636e\u60a8\u7684\u8eab\u4efd\u8bc1\u53f7\u7801\u63d0\u53d6\u60a8\u7684\u6027\u522b"),this.$elem.find(".js-body").html(f.formatTemplate(a("template/floatbox/confirmBox"),this.data)),b&&h.doLog({parameter:{method:"verifysex"},elem:d(b.target)}))},postRender:function(){this._super(),this.$elem.addClass("poplayer-idCard")},onSubmit:function(a){this.callback&&this.callback(a),a&&h.doLog({parameter:{method:"verifiedsex"},elem:d(a.target)}),this.hide()}});return i});define("module/setting/Face",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/Utils"),g=a("lib/swfobject"),h=a("utils/Cookie"),i=a("utils/DataSource"),j=a("model/UserData"),k=a("widget/AvatarCropper"),l=a("utils/Log"),m=a("widget/box/floatBox/TipsBox"),n=a("utils/Error"),o=a("widget/tips/FastTips"),p=e.extend({init:function(a,b){d(window).scrollTop(0),this.$elem=a||d(document),this.$tips=a.find(".js-tips"),this.$errorTips=a.find(".js-errorTips"),this.tipStatus=this.$tips.data("status"),this.avatarMethod="advancedAvatar",this.$advancedElem=this.$elem.find(".advanced-trigger"),this.$normalElem=this.$elem.find(".normal-trigger"),this.bindEvent(),this.tipsInit(),this.initCropper()},tipsInit:function(){parseInt(h.get("avatarTipClose"))!==this.tipStatus&&this.$tips.removeClass("hidden")},bindEvent:function(){var a=this;this.$advancedElem.bind("click",function(b){a.$elem.removeClass("uploadAvatar-common"),a.avatarMethod="advancedAvatar"}),this.$normalElem.bind("click",function(b){a.$elem.addClass("uploadAvatar-common"),a.avatarMethod="basicAvatar"}),this.$tips.delegate(".close-trigger","click",d.proxy(this.tipsClose,this))},initCropper:function(){var a=this,b=d("#avatarUpload");new k(b,{callback:d.proxy(this.updateAvatar,this),avatar:f.userAvatar(j.getLoginUser().avatar,250,j.getLoginUser().sex)||!1,enforceFlash:!0,flashSize:"big",keyfrom:"pS_face"}),b.trigger("cropper:Ready"),b.bind("avatarCropperEvent",function(b,c){a.cropperEventHandler(c)})},cropperEventHandler:function(a){switch(a){case"avatar:selected":l.send("/page.do?method="+this.avatarMethod+".loadphoto&keyfrom=pS_face");break;default:}},updateAvatar:function(a){if(!d.isPlainObject(this.request)||this.request.readyState===4){var b=this;this.request=i.postJSON("updateAvatar",{avatar:a},function(a){var c=new m(null,{data:{type:"correct",text:"\u63d0\u4ea4\u6210\u529f\uff01"}});c.show(),c.delayHide(f.tipsHideInterval),setTimeout(function(){location.href="/"+j.getLoginUser().url},f.tipsHideInterval),l.send("/page.do?method="+b.avatarMethod+".updataphoto&keyfrom=pS_face")})}},tipsClose:function(){this.$tips.addClass("hidden"),h.set("avatarTipClose",this.tipStatus)},onSuccess:function(){this.$tips.removeClass("hidden")}});return p});define("widget/AvatarCropper",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("utils/Utils"),f=a("basic/Class"),g=a("utils/DataSource"),h=a("utils/ImageCropper"),i=a("widget/avatar/HTML5Cropper"),j=a("widget/avatar/FlashCropper"),k=a("widget/avatar/NormalAvatar"),l=a("utils/tmpl"),m=f.extend({init:function(a,b){this.$elem=a||d(document.body),this.callback=b.callback||!1,this.flashSize=b.flashSize||"big",this.avatar=b.avatar||!1,this.btnText=b.btnText||"\u63d0\u4ea4\uff0c\u5b8c\u6210",this.config=d.extend({eventHandler:d.proxy(this.eventHandler,this)},b),this.$advancedElem=d('<div class="uploadAvatar-flash avatarCropper-big js-advanced"><div class="js-container" id="'+e.S4()+'"></div></div>').prependTo(this.$elem),this.$normalElem=d('<div class="js-normal"></div>').prependTo(this.$elem),this.$elem.bind("cropper:Ready",d.proxy(this.initModules,this)),this.$errorTips=this.$elem.find(".js-errorTips")},initModules:function(){if(location.hash==="#html5")var a=new i(this.$advancedElem.find(".js-container"),this.config);else if(this.config.enforceFlash)var b=new j(this.$advancedElem.find(".js-container"),this.config);var c=new k(this.$normalElem,this.config)},eventHandler:function(a){this.$elem.trigger("avatarCropperEvent","avatar:"+a);switch(a){case"empty":e.textTips(this.$errorTips,"warning","\u8bf7\u9009\u62e9\u7167\u7247");break;case"typeError":e.textTips(this.$errorTips,"warning","\u6587\u4ef6\u7c7b\u578b\u9519\u8bef\uff01");break;case"IOError":e.textTips(this.$errorTips,"warning","\u7f51\u7edc\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5");break;case"uploadError":e.textTips(this.$errorTips,"warning","\u4e0a\u4f20\u51fa\u9519\uff0c\u8bf7\u91cd\u8bd5");break;case"uploading":this.$errorTips.removeClass("hidden").find(".js-text").html('<span><em class="icon-loading-s"></em>\u6b63\u5728\u4e0a\u4f20\u4e2d...</span>');break;case"sizeError":e.textTips(this.$errorTips,"error","\u7167\u7247\u5927\u5c0f\u4e0d\u5728\u89c4\u5b9a\u8303\u56f4");break;case"wrongWH":e.textTips(this.$errorTips,"warning","\u60a8\u5f53\u524d\u9009\u62e9\u7684\u533a\u57df\u8fc7\u5c0f\uff0c\u5934\u50cf\u53ef\u80fd\u4f1a\u6a21\u7cca\u800c\u5bfc\u81f4\u5ba1\u6838\u4e0d\u901a\u8fc7");break;case"correctWH":e.textTips(this.$errorTips,"hide");break;case"select":e.textTips(this.$errorTips,"hide");break;case"selected":e.textTips(this.$errorTips,"hide");break;default:try{var b=d.parseJSON(a);b.originalURL?(e.textTips(this.$errorTips,"hide"),this.callback(b.originalURL)):e.textTips(this.$errorTips,"warning","\u4e0a\u4f20\u51fa\u9519\uff0c\u8bf7\u91cd\u8bd5")}catch(c){e.textTips(this.$errorTips,"warning","\u4e0a\u4f20\u51fa\u9519\uff0c\u8bf7\u91cd\u8bd5")}}}});return m});define("utils/ImageCropper",function(a,b,c){var d=function(a,b,c,d){this.width=a,this.height=b,this.cropWidth=c,this.cropHeight=d,this.image=null,this.imageCanvas=null,this.imageContext=null,this.imageScale=1,this.imageRotation=0,this.imageLeft=0,this.imageTop=0,this.imageViewLeft=0,this.imageViewTop=0,this.canvas=null,this.context=null,this.previews=[],this.maskGroup=[],this.maskAlpha=.4,this.maskColor="#000",this.cropLeft=0,this.cropTop=0,this.cropViewWidth=c,this.cropViewHeight=d,this.cropBorderColor="#F33",this.dragSize=7,this.dragColor="#FFF",this.dragLeft=0,this.dragTop=0,this.mouseX=0,this.mouseY=0,this.inCropper=!1,this.inDragger=!1,this.isMoving=!1,this.isResizing=!1,this.mouseStartX=0,this.mouseStartY=0,this.cropStartLeft=0,this.cropStartTop=0,this.cropStartWidth=0,this.cropStartHeight=0};d.prototype.setCanvas=function(a){this.canvas=document.getElementById(a)||a,this.context=this.canvas.getContext("2d"),this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.oncontextmenu=this.canvas.onselectstart=function(){return!1},this.imageCanvas=document.createElement("canvas"),this.imageContext=this.imageCanvas.getContext("2d"),this.imageCanvas.width=this.width,this.imageCanvas.height=this.height,this.sourceCanvas=document.createElement("canvas"),this.sourceContext=this.sourceCanvas.getContext("2d")},d.prototype.addPreview=function(a){var b=document.getElementById(a)||a,c=b.getContext("2d");this.previews.push(c)},d.prototype.loadImage=function(a){if(!!this.isAvaiable()&&!!this.isImage(a)){var b=new FileReader,c=this;b.readAsDataURL(a),b.onload=function(a){c.image||(c.image=new Image),c.image.onload=function(a){c._init()},c.image.src=a.target.result}}},d.prototype._init=function(){var a=Math.min(this.width/this.image.width,this.height/this.image.height);a>1&&(a=Math.min(this.cropViewWidth/this.image.width,this.cropViewHeight/this.image.height)),this.image.width*a<this.cropViewWidth&&(a=Math.min(a,this.cropViewWidth/this.image.width)),this.image.height*a<this.cropViewHeight&&(a=Math.min(a,this.cropViewHeight/this.image.height)),this.imageViewLeft=this.imageLeft=(this.width-this.image.width*a)/2,this.imageViewTop=this.imageTop=(this.height-this.image.height*a)/2,this.imageScale=a,this.imageRotation=0;var b=Math.min(this.image.width*a,this.image.height*a);this.cropViewWidth=Math.min(b,this.cropWidth),this.cropViewHeight=Math.min(b,this.cropHeight),this.cropLeft=(this.width-this.cropViewWidth)/2,this.cropTop=(this.height-this.cropViewHeight)/2,this.dragLeft=this.cropLeft+this.cropViewWidth-this.dragSize/2,this.dragTop=this.cropTop+this.cropViewHeight-this.dragSize/2,this.callback&&this.callback("loaded"),this._update();var c=this;this.canvas.onmousedown=function(a){c._mouseHandler.call(c,a)},this.canvas.onmouseup=function(a){c._mouseHandler.call(c,a)},this.canvas.onmousemove=function(a){c._mouseHandler.call(c,a)}},d.prototype._mouseHandler=function(a){if(a.type==="mousemove"){var b=this.canvas.getClientRects()[0],c=document.body.scrollTop||document.documentElement.scrollTop,d=document.body.scrollLeft||document.documentElement.scrollLeft;this.mouseX=a.pageX-b.left-d,this.mouseY=a.pageY-b.top-c,this._checkMouseBounds(),this.canvas.style.cursor=this.inCropper||this.isMoving?"move":this.inDragger||this.isResizing?"se-resize":"",this.isMoving?this._move():this.isResizing?this._resize():null}else a.type==="mousedown"?(this.mouseStartX=this.mouseX,this.mouseStartY=this.mouseY,this.cropStartLeft=this.cropLeft,this.cropStartTop=this.cropTop,this.cropStartWidth=this.cropViewWidth,this.cropStartHeight=this.cropViewHeight,this.inCropper?this.isMoving=!0:this.inDragger?this.isResizing=!0:null):a.type==="mouseup"&&(this.isMoving=this.isResizing=!1)},d.prototype._checkMouseBounds=function(){this.inCropper=this.mouseX>=this.cropLeft&&this.mouseX<=this.cropLeft+this.cropViewWidth&&this.mouseY>=this.cropTop&&this.mouseY<=this.cropTop+this.cropViewHeight,this.inDragger=this.mouseX>=this.dragLeft&&this.mouseX<=this.dragLeft+this.dragSize&&this.mouseY>=this.dragTop&&this.mouseY<=this.dragTop+this.dragSize,this.inCropper=this.inCropper&&!this.inDragger},d.prototype._move=function(){var a=this.mouseX-this.mouseStartX,b=this.mouseY-this.mouseStartY;this.cropLeft=Math.max(this.imageViewLeft,this.cropStartLeft+a),this.cropLeft=Math.min(this.cropLeft,this.width-this.imageViewLeft-this.cropViewWidth),this.cropTop=Math.max(this.imageViewTop,this.cropStartTop+b),this.cropTop=Math.min(this.cropTop,this.height-this.imageViewTop-this.cropViewHeight),this.dragLeft=this.cropLeft+this.cropViewWidth-this.dragSize/2,this.dragTop=this.cropTop+this.cropViewHeight-this.dragSize/2,this._update()},d.prototype._resize=function(){var a=Math.min(this.mouseX-this.mouseStartX,this.mouseY-this.mouseStartY),b=Math.max(10,this.cropStartWidth+a),c=Math.max(10,this.cropStartHeight+a),b=Math.min(b,this.width-this.cropStartLeft-this.imageViewLeft),c=Math.min(c,this.height-this.cropStartTop-this.imageViewTop);this.cropViewWidth=this.cropViewHeight=Math.round(Math.min(b,c)),this.dragLeft=this.cropLeft+this.cropViewWidth-this.dragSize/2,this.dragTop=this.cropTop+this.cropViewHeight-this.dragSize/2,this._update()},d.prototype.rotate=function(a){if(!!this.image){this.imageRotation+=a;var b=Math.abs(this.imageRotation%180)===90;this.imageViewLeft=b?this.imageTop:this.imageLeft,this.imageViewTop=b?this.imageLeft:this.imageTop,this.cropLeft=(this.width-this.cropViewWidth)/2,this.cropTop=(this.height-this.cropViewHeight)/2,this.dragLeft=this.cropLeft+this.cropViewWidth-this.dragSize/2,this.dragTop=this.cropTop+this.cropViewHeight-this.dragSize/2,this._update()}},d.prototype._update=function(){this.context.clearRect(0,0,this.width,this.height),this._drawImage(),this._drawMask(),this._drawDragger();var a=this;clearTimeout(this.timer),this.timer=setTimeout(function(){a._drawPreview()},100)},d.prototype._drawImage=function(){this._rotateImage(this.imageCanvas.getContext("2d"),this.width,this.height,this.imageScale),this.context.drawImage(this.imageCanvas,0,0)},d.prototype._rotateImage=function(a,b,c,d){a.clearRect(0,0,b,c),a.save();var e=this.imageRotation%360;d&&d!==1&&(a.translate(this.imageViewLeft,this.imageViewTop),a.scale(d,d)),a.rotate(this.imageRotation*Math.PI/180);switch((360-e)%360){case 90:a.drawImage(this.image,-this.image.width,0);break;case 180:a.drawImage(this.image,-this.image.width,-this.image.height);break;case 270:a.drawImage(this.image,0,-this.image.height);break;case 0:break;default:a.drawImage(this.image,0,0)}a.restore()},d.prototype._drawPreviewBig=function(){this.callback&&this.callback("busy"),Math.abs(this.imageRotation%180)===90?(this.sourceCanvas.width=this.image.height,this.sourceCanvas.height=this.image.width):(this.sourceCanvas.width=this.image.width,this.sourceCanvas.height=this.image.height);var a=this.imageScale,b=this.previews[0];this._rotateImage(this.sourceContext,this.image.width,this.image.height,1),b.drawImage(this.sourceCanvas,(this.cropLeft-this.imageViewLeft)/a,(this.cropTop-this.imageViewTop)/a,this.cropViewWidth/a,this.cropViewHeight/a,0,0,b.canvas.width,b.canvas.height),this.callback&&this.callback("done")},d.prototype._drawPreview=function(){this.callback&&this.callback("busy");for(var a=0;a<this.previews.length;a++){var b=this.previews[a];b.clearRect(0,0,b.canvas.width,b.canvas.height),b.save(),b.drawImage(this.imageCanvas,this.cropLeft,this.cropTop,this.cropViewWidth,this.cropViewHeight,0,0,b.canvas.width,b.canvas.height),b.restore()}this.callback&&this.callback("done"),this._drawPreviewBig()},d.prototype._drawMask=function(){this._drawRect(this.cropLeft,this.cropTop,this.cropViewWidth,this.cropViewHeight,null,this.cropBorderColor,this.maskAlpha)},d.prototype._drawDragger=function(){this._drawRect(this.dragLeft,this.dragTop,this.dragSize,this.dragSize,null,this.dragColor,null)},d.prototype._drawRect=function(a,b,c,d,e,f,g){this.context.save(),e!==null&&(this.context.fillStyle=e),f!==null&&(this.context.strokeStyle=f),g!==null&&(this.context.globalAlpha=g),this.context.beginPath(),this.context.rect(a,b,c,d),this.context.closePath(),e!==null&&this.context.fill(),f!==null&&this.context.stroke(),this.context.restore()},d.prototype.getCroppedImageData=function(a,b,c){Math.abs(this.imageRotation%180)===90?(this.sourceCanvas.width=this.image.height,this.sourceCanvas.height=this.image.width):(this.sourceCanvas.width=this.image.width,this.sourceCanvas.height=this.image.height),this._rotateImage(this.sourceContext,this.image.width,this.image.height,1);var d=this.imageScale,e=document.createElement("canvas");e.width=a||this.cropViewWidth/d,e.height=a||this.cropViewHeight/d,e.getContext("2d").drawImage(this.sourceCanvas,(this.cropLeft-this.imageViewLeft)/d,(this.cropTop-this.imageViewTop)/d,e.width,e.height,0,0,e.width,e.height);return e.toDataURL(c||"image/jpeg")},d.prototype.isAvaiable=function(){return typeof FileReader!="undefined"},d.prototype.isImage=function(a){return/image/i.test(a.type)};return d});define("widget/avatar/HTML5Cropper",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("basic/Class"),f=a("model/UserData"),g=a("utils/tmpl"),h=a("utils/Utils"),i=a("utils/Error"),j=a("utils/ImageCropper"),k=a("widget/tips/FastTips"),l=e.extend({init:function(a,b){this.$elem=a||d(document.body),this.eventHandler=b.eventHandler||!1,this.callback=b.callback||!1,this.avatar=b.avatar||!1,this.btnText=b.btnText||"\u63d0\u4ea4\uff0c\u5b8c\u6210",this.ImageCropper=new j(375,375,240,240),this.initModule(),this.bindEvent()},initModule:function(){var b=this;this.$elem.html(g.formatTemplate(a("template/widget/avatar/avatarCropper"),{btnText:this.btnText})),this.$fileInput=this.$elem.find(".js-fileInput"),this.$browserBtn=this.$elem.find(".js-browserBtn"),this.$reloadBtn=this.$elem.find(".js-reloadBtn"),this.$saveBtn=this.$elem.find(".js-saveBtn").addClass(".js-disabled").css({background:"#C7C7C7"}),this.$rotateBar=this.$elem.find(".js-rotateBar"),this.$loading=this.$elem.find(".js-loading"),this.ImageCropper.setCanvas("cropper"),this.ImageCropper.addPreview("previewBig"),this.ImageCropper.addPreview("previewSmall"),this.ImageCropper.callback=d.proxy(this.ImageCropperHandler,this),this.avatar&&this.currentAvatar()},bindEvent:function(){var a=this;this.$browserBtn.live("click",function(b){a.$fileInput.click()}),this.$reloadBtn.live("click",function(b){a.$fileInput.click()}),this.$fileInput.live("change",function(b){var c=b.target.files[0];(new RegExp(/(jpg)|(jpeg)|(png)|(gif)$/i)).test(c.name)?c&&a.checkFileFormat(c)&&(a.eventHandler&&a.eventHandler("selected"),a.ImageCropper.loadImage(c),a.$rotateBar.show(),a.$browserBtn.hide(),a.$saveBtn.removeClass(".js-disabled").css({background:"#F33"}),a.$loading.show()):a.eventHandler&&a.eventHandler("typeError")}),this.$rotateBar.delegate("a","click",d.proxy(this.rotateImage,this)),this.$saveBtn.live("click",d.proxy(this.uploadImage,this))},checkFileFormat:function(a){if(a&&(a.size<51200||a.size>4194304)){this.eventHandler&&this.eventHandler("sizeError");return!1}return!0},binaryToBlob:function(a){var b=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;bb=new b;var c=new Uint8Array(a.length);for(var d=0,e=a.length;d<e;d++)c[d]=a.charCodeAt(d);bb.append(c.buffer);return bb.getBlob()},dataUrlToBlob:function(a){var b=a.split(",",2),c=this.binaryToBlob(atob(b[1]));c.fileType=b[0].split(";")[0].split(":")[1],c.name=c.fileName="pic."+c.fileType.split("/")[1];return c},rotateImage:function(a){var b=d(a.target).parents("a").andSelf().attr("id");switch(b){case"rotateLeftBtn":this.ImageCropper.rotate(-90);break;case"rotateRightBtn":this.ImageCropper.rotate(90)}},uploadImage:function(){var a=this;if(!this.$saveBtn.hasClass(".js-disabled")){this.$saveBtn.html("\u63d0\u4ea4\u4e2d...");var b=this.ImageCropper.getCroppedImageData(),c=new XMLHttpRequest,e=new FormData,f,g=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;f=new g,f.append(this.dataUrlToBlob(b)),e.append("file",f.getBlob("image/jpeg"),"0.jpg"),c.open("POST","/upload",!0),c.send(e),c.onload=function(){var b=d.parseJSON(c.responseText);b.originalURL?(a.$saveBtn.html(a.btnText),a.callback(b.originalURL)):a.eventHandler&&a.eventHandler("uploadError")},c.onerror=function(){}}},ImageCropperHandler:function(a){a==="loaded"?this.$loading.hide():a==="busy"?this.$loading.show():a==="done"&&this.$loading.hide()},currentAvatar:function(){var a=d("#previewBig"),b=d("#previewSmall"),c=a[0].getContext("2d"),e=b[0].getContext("2d"),f=new Image;f.src=this.avatar,f.onload=function(){c.drawImage(f,0,0,a.width(),a.height()),e.drawImage(f,0,0,b.width(),b.height())}}});return l});define("template/widget/avatar/avatarCropper",function(require){return function(tmplData){var p=[];with(tmplData)p.push(""),typeof corpperType!="undefined"&&corpperType==="normal"?p.push('<div class="uploadAvatar-commonBox"><div class="uploadAvatar-common-avatar"><img class="js-avatar" src=""/><i class="uploadAvatar-image-middle"></i><div class="loadingBox loadingBox-s js-state"></div></div><div class="uploadAvatar-common-again"><a class="link-lightBlue hidden uploadAgain-trigger" href="javascript:;">\u91cd\u65b0\u4e0a\u4f20</a></div><div class="uploadAvatar-btn n-btn-box"><div class="disabled"><a class="btnB btn-red n-btn-sure submit-trigger" href="javascript:;">',btnText||"\u63d0\u4ea4\uff0c\u5b8c\u6210","</a></div></div></div>"):p.push('<input class="avatarCropper-fileInput js-fileInput" style="visibility: hidden;position:absolute;" type="file" size="10" multiple accept="image/gif,image/png,image/jpg,image/jpeg,image/bmp"/><div class="avatarCropper-wrapper"><div class="avatarCropper-loading js-loading">\u52a0\u8f7d\u4e2d...</div><canvas class="avatarCropper-cropper" width="375" height="375" id="cropper"></canvas><span class="avatarCropper-selectBtn js-browserBtn"><!--<input class="avatarCropper-fileInput js-fileInput" type="file" size="10" multiple accept="image/gif,image/png,image/jpg,image/jpeg,image/bmp"/>--><em class="upload-item-icon-add"></em>\u4ece\u7535\u8111\u4e0a\u9009\u53d6\u7167\u7247</span><div class="avatarCropper-rorateBar js-rotateBar" style="display: none;"><a class="avatarCropper-reloadBtn js-reloadBtn" href="javascript:;"><!--<input class="avatarCropper-fileInput js-fileInput" type="file" size="10" multiple accept="image/gif,image/png,image/jpg,image/jpeg,image/bmp"/>-->          \u91cd\u65b0\u4e0a\u4f20</a><a class="avatarCropper-rotateLeftBtn" id="rotateLeftBtn" href="javascript:;"><em class="avatarCropper-leftArrow"></em><span>\u5de6\u8f6c90\u5ea6</span></a><a class="avatarCropper-rotateRightBtn" id="rotateRightBtn" href="javascript:;"><span>\u53f3\u8f6c90\u5ea6</span><em class="avatarCropper-rightArrow"></em></a></div><div class="avatarCropper-previewContainer"><div class="avatarCropper-preview"><canvas id="previewBig" width="240" height="240"></canvas><!--<span>\u5f62\u8c61\u7167</span>--></div><div class="avatarCropper-preview avatarCropper-preview-small"><canvas id="previewSmall" width="70" height="70"></canvas><!--<span>\u5c0f\u5934\u50cf</span>--></div><div class="avatarCropper-btnArea"><a class="btnB btn-red js-saveBtn" href="javascript:;" data-btnText="',btnText,'">',btnText,"</a></div></div></div>"),p.push("");return p.join("")}});define("widget/avatar/FlashCropper",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=a("model/UserData"),g=a("utils/tmpl"),h=a("utils/Utils"),i=a("utils/Error"),j=a("utils/ImageCropper"),k=a("widget/tips/FastTips"),l=e.extend({init:function(a,b){this.$elem=a||d(document.body),this.eventHandler=b.eventHandler||!1,this.callback=b.callback||!1,this.flashSize=b.flashSize||"big",this.avatar=b.avatar||!1,this.btnText=b.btnText||"\u63d0\u4ea4\uff0c\u5b8c\u6210",this.config=b||{},window.flashEventHandler=d.proxy(this.eventHandler,this),this.initModule()},initModule:function(){var b=this,c=!0,d=this.config.keyfrom||"pHome",e={url:"http://static.t.126.net/frontend/flash/avatar/avatarCropperB_"+h.AVATAR_VER+".swf",id:this.$elem.attr("id"),width:this.config.width||525,height:this.config.height||467,params:{flashvars:"saveUrl=http://"+location.host+"/upload&maxSize="+h.MAX_PICSIZE+"&minSize="+h.MIN_PICSIZE,allowScriptAccess:"always",wmode:"transparent"}};c&&(e.params.flashvars+="&errAnalyse=true&keyfrom="+d),this.avatar&&(e.params.flashvars+="&urlPic="+encodeURIComponent(this.avatar)),this.btnText&&(e.params.flashvars+="&saveBtnText="+encodeURIComponent(this.btnText)),a("lib/swfobject").embedSWF(e.url,e.id,e.width,e.height,"10.1.0","","",e.params,"",function(a){a.success||b.$elem.html('<br /><a href="http://www.adobe.com/go/getflashplayer" target="_blank"><img src="http://img2.cache.netease.com/love/image/project/tips/get_flash_player.gif" alt="\u83b7\u53d6 flash \u64ad\u653e\u5668"></a><br /><h1>\u60a8\u5c1a\u672a\u5b89\u88c5flash\u63d2\u4ef6\uff0c\u8bf7\u5b89\u88c5flash\u63d2\u4ef6</h1>')})}});return l});define("widget/avatar/NormalAvatar",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("basic/Class"),f=a("model/UserData"),g=a("utils/tmpl"),h=a("utils/Utils"),i=a("utils/OimageUrl"),j=a("utils/Error"),k=a("widget/tips/FastTips"),l=e.extend({init:function(a,b){this.$elem=a,this.eventHandler=b.eventHandler||!1,this.callback=b.callback||!1,this.avatar=b.avatar||!1,this.newAvatar="",this.btnText=b.btnText||"\u63d0\u4ea4\uff0c\u5b8c\u6210",this.initModule(),this.bindEvent()},bindEvent:function(){this.$saveBtn.bind("click",d.proxy(this.submitAvatar,this))},initModule:function(){this.$elem.html(g.formatTemplate(a("template/widget/avatar/avatarCropper"),{corpperType:"normal",btnText:this.btnText})),this.$state=this.$elem.find(".js-state"),this.$avatar=this.$elem.find(".js-avatar"),this.$uploadAgainElem=this.$elem.find(".uploadAgain-trigger"),this.$saveBtn=this.$elem.find(".submit-trigger"),this.avatar&&(this.$uploadAgainElem.removeClass("hidden"),this.$avatar.attr("src",this.avatar));var b=this.$elem.find(".upload-trigger, .uploadAgain-trigger"),c=null;window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData?c=a("utils/upload/Html5Upload"):c=a("utils/upload/IframeUpload"),this.uploader=new c(b,{isShowProgress:!0,isMouseMoveForm:!0,$container:this.$elem.find(".js-avatar").parent(),onSelect:d.proxy(this.onUploadSelete,this),onSuccess:d.proxy(this.onUploadSuccess,this),onFail:d.proxy(this.onUploadFail,this),onLoading:d.proxy(this.onUploadLoading,this),onLoaded:d.proxy(this.onUploadLoaded,this)})},onUploadSelete:function(){this.eventHandler&&this.eventHandler("select")},onUploadSuccess:function(a,b){this.$saveBtn.parent().removeClass("disabled"),b.originalURL?(this.newAvatar=b.originalURL,this.$avatar.attr("src",i(this.newAvatar,250,250)),this.eventHandler&&this.eventHandler("selected")):this.eventHandler&&this.eventHandler("uploadError")},submitAvatar:function(){this.newAvatar===""?this.eventHandler&&this.eventHandler("empty"):this.callback&&this.callback(this.newAvatar)},onUploadFail:function(a){this.eventHandler&&this.eventHandler(a)},onUploadLoading:function(){this.$uploadAgainElem.addClass("hidden"),this.$state.html('<span style="color: #000;">\u6b63\u5728\u4e0a\u4f20\u4e2d...</span>').show()},onUploadLoaded:function(){this.$state.hide(),this.$uploadAgainElem.removeClass("hidden")}});return l});define("utils/upload/Html5Upload",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("utils/upload/Upload"),f=a("utils/Utils"),g=e.extend({bindEvent:function(){this._super(),this.$elem.delegate(".js-drag","dragover",d.proxy(this.onDragOver,this)).delegate(".js-drag","dragleave",d.proxy(this.onDragLeave,this)).delegate(".js-drag","drop",d.proxy(this.onDrop,this))},onSelect:function(a){this.config.onSelect(),this.file=undefined;var b=a.originalEvent.target.files||a.originalEvent.dataTransfer.files,c=b[0];!!c&&!!this.onFilter(c)&&(this.$inputFile.val(null),this.onShowThumb(c),this.config.onLoading(),this.onUpload())},onFilter:function(a){var b,c=a.name.lastIndexOf(".");b=a.name.substring(c+1,a.name.length).toLocaleLowerCase();if(a.type.indexOf("image")===-1||d.inArray(b,g.IMAGE_FORMAT)===-1){this.config.onFail("typeError");return!1}if(a.size<f.MIN_PICSIZE||a.size>f.MAX_PICSIZE){this.config.onFail("sizeError");return!1}this.file=a;return!0},onShowThumb:function(a){var b=this,c=new FileReader;c.onload=function(a){b.config.$container.find(".js-thumb").attr("src",a.target.result).show()},c.readAsDataURL(a),this.config.onShowThumb()},onUpload:function(){var a=this.file,b=this,c=new XMLHttpRequest;if(c.upload){this.config.isShowProgress&&this.createProgress(),c.upload.addEventListener("progress",function(c){b.uploading(a,c.loaded,c.total)}),c.onreadystatechange=function(d){c.readyState===4&&(b.config.onLoaded(),c.status===200?b.onSuccess(a,c.responseText):b.onError(a))},c.open("POST","/upload",!0);var d=encodeURIComponent(a.name);c.setRequestHeader("X_FILENAME",d);var e=new FormData;e.append("fileToUpload",a),c.send(e)}},createProgress:function(){this.$progress||(this.$progress=d('<div class="upload-item-progress">\n               <span class="js-percent">\n                  <b class="js-percent-text"></b>\n               </span>\n            </div>'),this.$progress.appendTo(this.config.$container)),this.$progress.find(".js-percent").css("width","0%").end().show()},hideProgress:function(){this.$progress.hide()},uploading:function(a,b,c){var d=(b/c*100).toFixed(1);d=d>99?100:parseInt(d),this.$progress.find(".js-percent").css("width",d+"%").find(".js-percent-text").text(d+"%")},onSuccess:function(a,b){this._super(a,b),this.config.isShowProgress&&this.hideProgress()},onError:function(a){this.config.onFail("IOError")},onDragOver:function(a){this.dragTimer&&clearTimeout(this.dragTimer),a.stopPropagation(),a.preventDefault()},onDragLeave:function(a){a.stopPropagation(),a.preventDefault()},onDrop:function(a){this.onDragLeave(a),this.onSelect(a)}});g.IMAGE_FORMAT=["jpg","jpeg","gif","png","bmp"];return g});define("utils/upload/Upload",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/tmpl"),g=e.extend({defaults:{isMouseMoveForm:!1,isShowProgress:!1,onSelect:function(){},onShowThumb:function(){},onLoading:function(){},onLoaded:function(){},onSuccess:function(){},onFail:function(){}},init:function(a,b){this.$elem=a,this.config=d.extend({},this.defaults,b),this.$upload=this.config.$upload||null,this.render(),this.postRender(),this.bindEvent()},render:function(){this.config.isMouseMoveForm&&(this.$upload=d(f.formatTemplate(a("template/widget/upload/uploadForm"),{count:0,accept:0})),this.$upload.appendTo("body"))},postRender:function(){this.$inputFile=this.$upload.find("input[type=file]"),this.$form=this.$upload.andSelf().find("form")},bindEvent:function(){this.config.isMouseMoveForm&&this.$elem.bind("mousemove",d.proxy(this.onTriggerMove,this)),this.$inputFile.bind("change",d.proxy(this.onSelect,this))},onTriggerMove:function(a){this.$form.css({left:a.pageX-4,top:a.pageY-4})},onSelect:function(a){throw"Abrstrat Method!!!"},onFilter:function(a){throw"Abrstrat Method!!!"},onUpload:function(){throw"Abrstrat Method!!!"},onSuccess:function(a,b){b=d.parseJSON(b),this.config.onSuccess(a,b)},onError:function(a){this.config.onFail("")}});return g});define("template/widget/upload/uploadForm",function(require){return function(tmplData){var p=[];with(tmplData)p.push('<div id="fileUploadHandler"><form class="upload-form" target="sendImage',count,'" action="/upload" method="POST" accept-charset="utf-8" encType="multipart/form-data"><input type="hidden" name="callback" value="uploadImage"/><input type="file" name="Filedata" class="file-input" '),accept&&p.push('accept="',accept,'"'),p.push('/><input type="submit" class="hidden"/></form><iframe class="hidden" name="sendImage',count,'"></iframe></div>');return p.join("")}});define("utils/upload/IframeUpload",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("utils/upload/Upload"),f=e.extend({init:function(a,b){this._super(a,b)},postRender:function(){this._super(),this.$form.attr("action","/upload")},onSelect:function(){this.config.onSelect();!this.onFilter()||(this.config.onLoading(),this.onUpload())},onFilter:function(a){var b=this.$inputFile.val();if(b===""){this.config.onFail("sizeError");return!1}if(!/^.*\.(gif|jpeg|jpg|png|bmp)$/i.test(b)){this.config.onFail("typeError");return!1}return!0},onUpload:function(){window.uploadImageCallback=d.proxy(this.uploadCallback,this),this.$upload.find("input[name=callback]").val("uploadImageCallback"),this.$form.submit()},uploadCallback:function(a){window.uploadImageCallback=undefined,this.config.onLoaded();var b=this.$inputFile.val().split("\\").pop();if(a&&a.originalURL)this.config.onSuccess(b,a);else{var c=parseInt(a.code);switch(c){case 529:this.config.onFail("sizeError");break;case 530:this.config.onFail("sizeError");break;case 531:this.config.onFail("uploadError");break;default:}}}});return f});define("module/setting/Corp",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("basic/Class"),f=a("utils/DataSource"),g=a("utils/Utils"),h=a("utils/Error"),i=a("module/profile/CompanySuggest"),j=a("utils/upload/IframeUpload"),k=e.extend({init:function(a){this.$elem=a,this.$verifyCorpName=a.find(".verify-corp-name"),this.$corpNameInput=this.$verifyCorpName.find(".form-input"),this.$verifyCorpEmail=a.find(".verify-corp-email"),this.$verifyCorpFile=a.find(".verify-corp-file"),this.$verifyWaiting=a.find(".verify-corp-waiting-email"),this.$verifyBtn=a.find(".js-verify-submit"),this.$corpMailInput=this.$verifyCorpEmail.find(".form-input"),this.$imageLink=this.$verifyCorpFile.find(".js-verified-file"),this.$resendBtn=this.$verifyWaiting.find(".js-resend-email"),this.$tips=null,this.submitType=0,this.bindEvent()},bindEvent:function(){var a=this;this.$verifyCorpName.delegate(".verify-corp-check","click",d.proxy(this.verifyCorpName,this)).delegate(".form-input","focus",d.proxy(this.focusCorpInput,this)),this.$corpNameInput.bind("paste cut input keyup",d.proxy(this.checkCorpName,this)),new i(null,{$input:this.$corpNameInput}),this.$verifyCorpEmail.delegate(".form-input","paste cut input keyup",function(){var b=this.value;a.verifyCorpEmail.call(a,b)}).delegate(".form-input","focus",d.proxy(this.focusCorpInput,this)),this.$verifyBtn.bind("click",function(){d(this).hasClass("disabled")||a.submitEvents.call(a)}),new j(this.$verifyCorpFile.find(".verify-corp-upload"),{isMouseMoveForm:!0,onSuccess:d.proxy(this.onUploadSuccess,this),onFail:d.proxy(this.onUploadFailed,this),onLoading:d.proxy(this.onUploadLoading,this)}),this.$fileUploadHandler=d("#fileUploadHandler");var b=function(b,c){a.configProcedure(a.procedureMap[b],c)};this.$elem.delegate(".verify-corp-change","click",function(){b("1-1",function(){a.$fileUploadHandler.hide()})}),this.$verifyWaiting.delegate(".js-change-corpmail","click",function(){b("2-1",function(){a.submitType=1,a.$verifyBtn.removeClass("disabled")})}),this.$verifyWaiting.delegate(".js-submit-file","click",function(){b("2-2",function(){a.submitType=0,a.$imageLink.val(k.INPUTVAL),a.$verifyBtn.addClass("disabled")})}),this.$elem.delegate(".js-re-verify","click",function(){b("1-1",function(){a.$corpNameInput.val(""),a.$corpNameInput.prev().show()})}),this.$elem.delegate(".js-usernameLabel","click",function(){d(this).next().focus()}),this.$resendBtn.bind("click",d.proxy(this.resendEmail,this))},checkCorpName:function(){var a=this.$corpNameInput.prev(),b=this.$corpNameInput.val();d.trim(b)!==""?a.hide():a.show()},procedureMap:{"1-1":"verify-step1","2-1":"verify-step2-email","2-2":"verify-step2-file","3-1":"verify-waiting-email","3-2":"verify-waiting-file","4-1":"verify-succeed ","4-2":"verify-fail "},configProcedure:function(a,b){this.$elem.removeClass().addClass("verify-corp js-setting "+a),b&&d.isFunction(b)&&b.call(self)},verifyCorpName:function(){var a=this.$corpNameInput.val();this.$tips=this.$verifyCorpName.find(".text-icon-tips");if(!d.trim(a))g.textTips(this.$tips,"error","\u8bf7\u8f93\u5165\u516c\u53f8\u540d\u79f0");else{if(d.trim(a).replace(/[\u4e00-\u9fa5\s]/g,"**").length>50){g.textTips(this.$tips,"error","\u516c\u53f8\u540d\u79f0\u8fc7\u957f");return}this.$corpNameInput.trigger("select.clearTimers");var b=this;f.postJSON("companyNameVerify",{corpName:d.trim(a)},function(c){var d=g.countChars(a,25);parseInt(c.type)===2?(b.$verifyCorpFile.find(".js-file-corpname").text(d).attr("title",a),b.configProcedure(b.procedureMap["2-2"],function(){b.submitType=0,b.$imageLink.val(k.INPUTVAL),b.$verifyBtn.addClass("disabled"),b.$fileUploadHandler.show()})):parseInt(c.type)===1&&(b.$verifyCorpEmail.find(".js-mail-corpname").text(d).attr("title",a),b.$verifyCorpEmail.find(".js-corpmail").text("@"+c.esuffix),b.configProcedure(b.procedureMap["2-1"],function(){b.submitType=1,b.$corpMailInput.val(""),b.$corpMailInput.prev().show(),b.$verifyBtn.addClass("disabled")}))})}},focusCorpInput:function(){this.$tips&&g.textTips(this.$tips,"hide"),this.$tips=null},verifyCorpEmail:function(a){d.trim(a)?(this.$corpMailInput.prev().hide(),this.$verifyBtn.removeClass("disabled")):(this.$corpMailInput.prev().show(),this.$verifyBtn.addClass("disabled"))},onUploadSuccess:function(a,b){this.$imageLink.val(a),this.$verifyBtn.removeClass("disabled"),this.originalURL=b.originalURL},onUploadFailed:function(a){this.$tips=this.$verifyCorpFile.find(".text-icon-tips");var b;a==="sizeError"?b="\u56fe\u7247\u5927\u5c0f\u4e0d\u5728\u89c4\u5b9a\u8303\u56f4":a==="uploadError"?b="\u6587\u4ef6\u4e0a\u4f20\u5931\u8d25":a==="typeError"&&(b="\u652f\u6301JPG,PNG\u7b49\u56fe\u7247\u683c\u5f0f"),g.textTips(this.$tips,"error",b),this.$imageLink.val(k.INPUTVAL)},onUploadLoading:function(){this.originalURL=null,this.$verifyBtn.addClass("disabled"),this.$tips&&g.textTips(this.$tips,"hide"),this.$tips=null,this.$imageLink.val("\u6587\u4ef6\u4e0a\u4f20\u4e2d...")},isLegalMail:function(a){var b=!1;if(d.trim(a)){var c=/^[a-zA-Z0-9_\-\.]{1,}$/;a.match(c)&&(b=!0)}return b},submitEvents:function(){var a,b;if(this.submitType){var c=d.trim(this.$corpMailInput.val()),e=d.trim(this.$verifyCorpEmail.find(".js-corpmail").text());b=d.trim(this.$corpNameInput.val()),this.$tips=this.$verifyCorpEmail.find(".text-icon-tips"),this.isLegalMail(c)?(a=this,f.postJSON("companyMailVerify",{corpName:b,verifyEmail:c+e},function(b){if(parseInt(b.code)===1)b.pageData.isSendEmail?a.configProcedure(a.procedureMap["3-1"],function(){a.$elem.find(".js-sent-corpmail").text(c+e)}):g.textTips(a.$tips,"error","\u4eca\u65e5\u53d1\u9001\u5df2\u8fbe\u4e0a\u9650\uff01");else{var d=h.Code(b.code);g.textTips(a.$tips,"error",d)}})):g.textTips(this.$tips,"error","\u516c\u53f8\u540d\u79f0\u9519\u8bef")}else b=d.trim(this.$corpNameInput.val()),a=this,f.postJSON("commitVerifyFile",{verifyImage:this.originalURL,corpName:b},function(b){parseInt(b.code)===1&&a.configProcedure(a.procedureMap["3-2"],function(){a.$fileUploadHandler.hide()})})},resendEmail:function(){var a=d.trim(this.$corpMailInput.val()),b=d.trim(this.$verifyCorpEmail.find(".js-corpmail").text()),c=d.trim(this.$verifyCorpEmail.find(".js-mail-corpname").text());this.$tips&&g.textTips(this.$tips,"hide"),this.$tips=null;var e=this;f.postJSON("companyMailVerify",{corpName:c,verifyEmail:a+b},function(a){e.$tips=e.$verifyWaiting.find(".text-icon-tips");if(parseInt(a.code)===1)a.pageData.isSendEmail?e.$tips.removeClass("hidden text-icon-tips-error").html('<span class="verify-corp-email-tips text-green">\u53d1\u9001\u6210\u529f\uff01</span>'):g.textTips(e.$tips,"error","\u4eca\u65e5\u53d1\u9001\u5df2\u8fbe\u4e0a\u9650\uff01");else{var b=h.Code(a.code);g.textTips(e.$tips,"error",b)}})}});k.INPUTVAL="\u8bf7\u4e0a\u4f20\u542b\u7167\u7247\u5de5\u4f5c\u8bc1\u3001\u540d\u7247\u7b49\u8bc1\u660e\uff0c10K~8M";return k});define("module/profile/CompanySuggest",function(a,b,c){var d=a("lib/jquery"),e=d(document.body),f=a("utils/Utils"),g=a("basic/Class"),h=a("utils/DataSource"),i=a("widget/suggest/CompanySuggestList"),j=d(document),k=g.extend({init:function(a,b){this.$elem=a||d('<div class="autoCompleteList"><ul></ul></div>'),this.$list=this.$elem.find("ul"),this.$input=b.$input,this.speed=b.speed||500,this.timer=null,this.cache="",this.requesting=!1,b.maxHeight&&this.$list.css({maxHeight:b.maxHeight}),this.$suggestList=new i(this.$list),this.bindEvent()},bindEvent:function(){this.$input.bind("select.clearTimers",d.proxy(this.clearTimers,this)),this.$elem.bind("select.SearchSuggestList",d.proxy(this.onSelect,this)),this.$input.bind("keyup",d.proxy(this.requestSuggest,this))},clearTimers:function(){clearTimeout(this.timer)},onSelect:function(a,b){this.$input.val(b).blur(),this.cache=b,this.hideList()},hideList:function(){this.$elem.hide(),d.browser.msie&&d.browser.version<7&&j.trigger("companySuggest:hide")},showList:function(){this.$elem.show(),d.browser.msie&&d.browser.version<7&&j.trigger("companySuggest:show")},requestSuggest:function(a){var b=this;clearTimeout(this.timer);a.which===13||a.which===9||a.which===27||a.which===38||a.which===40?d.browser.msie&&d.browser.version<7&&j.trigger("companySuggest:show"):this.timer=setTimeout(function(){var a=d.trim(b.$input.val());!b.requesting&&b.cache!==a&&(b.requesting=!0,b.jqXhr=h.postJSON("companySuggest",{input:a},function(a){b.requesting=!1,b.onDataBack(a)}).error(function(a){b.requesting=!1}))},b.speed)},onDataBack:function(a){var b=this.$input.offset();b.top+=this.$input.height();var c=d();if(a.length<1||a.length>1&&a[0].indexOf(this.$input.val())===-1)this.hideList();else{this.showList();for(var e=0;e<a.length;e++)c=c.add("<li>"+a[e]+"</li>");this.$suggestList.show(c,!0),this.showSuggest(b)}},showSuggest:function(a){var b=this;this.$elem.css({position:"absolute",top:a.top,left:a.left,width:this.$input.outerWidth()-2}).appendTo(document.body).show(),this.isBindAutoClose||(f.autoClose.call({$elem:this.$elem,$trigger:this.$input,hide:d.proxy(function(){b.hideList(),e.unbind("click",this.autoClose),this.isBindAutoClose=!1},this)}),this.isBindAutoClose=!0)}});return k});define("widget/suggest/CompanySuggestList",function(a,b,c){var d=a("lib/jquery"),e=a("widget/suggest/SuggestList"),f=d(document),g=e.extend({init:function(a,b){this._super(a,b),this.isFirstItem=!1,this.isLastItem=!1},onEnter:function(a){this.onClick(a)},onClick:function(a){var b=this.$elem.children(".current").html();this.$elem.trigger("select.SearchSuggestList",[b])},show:function(a,b){if(!!this._super(a.html())){b||this.$elem.html(a).children(":first").addClass("current"),this.$elem.html(a),this.cacheHtml=a,this.bindEvent(),d.browser.msie&&d.browser.version<7&&f.trigger("companySuggest:show");return}},hide:function(){this._super(),d.browser.msie&&d.browser.version<7&&f.trigger("companySuggest:hide")},getPrevElem:function(a,b){if(this.isFirstItem===!0){b.filter(".current").removeClass("current"),this.isFirstItem=!1;return null}var c=a.prev();c=c.size()>0?c:b.last(),c.prev().size()<=0&&(this.isFirstItem=!0),this.isLastItem=!1,c.next().size()<=0&&(this.isLastItem=!0);return c.hasClass("disable")?this.getPrevElem(c,b):c},getNextElem:function(a,b){if(this.isLastItem===!0){b.filter(".current").removeClass("current"),this.isLastItem=!1;return null}var c=a.next();c=c.size()>0?c:b.first(),c.next().size()<=0&&(this.isLastItem=!0),this.isFirstItem=!1,c.prev().size()<=0&&(this.isFirstItem=!0);if(c.hasClass("disable"))return this.getNextElem(c,b);return c},bindEvent:function(){this._super(),this.$elem.bind("mouseleave",d.proxy(function(){this.$elem.children().filter(".current").removeClass("current")},this))},clearUp:function(){this.$elem.empty()},onKey:function(a){this._super(a),a.which===27&&(this.$elem.parent().detach(),a.preventDefault())}});return g});define("widget/suggest/SuggestList",function(a,b,c){var d=a("lib/jquery"),e=a("basic/Class"),f=e.extend({cacheData:null,binded:null,config:null,$elem:null,hideTimer:null,init:function(a,b){this.$elem=d(a),this.config=b,this.$elem.delegate("li","hover",d.proxy(this.onHover,this)).delegate("li","click",d.proxy(this.onClick,this)),this.config&&!this.config.disableScroll&&this.$elem.bind("scroll",d.proxy(this.onScroll,this))},onHover:function(a){var b=d(a.target);a.target.tagName.toUpperCase()!=="LI"&&(b=b.parents("li").first()),b.hasClass("disable")||b.addClass("current").siblings(".current").removeClass("current")},onCurrentFirst:function(){this.$elem.children("[className!=disable]").first().addClass("current")},onScroll:function(a){clearTimeout(this.hideTimer),this.bindBodyClick||(d(document.body).one("click",d.proxy(function(){this.bindBodyClick=!1,this.hide()},this)),this.bindBodyClick=!0)},show:function(a){clearTimeout(this.hideTimer);if(a===this.cacheData)return!1;this.cacheData=a;return!0},hide:function(){clearTimeout(this.hideTimer),this.hideTimer=setTimeout(d.proxy(function(){this.unbindEvent(),this.$elem.detach()},this),200)},bindEvent:function(){this.binded||(d(document.body).bind("keydown",d.proxy(this.onKey,this)),this.binded=!0)},unbindEvent:function(){this.binded&&(d(document.body).unbind("keydown",d.proxy(this.onKey,this)),this.binded=!1)},onKey:function(a){if(a.which===38||a.which===40){var b=this.$elem.children(),c=b.filter(".current").removeClass("current"),d=null;a.which===38?d=this.getPrevElem(c,b):d=this.getNextElem(c,b),d&&d.addClass("current"),a.preventDefault()}if(a.which===13||a.which===9)this.onEnter(a),a.preventDefault()},getPrevElem:function(a,b){var c=a.prev();c=c.size()>0?c:b.last();return c.hasClass("disable")?this.getPrevElem(c,b):c},getNextElem:function(a,b){var c=a.next();c=c.size()>0?c:b.first();if(c.hasClass("disable"))return this.getNextElem(c,b);return c},onEnter:function(a){throw new Error("Not Implemented")},onClick:function(a){var b=d(a.target);a.target.tagName.toUpperCase()!=="LI"&&(b=b.parents("li").first());if(!b.hasClass("disable")){var c=b.attr("n");this.$elem.trigger("select",[c])}}});return f});define("module/setting/Account",function(a,b,c){"use strict";var d=a("lib/jquery"),e=a("utils/Log"),f=a("basic/Class"),g=a("utils/Error"),h=a("utils/DataSource"),i=a("widget/box/floatBox/TipsBox"),j=a("widget/box/floatBox/BuyServiceBox"),k=f.extend({init:function(a){this.$elem=a,this.$save=a.find(".js-save"),this.$buy=a.find(".js-buyService"),this.bindEvt()},bindEvt:function(){this.$save.bind("click",d.proxy(this.save,this)),this.$buy.bind("click",d.proxy(this.buyService,this))},save:function(a){var b=function(b){if(!g.Tips(b.code,a)){var c=new i(null,{data:{type:"correct",text:"\u4fdd\u5b58\u6210\u529f\uff01"}});c.show(),c.delayHide(1500)}},c=document.getElementById("openRemind"),d=0;c.checked&&(d=1),h.postJSON("loginRemind",{enable:d},b)},buyService:function(a){(new j(null,{service:"onlineremind",successCallBack:function(){location.reload()}})).show(),e.doLog({parameter:{method:"openonlineremind"},elem:d(a.target)})}});return k});define("page/setting",function(a,b,c){a("task/group/common"),a("task/page/setting/setting"),a("task/basic/TaskManager").run()});